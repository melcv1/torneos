/*!
 * JavaScript for PHPMaker v2023.0.0
 * Copyright (c) e.World Technology Limited. All rights reserved.
 */
!function(e,t,a){"use strict";var n=e=>e&&"object"==typeof e&&"default"in e?e:{default:e},l=n(e),i=n(t),r=n(a);let o=r.default.DateTime;var s={__proto__:null,userLevelId:function(e){return e&&!ew.checkInteger(e.value)?{userLevelId:ew.language.phrase("UserLevelIDInteger")}:parseInt(e.value,10)<1&&{userLevelId:ew.language.phrase("UserLevelIDIncorrect")}},userLevelName:function(e){return function(t){let a=document.getElementById("x_"+e);if(a&&t){let e=t.value.trim(),n=parseInt(a.value.trim(),10);if(0===n&&!ew.sameText(e,"Default"))return{userLevelName:ew.language.phrase("UserLevelDefaultName")};if(-1===n&&!ew.sameText(e,"Administrator"))return{userLevelName:ew.language.phrase("UserLevelAdministratorName")};if(-2===n&&!ew.sameText(e,"Anonymous"))return{userLevelName:ew.language.phrase("UserLevelAnonymousName")};if(n>0&&["anonymous","administrator","default"].includes(e.toLowerCase()))return{userLevelName:ew.language.phrase("UserLevelNameIncorrect")}}return!1}},required:function(e){return function(t){var a;let n=i.default(t),l=n.closest("#r_"+(null==(a=n.data("field"))?void 0:a.substring(2)));return l[0]||(l=n.closest("[id^=el]")),"none"!=l.css("display")&&(!(!t||ew.hasValue(t))&&{required:ew.language.phrase("EnterRequiredField").replace("%s",e)})}},fileRequired:function(e){return function(t){let a=document.getElementById("fn_"+t.id);return!(!a||ew.hasValue(a))&&{fileRequired:ew.language.phrase("EnterRequiredField").replace("%s",e)}}},mismatchPassword:function(e){let t;e.id.startsWith("c_")?t=e.id.replace(/^c_/,"x_"):"cpwd"==e.id&&(t="npwd");let a=document.getElementById(t);return e.value!==a.value&&{mismatchPassword:ew.language.phrase("MismatchPassword")}},between:function(e){let t,a;return e.id.startsWith("y_")?(t=document.getElementById(e.id.replace(/^y_/,"x_")),a=document.getElementById(e.id.replace(/^y_/,"z_"))):e.id.endsWith("_value_1")&&(t=document.getElementById(e.id.replace(/_value_1$/,"_value_0")),a=document.getElementById(e.id.replace(/_value_1$/,"_operator"))),!(!ew.hasValue(t)||"BETWEEN"!=i.default(a).val().toUpperCase()||ew.hasValue(e))&&{between:ew.language.phrase("EnterValue2")}},passwordStrength:function(e){let t=i.default(e);return!(ew.isMaskedPassword(e)||!t.hasClass("ew-password-strength")||t.data("validated"))&&{passwordStrength:ew.language.phrase("PasswordTooSimple")}},username:function(e){return function(t){return!(e||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_USERNAME_CHARACTERS)+"]")))&&{username:ew.language.phrase("InvalidUsernameChars")}}},password:function(e){return function(t){return!(e||ew.ENCRYPTED_PASSWORD||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_PASSWORD_CHARACTERS)+"]")))&&{password:ew.language.phrase("InvalidPasswordChars")}}},email:function(e){let t=ew.getValue(e);return!ew.checkEmail(t)&&{email:ew.language.phrase("IncorrectEmail")}},emails:function(e,t){return function(a){let n=ew.getValue(a);return!ew.checkEmails(n,e)&&{emails:t}}},datetime:function(e){return function(t){let a=ew.getValue(t);return!ew.checkDate(a,e)&&{datetime:ew.language.phrase("IncorrectDate").replace(/%s/g,e)}}},time:function(e){return function(t){let a=ew.getValue(t);return!ew.checkTime(a,e)&&{time:ew.language.phrase("IncorrectTime").replace(/%s/g,e)}}},float:function(e){let t=ew.getValue(e);return!ew.checkNumber(t)&&{float:ew.language.phrase("IncorrectFloat")}},range:function(e,t){return function(a){let n=ew.getValue(a);return!ew.checkRange(n,e,t)&&{range:ew.language.phrase("IncorrectRange").replace("%1",e).replace("%2",t)}}},integer:function(e){let t=ew.getValue(e);return!ew.checkInteger(t)&&{integer:ew.language.phrase("IncorrectInteger")}},phone:function(e){let t=ew.getValue(e);return!ew.checkPhone(t)&&{phone:ew.language.phrase("IncorrectPhone")}},zip:function(e){let t=ew.getValue(e);return!ew.checkZip(t)&&{zip:ew.language.phrase("IncorrectZip")}},creditCard:function(e){let t=ew.getValue(e);return!ew.checkCreditCard(t)&&{creditCard:ew.language.phrase("IncorrectCreditCard")}},ssn:function(e){let t=ew.getValue(e);return!ew.checkSsn(t)&&{ssn:ew.language.phrase("IncorrectSSN")}},guid:function(e){let t=ew.getValue(e);return!ew.checkGuid(t)&&{guid:ew.language.phrase("IncorrectGUID")}},regex:function(e){return function(t){let a=ew.getValue(t);return!ew.checkByRegEx(a,e)&&{regex:ew.language.phrase("IncorrectField")}}},url:function(e){let t=ew.getValue(e);return!ew.checkUrl(t)&&{url:ew.language.phrase("IncorrectUrl")}},custom:function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return function(t){if("function"==typeof e){let n=ew.getValue(t);if(e(n,...a))return{custom:ew.language.phrase("IncorrectField")}}return!1}},captcha:function(e){return!(!e||ew.hasValue(e))&&{captcha:ew.language.phrase("EnterValidateCode")}},recaptcha:function(e){var t;return!(!e||ew.hasValue(e)||""!==(null==(t=grecaptcha)?void 0:t.getResponse(e.dataset.id)))&&{recaptcha:ew.language.phrase("ClickReCaptcha")}},minDate:function(e){return function(t){let a,n=ew.getValue(t),l=t.dataset.formatPattern;if((e="function"==typeof e?e():e)instanceof HTMLElement){let t=e.value,n=e.dataset.formatPattern;e.value&&e.dataset.formatPattern&&(a=ew.parseDate(t,n))}else e instanceof Date?a=o.fromJSDate(e,{zone:"utc"}):e instanceof o&&(a=e);if(n&&l&&a){if(ew.parseDate(n,l)<a)return{minDate:ew.language.phrase("IncorrectMinDate").replace("%s",ew.formatDateTime(a,ew.DATE_FORMAT+" "+ew.TIME_FORMAT))}}return!1}},maxDate:function(e){return function(t){let a,n=ew.getValue(t),l=t.dataset.formatPattern;if((e="function"==typeof e?e():e)instanceof HTMLElement){let t=e.value,n=e.dataset.formatPattern;e.value&&e.dataset.formatPattern&&(a=ew.parseDate(t,n))}else e instanceof Date?a=o.fromJSDate(e,{zone:"utc"}):e instanceof o&&(a=e);if(n&&l&&a){if(ew.parseDate(n,l)>a)return{maxDate:ew.language.phrase("IncorrectMaxDate").replace("%s",ew.formatDateTime(a,ew.DATE_FORMAT+" "+ew.TIME_FORMAT))}}return!1}},min:function(e){return function(t){let a,n=ew.parseNumber(ew.getValue(t));return(e="function"==typeof e?e():e)instanceof HTMLElement?a=ew.parseNumber(ew.getValue(e)):"string"==typeof e?a=ew.parseNumber(e):"number"==typeof e&&(a=e),"number"==typeof n&&"number"==typeof a&&n<a&&{min:ew.language.phrase("IncorrectMin").replace("%s",a)}}},max:function(e){return function(t){let a,n=ew.parseNumber(ew.getValue(t));return(e="function"==typeof e?e():e)instanceof HTMLElement?a=ew.parseNumber(ew.getValue(e)):"string"==typeof e?a=ew.parseNumber(e):"number"==typeof e&&(a=e),"number"==typeof n&&"number"==typeof a&&n>a&&{max:ew.language.phrase("IncorrectMax").replace("%s",a)}}}};function d(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,a){return t&&d(e.prototype,t),a&&d(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,f(e,t)}function h(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}i.default.batchSettings={type:"POST",contentType:"application/json",processData:!1,dataType:"json",toJSON:JSON.stringify,parse:e=>e},i.default.batchSetup=function(e){return i.default.extend(i.default.batchSettings,e)};var g=i.default.batch=function(e,t){return this instanceof g?("object"==typeof e&&(t=e,e=void 0),this.options=i.default.extend({},i.default.batchSettings,t),this.parent=i.default.ajaxSetup()._batch,this.requests=[],e&&this.add(e),this):new g(e,t)};i.default.extend(g.prototype,{add:function(e){var t;return i.default.ajaxSetup({_batch:this.parent||this}),null!=(t=e.name)&&t.startsWith("bound ")?e():e.call(i.default.ajaxSetup()._batch),this.parent||i.default.ajaxSetup({_batch:null}),this},clear:function(){this.requests=[]},send:function(e){e=e||{};var t=this;if(this.parent&&e.success){var a=this.parent.options.success;this.parent.options.success=function(t,n,l){e.success(t,n,l),a&&a(t,n,l)}}else if(this.requests.length){var n=i.default.map(this.requests,(function(e){return e.settings.data})),l=e.success,r=this.options.success;return e.success=function(e,a,n){t._deliver.call(t,e,a),r&&r(e,a,n),l&&l(e,a,n)},(e=i.default.extend({},this.options,e)).data||(e.data=i.default.batchSettings.toJSON(n)),i.default.ajax(e)}},_addRequest:function(e,t){this.requests.push({xhr:e,settings:t})},_deliver:function(e,t){var a,n,r=this,o=i.default.batchSettings.parse(e);null!=o&&null!=(a=o.error)&&a.description?l.default.alert(null==o||null==(n=o.error)?void 0:n.description):i.default.each(o,(function(e,a){var n;if(r.requests[e]){var l,i=r.requests[e];if(i.xhr.statusText=t,"success"===t)null==(l=i.settings.success)||l.call(i.xhr,a,t);null==(n=i.settings.complete)||n.call(i.xhr,t)}}))}});var m=i.default.ajax;function w(e,t){let a=this,n=i.default(a);this._initiated=!1,this.id=e,this.element=document.getElementById(e),this.$element=i.default(this.element),this.pageId=t,this.htmlForm=null,this.initSearchPanel=!1,this.modified=!1,this.emptyRow=null,this.multiPage=null,this.autoSuggests={},this.lists={},this.batch=new g,this.formKeyCountName="",this.submitWithFetch=!1,this.enableOnInit=!1,this.filterList=null,this.disableForm=function(){document.body.style.cursor="wait";let e=this.getForm();i.default(e.elements).filter(":submit:not(.dropdown-toggle), .ew-submit").prop("disabled",!0).addClass("disabled"),this.trigger("disabled")},this.enableForm=function(){let e=this.getForm(),t=i.default(e.elements);t.filter(".ew-disabled-element").removeClass("ew-disabled-element").prop("disabled",!1),t.filter(".ew-enabled-element").removeClass("ew-enabled-element").prop("disabled",!0),t.filter(":submit:not(.dropdown-toggle), .ew-submit").not(".ew-disabled").prop("disabled",!1).removeClass("disabled"),this.trigger("enabled"),document.body.style.cursor="default"},this.appendHidden=function(e){var t=this.getForm(),a=i.default(t),n=i.default(e).closest(".ew-form"),l=n.attr("id")+"$"+e.name;if(!a.find("input:hidden[name='"+l+"']")[0]){var r=n.find('[name="'+e.name+'"]').serializeArray();r.length?r.forEach((function(e,t){i.default('<input type="hidden" name="'+l+'">').val(e.value).appendTo(a)})):i.default('<input type="hidden" name="'+l+'">').val("").appendTo(a)}},this.canSubmit=async function(e){var t,n,l=this.getForm(),r=i.default(l);if(this.disableForm(),this.updateTextArea(),null!=(t=await(null==(n=this.validate)?void 0:n.call(this,e)))&&!t||r.find(".is-invalid")[0])this.enableForm();else{r.find("input[name^=sv_], input[name^=p_], [name*=_query_builder_rule_], .ew-template input, .ew-custom-option").prop("disabled",!0).addClass("ew-disabled-element"),r.find("[data-readonly=1][disabled]").prop("disabled",!1).addClass("ew-enabled-element");var o=r.find("input[name=detailpage]").map((function(e,t){return r.find("#"+t.value)[0]}));o.length>1&&o.each((function(e,t){i.default(t).find(":input").each((function(e,n){if(/^(fn_)?(x|o)\d*_/.test(n.name)){var l=o.not(t).find(":input[name='"+n.name+"']");l.length&&(a.appendHidden(n),l.each((function(){a.appendHidden(this)})))}}))}));let t={form:l,result:!0},n=i.default.Event("beforesubmit",{originalEvent:e});r.trigger(n,[t]);let s=await t.result;if(!n.isDefaultPrevented()&&(!0===s||i.default.isObject(s)&&s.value))return!0}return!1},this.submit=async function(e){var t,a;let n=this.getForm(),l=null==e||null==(t=e.originalEvent)||null==(a=t.submitter)?void 0:a.formAction;if(l&&(l=ew.parseUrl(l).pathname,n.setAttribute("action",l)),await this.canSubmit(e)){if(this.submitWithFetch){let e=n.getAttribute("action"),t=n.method.toUpperCase(),a=i.default(n).serialize();return ew.fetch(e,{method:t,body:a}).finally((()=>this.enableForm()))}n.submit()}else this.enableForm()},this.getList=function(e){var t,a;if(i.default.isObject(e)){let t=e;(e=t.name||t.id).includes("query_builder_rule")&&(e=t.dataset.field)}if(e=e.replace(/^(sv_)?[xy](\d*|\$rowindex\$)_|\[\]$/g,""),this.lists[e])return this.lists[e];let n=null==(t=this.getElement(e))||null==(a=t.dataset.field)?void 0:a.replace(/^x_|\[\]$/g,"");return n?this.lists[n]:{}},this.compileTemplates=function(){let e=Object.values(this.lists);for(let t of e)t.template&&i.default.isString(t.template)&&(t.template=i.default.templates(t.template))},this.getForm=function(){var e,t;this.htmlForm||("FORM"==(null==(e=this.element)?void 0:e.tagName)?this.htmlForm=this.element:"DIV"==(null==(t=this.element)?void 0:t.tagName)&&(this.htmlForm=this.element.closest("form")));return this.htmlForm},this.getElement=function(e){return e?ew.getElement(e,this.$element):this.$element[0]},this.getElements=function(e){return ew.getElements(e,this.$element)},this.fixId=function(e,t,a){let n="",l=e.split(" ");l.length>1&&(n=l[0],a="",e=l[1]);let r=i.default.isNumber(a)?"x"+a+"_":"x_";return e=e.startsWith("x_")?e.replace(/^x_/,r):r+e,t&&!e.endsWith("[]")&&(e+="[]"),n?n+" "+e:e},this.updateList=function(e,t,a,n){var l;null!=t||(t=i.default.isString(e)?null==(l=Object.entries(this.lists).find((t=>t[0]==e.replace(/^x_/,""))))?void 0:l[1]:this.getList(e)),t.template&&i.default.isString(t.template)&&(t.template=i.default.templates(t.template));let r=this.getForm(),o=t.parentFields.slice().map((e=>this.fixId(e,!1,a))),s=t.ajax&&!t.lookupOptions.length;return e=i.default.isString(e)?this.fixId(e,t.multiple,a):e,!s||n?ew.updateOptions.call(this,e,o,s,!1):[e,o.map((e=>ew.getOptionValues(e,r))),s,!1]},this.updateLists=function(e,t){var n;if(null===e)return;if("grid"==this.pageId&&!i.default.isNumber(e)&&!i.default.isUndefined(e))return;let l=this.getForm();if("confirm"==(null==l||null==(n=l.querySelector("input#confirm"))?void 0:n.value))return;let r=Object.entries(this.lists).map((t=>{let[a,n]=t;return"[name='"+this.fixId(a,n.multiple,e)+"']"})).join();if(r&&l.querySelector(r)&&Object.entries(this.lists).map((t=>{let[a,n]=t;return this.updateList(a,n,e)})).filter((e=>Array.isArray(e))).forEach((e=>this.batch.add(ew.updateOptions.bind(this,...e)))),this.batch.requests.length){if(void 0===e||t){let e=[],t=ew.ajaxBatchSize>0?ew.ajaxBatchSize:1;for(;this.batch.requests.length>t;){let a=new g;a.requests=this.batch.requests.splice(0,t),e.push(a.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)}))}this.batch.requests.length>0&&e.push(this.batch.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)})),i.default.when(...e).then((()=>i.default(document).trigger("updatedone",[{source:a,target:l}]))).fail((e=>console.log(e))).always((()=>this.batch.clear()))}}else i.default(document).trigger("updatedone",[{source:a,target:l}])},this.createAutoSuggest=function(e){var t=Object.assign({limit:ew.AUTO_SUGGEST_MAX_ENTRIES,form:this},ew.autoSuggestSettings,e);a.autoSuggests[e.id]=new ew.AutoSuggest(t)},this.initEditors=function(){var e=this.getForm();i.default(e.elements).filter("textarea.editor").each((function(e,t){var a=i.default(t).data("editor");!a||a.active||a.name.includes("$rowindex$")||a.create()}))},this.updateTextArea=function(e){var t=this.getForm();i.default(t.elements).filter("textarea.editor").each((function(t,a){var n=i.default(a).data("editor");return!(n&&(!e||n.name==e))||(n.save(),!e&&void 0)}))},this.destroyEditor=function(e){var t=this.getForm();i.default(t.elements).filter("textarea.editor").each((function(t,a){var n=i.default(a).data("editor");return!(n&&(!e||n.name==e))||(n.destroy(),!e&&void 0)}))},this.onError=function(e,t){return ew.onError(this,e,t)},this.initUpload=function(){var e=this.getForm();i.default(e.elements).filter("input:file:not([name*='$rowindex$'])").each((function(e){i.default.later(ew.AJAX_DELAY*e,null,ew.upload,this)}))},this.setupFilters=function(e,t){let n=this.id,l=this.filterList?this.filterList.data:null,r=i.default(".ew-save-filter[data-form="+n+"]").toggleClass("disabled",!l),o=i.default(".ew-delete-filter[data-form="+n+"]").toggleClass("disabled",!t.length).toggleClass("dropdown-toggle",!!t.length),s=o.parent("li").toggleClass("dropdown-submenu dropdown-hover",!!t.length).toggleClass("disabled",!t.length),d=r.parent("li").toggleClass("disabled",!l),u=function(e,t){ew.CLIENT_SEARCH_FILTER?localStorage.setItem(ew.PROJECT_NAME+"_"+e+"_filters",JSON.stringify(t)):ew.SERVER_SEARCH_FILTER&&(document.body.style.cursor="wait",i.default.ajax(ew.currentPage(),{type:"POST",dataType:"json",data:{ajax:"savefilters",filters:JSON.stringify(t)}}).done((function(e){var n;null!=(n=e[0])&&n.success&&(a.filterList.filters=t)})).always((function(){document.body.style.cursor="default"})))};if(d.off("click.ew").on("click.ew",(function(e){if(d.hasClass("disabled"))return!1;ew.prompt({input:"text",html:ew.language.phrase("EnterFilterName")},(e=>{(e=ew.sanitize(e))&&(t.push([e,l]),u(n,t))}),!0)})).prevAll().remove(),o.next("ul.dropdown-menu").remove(),t.length){let e=i.default('<ul class="dropdown-menu"></ul>');t.forEach(((a,l,r)=>{i.default('<li><a class="dropdown-item" data-index="'+l+'" data-ew-action="none">'+a[0]+"</a></li>").on("click",(function(e){let l=this.querySelector("a[data-index]").dataset.index;ew.prompt(ew.language.phrase("DeleteFilterConfirm").replace("%s",a[0]),(e=>{e&&(r.splice(l,1),u(n,t))}))})).appendTo(e),i.default('<li><a class="dropdown-item ew-reset-filter-list" data-index="'+l+'" data-ew-action="none">'+a[0]+"</a></li>").insertBefore(d).on("click",(function(e){let t={cmd:"resetfilter",filter:JSON.stringify(a[1])};ew.refresh(ew.fetch(ew.setLayout(ew.currentPage(),!1),{method:"POST",body:t}))}))})),i.default('<li class="dropdown-divider"></li>').insertBefore(d),s.append(e)}},this.on=function(){n.on(...arguments)},this.one=function(){n.one(...arguments)},this.off=function(){n.off(...arguments)},this.trigger=function(){n.trigger(...arguments)},this.init=function(){if(!this._initiated){var e=this.getForm();if(e){var t=i.default(e);this.compileTemplates(),/s(ea)?rch$/.test(this.id)&&(this.initSearchPanel&&!ew.hasFormData(e)&&i.default("#"+this.id+"_search_panel").removeClass("show"),i.default(".ew-table .ew-search-operator").text().trim()||i.default(".ew-table .ew-search-operator").parent("td").hide(),t.find("select[id^=z_]").each((function(){"BETWEEN"!=i.default(this).trigger("change").val()&&t.find("#w_"+this.id.substring(2)).trigger("change")}))),this.multiPage&&this.multiPage.render(),loadjs.ready(["editor"],(()=>setTimeout(this.initEditors.bind(this),0))),this.updateLists(),this.initUpload(),this.$element.is("form")&&(this.$element.find(".ew-detail-pages .ew-nav a[data-bs-toggle=tab]").on("shown.bs.tab",(function(e){var t=i.default(e.target.getAttribute("href")),a=t.find(".table-responsive.ew-grid-middle-panel"),n=t.closest(".container-fluid");a.width()>=n.width()?a.width(n.width()+"px"):a.width("auto")})),t.off("submit.ew").on("submit.ew",(function(t){let n={form:e,result:a.submit(t)},l=i.default.Event("aftersubmit",{originalEvent:t});return a.trigger(l,[n]),!1})),t.find("[data-field], .ew-priv").on("change",(function(){ew.CONFIRM_CANCEL&&(a.modified=!0)})),t.find("#btn-cancel[data-href]").on("click",(function(){a.updateTextArea();var n=this.dataset.href;a.modified&&ew.hasFormData(e)?ew.prompt(ew.language.phrase("ConfirmCancel"),(e=>{e&&(t.find("#btn-action").prop("disabled",!0),window.location=n)})):(t.find("#btn-action").prop("disabled",!0),window.location=n)}))),this._initiated=!0,this.$element.data("form",this),(this.enableOnInit||Array.from(e.elements).find((e=>e.matches("button.disabled.enable-on-init"))))&&this.enableForm(),this.trigger("initiated")}}},ew.forms.add(this)}i.default.ajax=function(e,t){"object"==typeof e&&(t=e,e=void 0);var a=(t=t||{}).beforeSend;return t.beforeSend=function(e,t){if(a){var n=a(e,t);if(!1===n)return n}if(t._batch)return t._batch._addRequest(e,t),!1},m.call(this,e,t)};let v=function(){function e(e,t,a){if(h(this,"name",""),h(this,"validators",[]),h(this,"_validate",!0),this.name=e,Array.isArray(t))for(let e of t)this.addValidator(e);else"function"==typeof t&&this.addValidator(t);this.invalid=a}var t=e.prototype;return t.addValidator=function(e){"function"==typeof e&&this.validators.push(e)},t.addError=function(e){if(e){var t;let a=null!=(t=this._error)?t:{};this._error={...a,...e},this.invalid=!0}},t.clearErrors=function(){this._error=null,this.invalid=!1},t.clearValidators=function(){this.validators=[]},t.validate=function(){let e=!0;if(this.clearErrors(),this._element&&this.shouldValidate&&Array.isArray(this.validators)){for(let t of this.validators){let a=t(this._element);!1!==a&&(this.addError(a),e=!1)}this.updateFeedback()}return e},t.resetInvalid=function(){var e,t,a,n;this.clearErrors(),null!=(e=this._element)&&null!=(t=e.classList)&&t.contains("is-invalid")&&!this._error&&this.addError({server:null==(a=this._element.closest(ew.fieldContainerSelector))||null==(n=a.querySelector(".invalid-feedback"))?void 0:n.innerHTML})},t.updateFeedback=function(){let e=this.errorMessage;if(this._element&&e){var t;let a=null==(t=this._element.closest(ew.fieldContainerSelector))?void 0:t.querySelector(".invalid-feedback");a&&(a.innerHTML=e),ew.setInvalid(this._element)}},t.focus=function(e){this._element&&ew.setFocus(this._element,e)},t.canFocus=function(){var e,t;let a=this._element;return a&&!(a.hidden&&"SELECTION-LIST"==!a.tagName||a.readonly||a.disabled||"hidden"==a.type||"none"==(null==(e=a.style)?void 0:e.display)||null!=(t=a.classList)&&t.contains("d-none"))},u(e,[{key:"error",get:function(){return this._error}},{key:"errorMessage",get:function(){return this._error?Array.from(Object.values(this._error)).join("<br>"):""}},{key:"shouldValidate",get:function(){return!this._checkbox||this._checkbox.checked}},{key:"element",get:function(){return this._element},set:function(e){var t,a;this._element=e,this._checkbox=null!=(t=this._element)&&null!=(a=t.id)&&a.match(/^[xy]_/)?document.getElementById(this._element.id.replace(/^[xy]_/,"u_")):null}},{key:"value",get:function(){return this._element?ew.getValue(this._element):""}},{key:"focused",get:function(){return this._element&&this._element==document.activeElement}}]),e}(),b=function(e){function t(t,a){var n;return h(c(n=e.call(this,t,a)||this),"row",{}),h(c(n),"fields",{}),h(c(n),"validateRequired",!0),h(c(n),"autoFocus",!0),h(c(n),"autoFocusPreventScroll",!0),n.on("initiated",(function(){this.getForm().classList.contains("ew-wait")?this.one("enabled",(function(){this.setInvalid(),this.tryFocus()})):(this.setInvalid(),this.tryFocus())})),n}p(t,e);var a=t.prototype;return a.addField=function(e,t,a){e in this.fields||(this.fields[e]=new v(e,t,a))},a.getField=function(e){return this.fields[e]},a.addFields=function(e){if(Array.isArray(e))for(let t of e)Array.isArray(t)&&this.addField.apply(this,t)},a.addError=function(e,t){var a;t&&(this._error=null!=(a=this._error)?a:{},this._error[e]=t)},a.addCustomError=function(e,t){if(e in this.fields){let a=this.fields[e],n={custom:t};a.addError(n),a.updateFeedback(),this.addError(e,n)}return!1},a.getFieldElements=function(e,t){return null!=t||(t=this.getCurrentRowIndex()),this.getElements("x"+t+"_"+e)||this.getElements("x"+t+"_"+e+"[]")||this.getElements(e)},a.setFocus=function(e){let a=this.makeVisible(e)?t.focusDelay:0;if(e&&e!=document.activeElement&&e.focus){let n=!e.closest(".modal-body")&&t.autoFocusPreventScroll&&this.autoFocusPreventScroll;setTimeout((()=>{e.focus({preventScroll:n})}),a),this._focused=!0}},a.focus=function(){if(this.canFocus())for(let[t,a]of Object.entries(this.fields)){var e;if((a.invalid||null!=(e=this._error)&&e[t])&&(this.getFocusable(a),a.canFocus())){this.setFocus(a.element);break}}},a.getFocusable=function(e){null!=e.element||(e.element=this.getFieldElements(e.name)),e.canFocus()||(e.element=this.getFieldElements(e.name,0)),e.canFocus()||(e.element=this.getFieldElements(e.name,1))},a.tryFocus=function(e){if(!this.canFocus())return;if(!e&&(!t.autoFocus||!this.autoFocus||this._focused))return;if(!e&&this.invalid)return void this.focus();if(["add","edit"].includes(this.pageId)){let e=this.getForm(),t=Array.from(e.querySelectorAll("input[name=detailpage]")).find((e=>{var t;return null==(t=ew.forms.get(e.value))?void 0:t.invalid}));if(t)return void t.focus()}for(let[t,a]of Object.entries(this.fields))if(("string"!=typeof e||e===t)&&(a.element=null,this.getFocusable(a),a.canFocus()))return void this.setFocus(a.element);let a=this.element[ew.TABLE_BASIC_SEARCH];this.id.endsWith("srch")&&a&&a!=document.activeElement&&(a.focus({preventScroll:t.autoFocusPreventScroll&&this.autoFocusPreventScroll}),this._focused=!0)},a.canFocus=function(){var e,t;let a=this.element;return a&&!(a.hidden||"hidden"==a.type||"none"==(null==(e=a.style)?void 0:e.display)||null!=(t=a.classList)&&t.contains("d-none"))},a.makeVisible=function(e){if(this.multiPage)return this.multiPage.gotoPageByElement(e),!0;if(this.$element.is("div")){let e=this.$element.closest(".tab-pane");if(e[0]&&!e.hasClass("active"))return e.closest(".ew-nav").find("a[data-bs-toggle=tab][href='#"+e.attr("id")+"']").trigger("click"),!0}return!1},a.validateFields=function(e){null!=e||(e=this.getCurrentRowIndex()),e<2&&(this.value=null),this.row={},this._error=null;let t=!0;for(let a of Object.values(this.fields))a.element=this.getFieldElements(a.name,e),this.row[a.name]=a.value,a.element&&!a.validate()&&(this.addError(a.name,a.error),t=!1);if(this.value){Array.isArray(this.value)||(this.value=[this.value]);let t=parseInt(e,10)||0;t=t>1?t-1:0,this.value[t]={...this.row}}else this.value={...this.row};return this.focus(),t},a.validate=async function(e){var t,a,n,l;if(!this.validateRequired)return!0;let i=this.getForm();if("confirm"==(null==(t=i.querySelector("#confirm"))?void 0:t.value))return!0;if("update"==this.pageId&&!ew.updateSelected(i))return ew.alert(ew.language.phrase("NoFieldSelected")),!1;let r=0,o=i.querySelector(".ew-inline-insert"),s=(null==(a=i.querySelector("#action"))?void 0:a.value)||(null==(n=null!=(l=null==e?void 0:e.currentTarget)?l:o)?void 0:n.dataset.action),d=o?0:this.keyCount,u="gridinsert"==s||["insert","confirm"].includes(s)&&d,c=o?0:d||1;for(let e=o?0:1;e<=c;e++){var f,p;let t=d>=0?String(e):"";if(i.dataset.rowindex=t,["list","grid"].includes(this.pageId)){if(u&&this.emptyRow(t))continue;r++}if(!this.validateFields(t))return!1;if(null!=(f=await(null==(p=this.customValidate)?void 0:p.call(this,i)))&&!f)return this.focus(),!1}if(delete i.dataset.rowindex,"list"==this.pageId&&u&&0==r)return ew.alert({html:ew.language.phrase("NoAddRecord"),returnFocus:!1}),this.tryFocus(!0),!1;if(["add","edit"].includes(this.pageId)){let t=i.querySelectorAll("input[name=detailpage]");for(let a of t){var h;let t=ew.forms.get(a.value);if(null!=(h=await(null==t||null==t.validate?void 0:t.validate(e)))&&!h)return!1}}return!0},a.getCurrentRowIndex=function(){var e;return null!=(e=this.getForm().dataset.rowindex)?e:""},a.getValue=function(e){null!=e||(e=this.getCurrentRowIndex());let t={};for(let a of Object.values(this.fields)){null!=a.element||(a.element=this.getFieldElements(a.name,e)),t[a.name]=a.value}return t},a.getFieldValue=function(e,t){let a=this.getField(e);return a?(null!=t||(t=this.getCurrentRowIndex()),null!=a.element||(a.element=this.getFieldElements(a.name,t)),a.value):null},a.getFieldElement=function(e,t){let a=this.getField(e);return a?(null!=t||(t=this.getCurrentRowIndex()),null!=a.element||(a.element=this.getFieldElements(a.name,t)),a.element):null},a.setInvalid=function(e){let t=this.getForm();if("undefined"==typeof e&&this.formKeyCountName){let e=t.querySelector(".ew-inline-insert"),a=e?0:this.keyCount,n=e?0:a||1;for(let t=e?0:1;t<=n;t++){let e=a>=0?String(t):"";this.setInvalid(e)}}else{null!=e||(e="");for(let t of Object.values(this.fields))t.element=this.getFieldElements(t.name,e),e&&t.resetInvalid(),t.invalid&&(this.addError(t.name,t.error),this._focused||this.focus(),ew.setInvalid(t.element));["add","edit"].includes(this.pageId)&&t.querySelectorAll("input[name=detailpage]").forEach((e=>{var t;return null==(t=ew.forms.get(e.value))?void 0:t.setInvalid()}))}},u(t,[{key:"error",get:function(){return this._error}},{key:"invalid",get:function(){return this._error||Object.values(this.fields).some((e=>e.invalid))}},{key:"keyCount",get:function(){var e;let t=this.formKeyCountName?null==(e=this.getForm().querySelector("#"+this.formKeyCountName))?void 0:e.value:void 0;return parseInt(t,10)}}]),t}(w);h(b,"autoFocus",!0),h(b,"autoFocusPreventScroll",!0),h(b,"focusDelay",200);let y=function(){function e(){h(this,"lists",{}),h(this,"fields",[]),h(this,"validateRequired",!1),h(this,"multiPage",!1),h(this,"submitWithFetch",!1),h(this,"initSearchPanel",!1),h(this,"enableOnInit",!1)}var t=e.prototype;return t.setId=function(e){return this.id=e,this},t.setPageId=function(e){return this.pageId=e,this},t.setLists=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&(this.lists=e),this},t.setQueryBuilderLists=function(e){if(e&&"object"==typeof e&&!Array.isArray(e)){for(let[t,a]of Object.entries(e))e[t]={...a,autoFillTargetFields:[],childFields:[],filterFieldVars:[],filterFields:[],parentFields:[]};this.lists=e}return this},t.addList=function(e,t){return this.lists[e]=t,this},t.setFields=function(e){return Array.isArray(e)&&(this.fields=e),this},t.addField=function(e,t,a){return this.fields.find((t=>t[0]==e))||this.fields.push([e,t,a]),this},t.addFields=function(e){return Array.isArray(e)&&(this.fields=[...this.fields,...e]),this},t.setValidate=function(e){return this.validate=e,this},t.setCustomValidate=function(e){return this.customValidate=e,this},t.setValidateRequired=function(e){return this.validateRequired=e,this},t.setSubmit=function(e){return this.submit=e,this},t.setFormKeyCountName=function(e){return this.formKeyCountName=e,this},t.setEmptyRow=function(e){return this.emptyRow=e,this},t.setMultiPage=function(e){return this.multiPage=e,this},t.setSubmitWithFetch=function(e){return this.submitWithFetch=e,this},t.setFilterList=function(e){return this.filterList=e,this},t.setInitSearchPanel=function(e){return this.initSearchPanel=e,this},t.setEnableOnInit=function(e){return this.enableOnInit=e,this},t.build=function(){let e=new ew.Form(this.id,this.pageId);return Array.isArray(this.fields)&&e.addFields(this.fields),"function"==typeof this.validate&&(e.validate=this.validate),"function"==typeof this.customValidate&&(e.customValidate=this.customValidate),"function"==typeof this.emptyRow&&(e.emptyRow=this.emptyRow),"function"==typeof this.submit&&(e.submit=this.submit),this.formKeyCountName&&(e.formKeyCountName=this.formKeyCountName),this.multiPage&&(e.multiPage=new ew.MultiPage(this.id)),this.enableOnInit&&(e.enableOnInit=!0),this.submitWithFetch&&(e.submitWithFetch=!0,e.on("aftersubmit",((e,t)=>ew.refresh(null==t?void 0:t.result)))),this.filterList&&(e.filterList=this.filterList),this.lists&&(e.lists=this.lists),e.validateRequired=!!this.validateRequired,e.initSearchPanel=!!this.initSearchPanel,e.lists=this.lists,e},e}(),_=function(){function e(e){var t,a;h(this,"_isAutoSuggest",null),this.elementId=e.id,this.form=e.form,i.default.isString(this.form)&&(this.form=ew.forms.get(this.form)),this.element=this.form.getElement(this.elementId),this.formElement=this.form.getElement(),this.list=this.form.getList(this.element);let n=this.elementId.match(/^[xy](\d*|\$rowindex\$)_/),l=n?n[1]:"";this.parentFields=null!=(t=null==(a=this.list.parentFields)?void 0:a.slice().map((e=>1==e.split(" ").length?e.replace(/^x_/,"x"+l+"_"):e)))?t:[],this.limit=e.limit,this.debounce=e.debounce,this.data=e.data,this.recordCount=0,this.action=e.action||"autosuggest"}var t=e.prototype;return t.formatResult=function(e){return this.form.compileTemplates(),this.list.template&&!this.isAutoSuggest?this.list.template.render(e,ew.jsRenderHelpers):ew.displayValue(e,this.element)||e[0]},t.generateRequest=function(){var e=Object.assign({},this.data,{name:this.element.name,page:this.list.page,field:this.list.field,language:ew.LANGUAGE_ID},ew.getUserParams("#p_"+this.elementId,this.formElement));return null!=e.ajax||(e.ajax=this.action),this.parentFields.length>0&&this.parentFields.forEach(((t,a)=>e["v"+(a+1)]=ew.getOptionValue(t,this.formElement))),e},t.getUrl=function(e,t){let a=new URLSearchParams({q:e||"",n:this.limit,rnd:ew.random(),start:i.default.isNumber(t)?t:-1});return ew.getApiUrl(ew.API_LOOKUP_ACTION,a.toString())},t.prepare=function(e,t){return{url:this.getUrl(e,t),type:"POST",dataType:"json",data:this.generateRequest()}},t.transform=function(e){let t=[];return"OK"==(null==e?void 0:e.result)&&(this.recordCount=e.totalRecordCount,t=e.records),t},t.toSelect2Data=function(e){if(Array.isArray(e)){if(e.every((e=>e.hasOwnProperty("gf")))){return[...new Set(e.map((e=>e.gf)))].map((t=>({text:t,children:e.filter((e=>e.gf==t)).map((e=>({id:e.lf,text:this.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))})))}return e.map((e=>({id:e.lf,text:this.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}return e},u(e,[{key:"isAutoSuggest",get:function(){return null!=this._isAutoSuggest||(this._isAutoSuggest=ew.isAutoSuggest(this.element)),this._isAutoSuggest}},{key:"options",get:function(){return this.list.lookupOptions}}]),e}(),A=function(e){function t(t){var a;if((a=e.call(this,t)||this).input=a.form.getElement("sv_"+a.elementId),!a.input||a.elementId.includes("$rowindex$"))return c(a);let n=c(a),l=i.default(a.input),r=i.default(a.element);a.minWidth=t.minWidth,a.maxHeight=t.maxHeight,a.highlight=t.highlight,a.hint=t.hint,a.minLength=t.minLength,a.templates=Object.assign({},t.templates),a.classNames=Object.assign({},t.classNames),a.delay=t.delay,a.debounce=t.debounce,a.display=t.display||"text",a.forceSelection=t.forceSelect,a.lineHeight=t.lineHeight,a.paddingY=t.paddingY,a.lookupAllDisplayFields=t.lookupAllDisplayFields,a.$input=l,a.$element=r,r.data("autosuggest",c(a)),l.val()&&r.val()&&a.element.add(r.val(),l.val(),!0),l.on("typeahead:select",((e,t)=>{n.setValue(t[n.display])})).on("change",(()=>{let e=l.data("tt-typeahead");if(null!=e&&e.isOpen()&&!e.menu.empty()){let t=e.menu.getActiveSelectable();if(t){let e=t.index(),a=n.element.options[e].text;l.typeahead("val",a)}}n.setValue()})).on("blur",(()=>{let e=l.data("tt-typeahead");null!=e&&e.isOpen()&&e.menu.close()})).on("focus",(()=>{l.attr("placeholder",l.data("placeholder")).removeClass("is-invalid"),r.removeClass("is-invalid")}));let o,s=!a.options.length,d=!1,u=n.list.template||n.templates.suggestion;u&&i.default.isString(u)&&(u=i.default.templates(u)),u&&(n.templates.suggestion=u.render.bind(u)),s&&!n.templates.footer&&(n.templates.footer='<div class="tt-footer dropdown-item"><div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+ew.language.phrase("LoadingMore")+"</span></div></div>");let f=(e,t,n)=>{if(s)o&&o.cancel(),o=i.default.later(a.debounce,null,(()=>{a.recordCount=0,i.default.ajax(a.prepare(e)).done((e=>n(a.transform(e))))}));else{let n=a.getSyncResults(e);t(a.transform({result:"OK",totalRecordCount:n.length,records:n}))}};return i.default((function(){let e=[{highlight:n.highlight,minLength:n.minLength,hint:n.hint,classNames:n.classNames},{name:n.form.id+"-"+n.elementId,source:f,async:s,templates:n.templates,display:n.display,limit:s?n.limit:1/0}];r.trigger("typeahead",[e]),n.typeahead=l.typeahead.apply(l,e).off("blur.tt").data("tt-typeahead");let t=n.typeahead.menu.$node,a=t.find(".tt-dataset"),o=()=>t.find(".tt-suggestion").outerHeight(!1);if(n.minWidth&&t.css("min-width",n.minWidth),l.on("typeahead:rendered",((e,l)=>{let i=l.length,r=n.count;if(r>=n.limit){let e=o();e&&a.css("max-height",e*n.limit)}i>0&&a.scrollTop(o()*(r-i)),s&&t.find(".tt-footer").toggle(n.recordCount>r)})),s){let e;a.on("scroll",(()=>{var l;null==(l=e)||l.cancel(),e=i.default.later(n.delay,null,(()=>{let l=t.find(".tt-footer");if(!l.is(":hidden")&&!d){var i;if(a.offset().top+a.outerHeight(!1)+20>l.offset().top+l.outerHeight(!1))d=!0,n.getMore().always((()=>d=!1));else null==(i=e)||i.cancel()}}))}))}})),a}p(t,e);var a=t.prototype;return a.setValue=function(e){e||(e=this.$input.val());let t=this.element.options.findIndex((t=>t.text==e));if(t<0){if(this.forceSelection&&e)return this.$input.typeahead("val","").addClass("is-invalid"),this.$element.next(".invalid-feedback").html(ew.language.phrase("ValueNotExist")),void this.$element.addClass("is-invalid").val("").trigger("change")}else this.element.options[t].selected=!0,/s(ea)?rch$/.test(this.formElement.id)&&!this.forceSelection||(e=this.element.options[t].value);e!==this.$element.attr("value")&&this.$element.attr("value",e).trigger("change")},a.transform=function(t){let a=e.prototype.transform.call(this,t).map((t=>Object.assign({},t,{text:e.prototype.formatResult.call(this,t)})));return this.element.options=a.map((e=>new ew.SelectionListOption(e.text,e.lf||e[0]))),a},a.getSyncResults=function(e){if(this.options.length){let t=this.options.filter((t=>{if(this.lookupAllDisplayFields){let a=[t.df,t.df2,t.df3,t.df4].map((e=>String(e).toLowerCase())).join(" ");return e.toLowerCase().split(" ").filter((e=>""!==e)).every((e=>a.includes(e)))}return String(t.df).toLowerCase().startsWith(e)}));return this.recordCount=t.length,t}return[]},a.getMore=function(){let e=this.typeahead.menu,t=this.count,a=this.prepare(e.query,t);return i.default.ajax(a).done((t=>e.datasets[0]._append(e.query,this.transform(t))))},u(t,[{key:"count",get:function(){return this.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length||0}}]),t}(_),E=function(){function e(){h(this,"_forms",{})}var t=e.prototype;return t.get=function(e){var t;if(!e)return null;let a=i.default.isString(e)?e:null==(t=ew.getForm(e))?void 0:t.id;return this._forms[a]},t.add=function(e){this._forms[e.id]&&this._forms[e.id]!==e&&delete this._forms[e.id],this._forms[e.id]=e},t.ids=function(){return Object.keys(this._forms)},e}(),S=ew.language.phrase("select2");var T={errorLoading:function(){return S.errorLoading},inputTooLong:function(e){var t=e.input.length-e.maximum;return S.inputTooLong.replace("%s",t)},inputTooShort:function(e){var t=e.minimum-e.input.length;return S.inputTooShort.replace("%s",t)},loadingMore:function(){return'<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+S.loadingMore+"</span></div>"},maximumSelected:function(e){return S.maximumSelected.replace("%s",e.maximum)},noResults:function(){return S.noResults},searching:function(){return'<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+S.searching+"</span></div>"},removeAllItems:function(){return S.removeAllItems},removeItem:function(){return S.removeItem},search:function(){return S.search}};let I=i.default.fn.select2.amd.require._defined["select2/utils"],O=function(){function e(){}var t=e.prototype;return t.render=function(e){var t=i.default('<div class="select2-results__options '+this.options.get("containerClass")+'" role="listbox"></div>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},t.displayMessage=function(e,t){var a=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=i.default('<div role="alert" aria-live="assertive" class="select2-results__option"></div>');if(t.message.includes("<")&&t.message.includes(">"))n.append(t.message);else{var l=this.options.get("translations").get(t.message);n.append(a(l(t.args)))}n[0].className+=" select2-results__message",this.$results.append(n)},t.append=function(e,t){if(this.hideLoading(),null!=t.results&&0!==t.results.length){t.results=this.sort(t.results);for(var a=this.options.get("columns"),n=t.results.length,l=this.$results.find("."+this.options.get("rowClass")).last(),r=0;r<t.results.length;r++){var o=t.results[r],s=this.option(o);if(l.length&&l.children().length!=a||(l=i.default('<div class="'+this.options.get("rowClass")+'"></div>'),this.$results.append(l)),l.append(s),r==n-1)for(var d=a-l.children().length,u=0;u<d;u++)l.append('<div class="'+this.options.get("cellClass")+'"></div>')}}else 0===this.$results.children().length&&(this.$element.data("updating")&&t.pagination.more?(this.trigger("results:message",{message:'<div class="spinner-border spinner-border-sm text-primary ew-select-spinner" role="status"><span class="visually-hidden">'+ew.language.phrase("Loading")+"</span></div> "+ew.language.phrase("Loading")}),this.$element.one("updated",(()=>this.$element.select2("close").select2("open")))):this.trigger("results:message",{message:"noResults"}))},t.option=function(e,t){var a=document.createElement("div");a.classList.add("select2-results__option"),a.classList.add("select2-results__option--selectable"),this.options.get("cellClass").split(" ").forEach((e=>a.classList.add(e)));var n={role:"option","aria-selected":"false"},l=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var i in(null!=t.element&&l.call(t.element,":disabled")||null==t.element&&t.disabled)&&(n["aria-disabled"]="true",a.classList.remove("select2-results__option--selectable"),a.classList.add("select2-results__option--disabled")),null==t.id&&a.classList.remove("select2-results__option--selectable"),null!=t._resultId&&(a.id=t._resultId),t.title&&(a.title=t.title),n){var r=n[i];a.setAttribute(i,r)}return this.template(t,a),I.StoreData(a,"data",t),a},e}(),x=i.default.fn.select2.amd.require._defined["select2/utils"],C=function(){function e(){}return e.prototype.bind=function(e,t,a){var n,l=this;e.call(this,t,a),null==(n=t.listeners["results:select"])||n.pop(),this.$results.off("mouseup"),t.on("results:select",(function(e){var t=l.getHighlightedResults();if(0!==t.length){var a=x.GetData(t[0],"data");t.hasClass("select2-results__option--selected")?l.trigger("unselect",{originalEvent:e,data:a}):l.trigger("select",{originalEvent:e,data:a})}})),this.$results.on("mousedown",".select2-results__option--selectable",(function(e){this._mousedown=!0})),this.$results.on("mouseup",".select2-results__option--selectable",(function(e){if(this._mousedown){var t=i.default(this),a=x.GetData(this,"data");t.hasClass("select2-results__option--selected")?l.trigger("unselect",{originalEvent:e,data:a}):l.trigger("select",{originalEvent:e,data:a})}}))},e}(),P=function(){function e(){}return e.prototype.bind=function(e,t,a){var n,l=this;e.call(this,t,a),null==(n=t.listeners.close)||n.pop(),t.on("close",(function(){l.$search.attr("tabindex",-1).removeAttr("aria-controls").removeAttr("aria-activedescendant")}))},e}(),N=$.fn.select2.amd.require._defined["select2/keys"];N.PRINT_SCREEN=44;let R=function(){function e(){}return e.prototype.handleSearch=function(e,t){var a=t.which;if(![N.TAB,N.SHIFT,N.CTRL,N.ALT,N.PRINT_SCREEN].includes(a)){if(!this._keyUpPrevented){var n=this.$search.val();this.trigger("query",{term:n})}this._keyUpPrevented=!1}},e}(),L=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}p(t,e);var a=t.prototype;return a._attachPositioningHandler=function(e,t){var a=this,n=["scroll.select2."+t.id,"resize.select2."+t.id,"orientationchange.select2."+t.id],l=()=>{a._positionDropdown(),a._resizeDropdown()};i.default(window).on(n.join(" "),l),t.$element.closest(".modal").on("scroll.select2."+t.id,l)},a._detachPositioningHandler=function(e,t){var a=["scroll.select2."+t.id,"resize.select2."+t.id,"orientationchange.select2."+t.id];i.default(window).off(a.join(" ")),t.$element.closest(".modal").off("scroll.select2."+t.id)},a._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),null!=this._popper||(this._popper=Popper.createPopper(this.$container[0],this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(i.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),F=function(){function e(e,t,a){h(this,"$modal",null),a.set("dropdownParent",i.default(document.body)),e.call(this,t,a)}var t=e.prototype;return t.bind=function(e,t,a){let n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},t.position=function(e,t,a){t.attr("class",a.attr("class")),t.removeClass("select2"),this.$container=a},t.render=function(e){let t=i.default("<span></span>"),a=e.call(this);return t.append(a),this.$dropdownContainer=t,t},t._bindContainerResultHandlers=function(e,t){if(this._containerResultsHandlersBound)return;let a=this;t.$modal=this.$modal,t.on("results:all",(function(){var e;a._updateDropdown(),null==(e=a.$search[0])||e.focus()})),t.on("results:append",(function(){a._updateDropdown()})),t.on("results:message",(function(){a._updateDropdown()})),t.on("select",(function(e){var t;let n=null==(t=e.originalEvent)?void 0:t.currentTarget;null==n||n.classList.add("select2-results__option--selected"),a._updateDropdown()})),t.on("unselect",(function(e){var t;let n=null==(t=e.originalEvent)?void 0:t.currentTarget;null==n||n.classList.remove("select2-results__option--selected"),a._updateDropdown()})),this._containerResultsHandlersBound=!0},t._updateDropdown=function(){this.$modal.find(this.$dropdownContainer)[0]||this.$modal.find(".modal-body").children().detach().end().append(this.$dropdownContainer)},t._showDropdown=function(e){let t=this,a=this.$element.val();this.$dropdownContainer.appendTo(this.options.get("dropdownParent")),null!=this.$modal||(this.$modal=i.default("#ew-modal-lookup-dialog")),this._updateDropdown(),this.$modal.find(".modal-title").empty().append(ew.language.phrase("LookupTitle").replace("%s",this.$element.data("caption"))),this.$modal.find(".modal-footer button[data-value]").off().on("click",(function(){i.default(this).data("value")||t.$element.val(a).trigger("change")})),this.$modal.modal("show").on("hidden.bs.modal",(function(e){t.$container.removeClass("select2-container--open")})).draggable(this.options.get("draggableOptions"))},e}(),k=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}p(t,e);var a=t.prototype;return a.bind=function(e,t,a){var n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),t.on("close",(function(){n._hideDropdown()})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},a._showDropdown=function(e){var t;this.$dropdownContainer.appendTo(this.$dropdownParent);let a=this,n=this.$element.val(),l=i.default("#ew-filter-dropdown-footer").contents().clone();l.find(".ew-filter-btn[data-value]").off("click.ew").on("click.ew",(function(e){i.default(this).data("value")?i.default(a.$element[0].form).triggerHandler("submit"):a.$element.val(n).trigger("change"),a.$element.select2("close")})),l.find(".ew-filter-clear").off("click.ew").on("click.ew",(e=>a.$element.data("select2").selection._handleClear(e)));let r=this.$dropdownContainer.find(".ew-filter-dropdown");r.find(".ew-filter-btn")[0]||r.append(l);var o=document.querySelector(".ew-filter-dropdown-btn[data-table="+this.$element.data("table")+"][data-field="+this.$element.data("field")+"]"),s=null!=(t=o.closest(".ew-table-header-cell"))?t:o.closest(".ew-table-header-btn");null!=this._popper||(this._popper=Popper.createPopper(s,this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a.position=function(e,t,a){t.attr("class",a.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),this.$container=a},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(i.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),D=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}p(t,e);var a=t.prototype;return a.bind=function(e,t,a){var n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),t.on("close",(function(){n._hideDropdown()})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},a._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),null!=this._popper||(this._popper=Popper.createPopper(this.$element.parent().find(".select2-container")[0],this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a.position=function(e,t,a){t.attr("class",a.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),this.$container=a},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(i.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),M=i.default.fn.select2.amd.require._defined,j=M["select2/selection/allowClear"],U=M["select2/utils"],B=function(e){function t(){return e.apply(this,arguments)||this}return p(t,e),t.prototype._handleClear=function(e,t){if(!this.isDisabled()){var a=this.$selection.find(".select2-selection__clear");if(0!==a.length){t.stopPropagation();var n=U.GetData(a[0],"data"),l=this.$element.val();this.$element.val(this.placeholder.id);var i={data:n};if(this.trigger("clear",i),i.prevented)this.$element.val(l);else{for(var r=0;r<n.length;r++)if(i={data:n[r]},this.trigger("unselect",i),i.prevented)return void this.$element.val(l);this.$element.trigger("input").trigger("change")}}}},t}(j),V=function(){function e(){}return e.prototype.bind=function(e,t,a){e.call(this,t,a),this.$selection.on("click",".select2-selection__choice__remove",(function(e){e.stopPropagation()}))},e}(),H=function(){function e(){}return e.prototype.option=function(e,t){var a,n=t.text,l=null==(a=t.element)?void 0:a.innerHTML,i=e.call(this,t);return n.startsWith("<")&&n.endsWith(">")?i.html(n):l&&l!=n&&i.html(l),i},e}(),q=$.fn.select2.amd.require._defined,W=q["select2/results"],K=q["select2/selection/single"],G=q["select2/selection/multiple"],z=q["select2/selection/placeholder"],Y=q["select2/selection/allowClear"],J=q["select2/selection/search"],X=q["select2/selection/eventRelay"],Z=q["select2/utils"],Q=q["select2/translation"],ee=q["select2/data/select"],te=q["select2/data/array"],ae=q["select2/data/ajax"],ne=q["select2/data/tags"],le=q["select2/data/tokenizer"],ie=q["select2/data/minimumInputLength"],re=q["select2/data/maximumInputLength"],oe=q["select2/data/maximumSelectionLength"],se=q["select2/dropdown"],de=q["select2/dropdown/search"],ue=q["select2/dropdown/hidePlaceholder"],ce=q["select2/dropdown/infiniteScroll"],fe=q["select2/dropdown/minimumResultsForSearch"],pe=q["select2/dropdown/selectOnClose"],he=q["select2/dropdown/closeOnSelect"],ge=q["select2/dropdown/dropdownCss"],me=q["select2/dropdown/tagsSearchHighlight"],we=q["select2/defaults"];we.apply=function(e){return null==(e=$.extend(!0,{},this.defaults,e)).dataAdapter&&(null!=e.ajax?e.dataAdapter=ae:null!=e.data?e.dataAdapter=te:e.dataAdapter=ee,e.dataAdapter=Z.Decorate(e.dataAdapter,H),e.minimumInputLength>0&&(e.dataAdapter=Z.Decorate(e.dataAdapter,ie)),e.maximumInputLength>0&&(e.dataAdapter=Z.Decorate(e.dataAdapter,re)),e.maximumSelectionLength>0&&(e.dataAdapter=Z.Decorate(e.dataAdapter,oe)),e.tags&&(e.dataAdapter=Z.Decorate(e.dataAdapter,ne)),null==e.tokenSeparators&&null==e.tokenizer||(e.dataAdapter=Z.Decorate(e.dataAdapter,le))),null==e.resultsAdapter&&(e.resultsAdapter=W,e.columns>0&&e.customOption?(e.resultsAdapter=Z.Decorate(e.resultsAdapter,O),e.iconClass&&e.multiple&&e.templateResult==ew.selectOptions.templateResult&&(e._templateResult=e.templateResult,e.templateResult=t=>t.loading?t.text:'<div class="form-check-input ew-dropdown-check-input"></div><label class="'+e.iconClass+' ew-dropdown-check-label">'+e._templateResult(t)+"</label>")):(e.modal||e.filter)&&(e.resultsAdapter=Z.Decorate(e.resultsAdapter,C)),null!=e.ajax&&(e.resultsAdapter=Z.Decorate(e.resultsAdapter,ce)),null!=e.placeholder&&(e.resultsAdapter=Z.Decorate(e.resultsAdapter,ue)),e.selectOnClose&&(e.resultsAdapter=Z.Decorate(e.resultsAdapter,pe)),e.tags&&(e.resultsAdapter=Z.Decorate(e.resultsAdapter,me))),null==e.dropdownAdapter&&(e.modal||e.filter?(e.dropdownAdapter=Z.Decorate(se,de),e.dropdownAdapter=Z.Decorate(e.dropdownAdapter,R),e.dropdownAdapter=Z.Decorate(e.dropdownAdapter,P)):(e.dropdownAdapter=se,e.multiple||(e.dropdownAdapter=Z.Decorate(e.dropdownAdapter,de),e.dropdownAdapter=Z.Decorate(e.dropdownAdapter,R))),0!==e.minimumResultsForSearch&&(e.dropdownAdapter=Z.Decorate(e.dropdownAdapter,fe)),e.closeOnSelect&&(e.dropdownAdapter=Z.Decorate(e.dropdownAdapter,he)),null!=e.dropdownCssClass&&(e.dropdownAdapter=Z.Decorate(e.dropdownAdapter,ge)),e.dropdownAdapter=Z.Decorate(e.dropdownAdapter,e.modal?F:e.filter?k:e.dropdown?D:L)),null==e.selectionAdapter&&(e.multiple?(e.selectionAdapter=G,e.selectionAdapter=Z.Decorate(e.selectionAdapter,V)):e.selectionAdapter=K,null!=e.placeholder&&(e.selectionAdapter=Z.Decorate(e.selectionAdapter,z)),e.allowClear&&(e.selectionAdapter=Z.Decorate(e.selectionAdapter,e.filter?B:Y)),e.multiple&&(e.selectionAdapter=Z.Decorate(e.selectionAdapter,J)),e.selectionAdapter=Z.Decorate(e.selectionAdapter,X)),e.translations=new Q(T),e.dir=ew.IS_RTL?"rtl":"ltr",e};let ve=new URL(window.location),be=new E,ye=i.default(document),_e=i.default("body"),Ae=".row, [id^=el_], [class^=el_]";function Ee(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n={...ew.tooltipOptions,container:"body",trigger:ew.IS_MOBILE?"manual":"hover"};i.default(a).find(".ew-icon").closest(".btn, .ew-home, .ew-row-link:not(.dropdown-item)").each((function(){let e=i.default(this);if(e.hasClass("dropdown-toggle")){let t=e.closest(".btn-group");1==t.children(".btn").length&&(t.tooltip({...n,title:this.dataset.title||this.title}).on("mouseleave",(e=>{var t;return null==(t=bootstrap.Tooltip.getInstance(e.currentTarget))?void 0:t.hide()})),e.next(".dropdown-menu").on("mouseover",(e=>e.stopPropagation())))}else e.tooltip(n)}))}function Se(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document;i.default.fn.pStrength&&"undefined"!=typeof ew.MIN_PASSWORD_STRENGTH&&i.default(a).find(".ew-password-strength").each((function(){var e=i.default(this);e.data("pStrength")||e.pStrength({changeBackground:!1,backgrounds:[],passwordValidFrom:ew.MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(e,t){var a=i.default("[id='"+this.attr("data-password-strength")+"']"),n=a.find(".progress-bar");if(this.val()&&!ew.isMaskedPassword(this)){var l=t+"%",r=ew.MIN_PASSWORD_STRENGTH,o=t>=r;t<.25*r?n.addClass("bg-danger").removeClass("bg-warning bg-info bg-success"):t<.5*r?n.addClass("bg-warning").removeClass("bg-danger bg-info bg-success"):t<.75*r?n.addClass("bg-primary").removeClass("bg-danger bg-warning bg-success"):n.addClass("bg-success").removeClass("bg-danger bg-warning bg-info"),n.css("width",l),t>.5*r&&(l=ew.language.phrase("PasswordStrength").replace("%p",l)),n.html(l),a.removeClass("d-none"),this.data("validated",o),o&&gt(this[0])}else a.addClass("d-none"),this.data("validated",null);a.width(this.outerWidth())}})})),i.default.fn.pGenerator&&i.default(a).find(".ew-password-generator").each((function(){var e=i.default(this);e.data("pGenerator")||e.pGenerator({passwordLength:ew.GENERATE_PASSWORD_LENGTH,uppercase:ew.GENERATE_PASSWORD_UPPERCASE,lowercase:ew.GENERATE_PASSWORD_LOWERCASE,numbers:ew.GENERATE_PASSWORD_NUMBER,specialChars:ew.GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(e){i.default("#"+this.attr("data-password-confirm")).val(e),i.default("#"+this.attr("data-password-field")).val(e).trigger("change").trigger("focus").triggerHandler("click")}})}))}function Te(e,t){var a=ew.PATH_BASE+ew.API_URL,n=(t instanceof URLSearchParams?t:new URLSearchParams(t)).toString();if(i.default.isString(e))a+=e||"";else if(Array.isArray(e)){var l=e.map((function(e){return encodeURIComponent(e)})).join("/");a+=l||""}return a+(n?"?"+n:"")}function Ie(e){var t,a;let n,l,i;[n,i]=e.split("#"),[n,l]=n.split("?"),!l&&n.includes("=")&&([n,l]=["",n]);let r={url:e,pathname:null!=(t=n)?t:"",hash:null!=(a=i)?a:"",searchParams:new URLSearchParams(l)};return Object.defineProperty(r,"search",{value:l,writable:!1,enumerable:!0}),r}function Oe(e){try{return new URLSearchParams(e)}catch(e){return console.log(e),new URLSearchParams}}function xe(e){return Ie(e).searchParams}function Ce(e){let t=Ie(e);for(var a=arguments.length,n=new Array(a>1?a-1:0),l=1;l<a;l++)n[l-1]=arguments[l];return t.searchParams=Pe(t.searchParams,...n),Le(t)}function Pe(){let e=new URLSearchParams;for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];for(const t of a)if(i.default.isObject(t)||i.default.isString(t)&&t){(t instanceof URLSearchParams?t:Oe(t)).forEach(((t,a)=>e.has(a)&&a.endsWith("[]")?e.append(a,t):e.set(a,t)))}return e}function Ne(e,t,a){return Ce(e,{[t]:a})}function Re(e){let t=Ie(e);for(var a=arguments.length,n=new Array(a>1?a-1:0),l=1;l<a;l++)n[l-1]=arguments[l];return n.forEach((e=>t.searchParams.delete(e))),Le(t)}function Le(e){let t=e.searchParams.toString();return e.pathname+(e.pathname&&t?"?":"")+t+(e.hash?"#"+e.hash:"")}function Fe(e,t){return e&&"#"!=e?Ce(e,{[ew.PAGE_LAYOUT]:String(t)}):e}function ke(e){let t=Ie(e),a=t.searchParams;return a.forEach(((e,t)=>{e=decodeURIComponent(e),["<>","<=",">=",">","<"].includes(e)?a.set(t,e):a.set(t,ew.sanitize(e))})),Le(t)}function De(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document;i.default(a).find("a.ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)").on("click",(function(e){let t=this.href;t&&"#"!=t&&$e(t,lt()),e.preventDefault()}))}function Me(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document,n=i.default(a),l=n.find("input[type=checkbox].ew-multi-select"),r=function(e){var t=l.filter("[name^='"+e+"_']"),a=t.length,n=t.filter(":checked").length;i.default("input[type=checkbox]#"+e).prop("checked",n==a).prop("indeterminate",n!=a&&0!=n)};l.on("click",(e=>r(e.target.name.split("_")[0]))),n.find("input[type=checkbox].ew-priv:not(.ew-multi-select)").each(((e,t)=>r(t.id)))}function je(e){var t,a;return e&&((null==(t=e.error)?void 0:t.description)||(null==(a=e.error)?void 0:a.message)||i.default.isString(e.error)&&e.error||e.failureMessage||!1===e.success&&e.message||null)}function $e(e,t){let a=e.includes("export=html")||e.includes(Te([ew.API_EXPORT_ACTION,"html"])),n=window.parent.Swal;return n.fire({...ew.sweetAlertSettings,showConfirmButton:!1,html:"<p>"+ew.language.phrase("Exporting")+"</p>",allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{n.showLoading(),Bt(e,{method:t?"POST":"GET",body:t||null}).then((async t=>{let l=t.headers.get("Content-Type");if(null!=l&&l.includes("json")){var i;let a=null!=(i=je(await t.json()))?i:ew.language.phrase("FailedToExport");a&&(n.hideLoading(),n.update({html:"<div class='text-danger'>"+a+"</div>",showConfirmButton:!0}),ye.trigger("export",[{type:"fail",url:e}]))}else{let l=a?await t.text():await t.blob(),i=URL.createObjectURL(a?new Blob([l],{type:"text/html"}):l),r=document.createElement("a"),o=t.headers.get("Content-Disposition"),s=null==o?void 0:o.match(/\bfilename=((['"])(.+)\2|([^;]+))/i);r.style.display="none",r.href=i,s&&(r.download=s[3]||s[4]),document.body.appendChild(r),r.click(),ye.trigger("export",[{type:"done",url:e,objectUrl:i}]),URL.revokeObjectURL(i),n.close()}})).catch((t=>{n.hideLoading(),n.update({html:"<div class='text-danger'>"+t+"</div>",showConfirmButton:!0}),ye.trigger("export",[{type:"fail",url:e}])})).finally((()=>{ye.trigger("export",[{type:"always",url:e}])}))}})}function Ue(e){var t;ew.LAZY_LOAD&&((null!=(t=null==e?void 0:e.target)?t:document).querySelectorAll("img.ew-lazy").forEach(((e,t)=>{ew.LAZY_LOAD_DELAY>0?setTimeout((()=>e.src=e.dataset.src),t*ew.LAZY_LOAD_DELAY):e.src=e.dataset.src})),ye.trigger("lazyload"))}function Be(e){var t;if(ew.USE_COLORBOX){var a=null!=(t=null==e?void 0:e.target)?t:document,n=Object.assign({},ew.lightboxSettings,{title:ew.language.phrase("LightboxTitle"),current:ew.language.phrase("LightboxCurrent"),previous:ew.language.phrase("LightboxPrevious"),next:ew.language.phrase("LightboxNext"),close:ew.language.phrase("LightboxClose"),xhrError:ew.language.phrase("LightboxXhrError"),imgError:ew.language.phrase("LightboxImgError")});i.default(a).find(".ew-lightbox").each((function(){var e=i.default(this);e.colorbox(Object.assign({rel:e.data("rel")},n))}))}}function Ve(e){var t;if(!ew.EMBED_PDF)return;let a=null!=(t=null==e?void 0:e.target)?t:document,n=Object.assign({},ew.PDFObjectOptions);i.default(a).find(".ew-pdfobject").not(":has(.pdfobject)").each((function(){let e=i.default(this),t=e.data("url"),a=e.html();t&&PDFObject.embed(t,this,Object.assign(n,{fallbackLink:a}))}))}function He(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n=i.default(a);n.find("input[data-bs-toggle=tooltip], textarea[data-bs-toggle=tooltip], select[data-bs-toggle=tooltip]").each((function(){let e=i.default(this);e.tooltip({...ew.tooltipOptions,html:!0,...e.data()})})),n.find("a.ew-tooltip-link").each(Xt),n.find(".ew-tooltip").tooltip(ew.tooltipOptions),n.find(".ew-popover").popover(ew.popoverOptions)}function qe(e){if(i.default.isString(e))try{return JSON.parse(e)}catch(e){return}return e}function We(e){let t=i.default(e).closest("[id^=r_], [id^=xs_]"),a=e.id.substring(2),n=t.find(".ew-search-field"),l=t.find(".ew-search-field2"),r=l.find("[name='y_"+a+"'], [name='y_"+a+"[]']").length,o=t.find(".ew-search-cond"),s=o.length,d=t.find(".ew-search-and"),u=t.find(".ew-search-operator").find("[name='z_"+a+"']").val(),c=t.find(".ew-search-operator2"),f=c.find("[name='w_"+a+"']").val(),p=u.includes("BETWEEN"),h=["IS NULL","IS NOT NULL","IS EMPTY","IS NOT EMPTY"].includes(u),g=["IS NULL","IS NOT NULL","IS EMPTY","IS NOT EMPTY"].includes(f),m=!r||p,w=h,v=!p&&(!s||g);o.toggleClass("d-none",m).find(":input").prop("disabled",m),d.toggleClass("d-none",!p),c.toggleClass("d-none",m).find(":input").prop("disabled",m),n.toggleClass("d-none",w).find(":input").prop("disabled",w),l.toggleClass("d-none",v).find(":input").prop("disabled",v)}function Ke(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n=ew.forms.ids();for(let e of n)(null!=a.matches&&a.matches("#"+e)||a.querySelector("#"+e))&&be.get(e).init()}function Ge(e){return"function"==typeof e}function ze(e,t,a){let n=i.default.isObject(e)?e:{};e=i.default.isString(e)?e:"",a=i.default.isString(t)?t:a,n=i.default.extend(!0,{},ew.sweetAlertSettings,{html:e,confirmButtonText:ew.language.phrase("OKBtn"),customClass:{htmlContainer:"ew-swal2-html-container text-"+(a||"danger")}},n);let l={config:n,type:a,show:!0};if(ye.trigger("alert",[l]),l.show)return Swal.fire(l.config).then((e=>Ge(t)?t(e.isConfirmed):e))}function Ye(e,t){var a;let n=i.default.isObject(e)?e:{};return n=i.default.extend(!0,{},ew.sweetAlertSettings,{html:i.default.isString(e)?e:"",showCancelButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),cancelButtonText:ew.language.phrase("CancelBtn")},n),n.input&&(null!=(a=n).inputValidator||(a.inputValidator=e=>{if(!e)return ew.language.phrase("EnterValue")})),Swal.fire(n).then((e=>Ge(t)?t(e.value):e))}function Je(e){e=Object.assign({},ew.toastOptions,e),ye.Toasts("create",e);var t=e.position;return i.default("#toastsContainer"+t[0].toUpperCase()+t.substring(1)).children().first()}function Xe(e,t,a){if(!e)return;t||(t="danger"),a||(a=ew.language.phrase(t));let n={message:e,type:t,title:a,show:!0};return ye.trigger("toast",[n]),n.show?(({message:e,type:t,title:a}=n),Je({class:"ew-toast bg-"+t,title:a,body:e,autohide:"success"==t&&ew.autoHideSuccessMessage,delay:"success"==t?ew.autoHideSuccessMessageDelay:500})):void 0}function Ze(e){if(e instanceof b)return e.$element[0];var t=i.default(e),a=t.closest(".ew-form");return a[0]||(a=t.closest(".ew-grid, .ew-multi-column-grid").find(".ew-form")),a[0]}function Qe(e,t,a,n){var l,r,o=this.$element?this.$element[0]:this.form||(null==(l=e)?void 0:l.form);if(o&&((this.htmlForm?this:be.get(o.id))&&(this.form&&i.default.isUndefined(e)?e=be.get(this).getList(this).childFields.slice():i.default.isString(e)&&(e=Tt(e,o)),e&&(!Array.isArray(e)||0!=e.length)))){var s=this,d=new g;if(Array.isArray(e)&&i.default.isString(e[0])){for(var u=[],c=0,f=e.length;c<f;c++){var p=e[c].split(" ");if(1==p.length&&s.form){var h=kt(s,!1).match(/^([xy]\d*_)/);h&&(e[c]=e[c].replace(/^([xy]\d*_)/,h[1]))}var m=Tt(e[c],o),w=[];if(!ft(m)&&!st(m))if(u.push(m),2==p.length&&Array.isArray(m)){var v=i.default(m);v.each((function(){if(!w.includes(this.name)){w.push(this.name);var e=v.filter("[name='"+this.name+"']"),l=e.attr("type"),i=["radio","checkbox"].includes(l)?e.get():e[0];d.add(et.bind(s,i,t,a,n))}}))}else d.add(et.bind(s,m,t,a,n))}e=u;var b=be.get(s).getList(s);Array.isArray(null==b?void 0:b.autoFillTargetFields)&&b.autoFillTargetFields[0]&&d.add(Jt.bind(null,s))}else{if(ft(e)||st(e))return;d.add(et.bind(s,e,t,a,n))}return null==(r=d.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)}))?void 0:r.then((function(){ye.trigger("updatedone",[{source:s,target:e}])}))}}function et(e,t,a,n){var l=kt(e,!1);if(l){var r=Ze(e);if(r&&r.id){var o=be.get(r.id);if(o){var s=this,d=Array.from(arguments),u=Nt(e),c=l.match(/^([xy])(\d*)_/),f=c?c[1]:"",p=c?c[2]:"",h=[],g=o.getList(e),m=i.default(e).data("updating",!0);if(!m.data("hidden")){if(i.default.isUndefined(t)&&(t=g.parentFields.slice(),""!=p))for(var w=0,v=t.length;w<v;w++){var b=t[w].split(" ");1==b.length&&(t[w]=t[w].replace(/^x_/,"x"+p+"_"))}if(Array.isArray(t)&&t.length>0)if(Array.isArray(t[0]))h=t;else if(i.default.isString(t[0]))for(w=0,v=t.length;w<v;w++)h.push(Nt(t[w],r));dt(e)||Ft(e);var y=function(t){var a=kt(e);t.forEach((function(t){let n={data:t,parents:h,valid:!0,name:a,form:r};ye.trigger("addoption",[n]),n.valid&&$t(e,t,r)})),null==e.render||e.render(),Ut(e,u),!1!==n&&(!e.options&&e.length?m.first().triggerHandler("click"):m.first().trigger("change"))};i.default.isUndefined(a)&&(a=g.ajax);var _=function(){/(srch|search|summary|crosstab)$/.test(r.id)&&"x"==f&&!p&&(d[0]=l.replace(/^x_/,"y_"),Qe.apply(s,d))};if(!i.default.isBoolean(a)||Array.isArray(g.lookupOptions)&&g.lookupOptions.length>0){var A=g.lookupOptions;return y(A),_(),A}var E=kt(e),S=Object.assign({page:g.page,field:g.field,ajax:"updateoption",language:ew.LANGUAGE_ID,name:E},tt("#p_"+l,r));dt(e)&&s.htmlForm?S.v0=u[0]||ia():(e.options&&!e.list&&!ct(e)||ot(e))&&(S.v0=u[0]?e.multiple?u.join(ew.MULTIPLE_OPTION_SEPARATOR):u[0]:ia());w=0;for(var T=h.length;w<T;w++)S["v"+(w+1)]=h[w].join(ew.MULTIPLE_OPTION_SEPARATOR);return null==e.showLoading||e.showLoading(),i.default.ajax(Te(ew.API_LOOKUP_ACTION),{method:"POST",dataType:"json",data:S,async:a,processData:!1,success:t=>{let a=je(t);if(a)return void ze(a);let n=t.records||[];return y(n),_(),m.first().trigger("updated",[Object.assign({},t,{target:e})]),n},error:(e,t,a)=>ze(a),complete:()=>m.data("updating",!1)})}}}}}function tt(e,t){e=e.replace(/\[\]$/,"");var a={},n=((t=i.default.isString(t)?/^#/.test(t)?t:"#"+t:t)?i.default(t).find(e):i.default(e)).val();n&&new URLSearchParams(n).forEach((function(e,t){a[t]=e}));return a}function at(e,t,a){var n;let l=document.getElementById(e);null!=(n=l.children[0])&&n.matches("div[id^=ct_]")&&(l=l.children[0]);let i={customexport:t,data:l.innerHTML,[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN,...lt()};"email"==t?Qt(a,Pe(ve.searchParams,i)):$e(Te([ew.API_EXPORT_ACTION,t,a]),i)}function nt(e){return e&&["1","y","t","true"].includes(String(e).toLowerCase())}function lt(){let e=Array.from(Object.entries(window.exportCharts)).map((e=>{let[t,a]=e;return{chartEngine:"Chart.js",streamType:"base64",stream:a.toBase64Image(),fileName:t+".png"}}));return e.length?{charts:JSON.stringify(e)}:null}async function it(e){let{evt:t,url:a,export:n,custom:l,exportSelected:r,emailForm:o}=e,s=t.currentTarget.form;if(r&&(r=s&&!!s.querySelector("input[type=checkbox][name='key_m[]']")),r&&!wt(s))return ze(ew.language.phrase("NoRecordSelected")),!1;let d=s?i.default(s):i.default('<form class="ew-export-form" method="post"></form>').appendTo(_e),u=d.attr("target"),c=d.attr("action"),f=[[ew.TOKEN_NAME_KEY,ew.TOKEN_NAME],[ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN]];try{if(l){var p;document.body.style.cursor="wait";let e="ew-export-frame";a=Ce(a,{export:n,custom:1},i.default(o).serialize()),null==(p=document.querySelector("iframe[name='"+e+"']"))||p.remove();let t=i.default("<iframe>").attr("name",e).addClass("d-none").appendTo(_e);d.attr({action:a,target:e}),f.forEach((e=>{let[t,a]=e;return d.find('input[name="'+t+'"]').val(a)[0]||i.default("<input>").attr({type:"hidden",name:t,value:a}).appendTo(d)})),t.one("load",(()=>document.body.style.cursor="default")).one("load",(()=>d.attr({action:c,target:u}))),d.trigger("submit")}else a=Ne(a,"export",n),"print"==n?d.attr("action",a).trigger("submit"):$e(a,Pe(d.serialize(),lt()))}finally{s||d.remove()}return!1}function rt(e){var t=i.default(e);return t.is(":hidden")&&t.data("editor")}function ot(e){var t;return null==e||null==(t=e.dataset)?void 0:t.modalLookup}function st(e){var t;return null==e||null==(t=e.dataset)?void 0:t.filter}function dt(e){var t=i.default(e);return t.is(":hidden")&&t.data("autosuggest")}function ut(e){return null==e||null==e.matches?void 0:e.matches("select.select2-hidden-accessible")}function ct(e){return(null==e||null==e.matches?void 0:e.matches("select:not(.select2-hidden-accessible)"))&&"select-one"==e.type}function ft(e){return(null==e||null==e.matches?void 0:e.matches("input:not([type=checkbox]):not([type=radio])"))&&!dt(e)}function pt(e){return null==e||null==e.matches?void 0:e.matches("input[type=checkbox][data-boolean]")}function ht(e,t){if(e){var a=i.default(e);if(!xt(a)){if(rt(e))return a.data("editor").focus();!e.options&&e.length?e=a[0]:dt(e)&&(e=e.input),e.focus(t)}}}function gt(e){if(!e)return;let t=i.default(e);if(xt(t))return;!e.options&&e.length&&(e=t[0]);let a=t.closest(Ae),n=()=>a.find(".is-valid").removeClass("is-valid");if(dt(e))a.find(".ew-auto-suggest").removeClass("is-invalid").addClass("is-valid").one("click keydown paste",n);else if(rt(e))t.removeClass("is-invalid").addClass("is-valid"),t.data("editor").instance.once("change",n);else if(ot(e))t.removeClass("is-invalid").addClass("is-valid").one("select2:open",n);else if(["checkbox","radio"].includes(e.type))t.removeClass("is-invalid").addClass("is-valid").one("click keydown",n);else{let e=ew.MOBILE_DETECT.version("Safari")&&!ew.MOBILE_DETECT.version("Chrome")?"change keydown paste":"click keydown paste";t.parent().one(e,n),t.add(t.closest(".input-group")).removeClass("is-invalid").addClass("is-valid")}}function mt(e){var t;let a=null==e?void 0:e.closest(".os-host");a?null==(t=OverlayScrollbars(a))||t.scroll(e):null==e||e.scrollIntoView()}function wt(e){return!(null==e||!e.querySelector("input[type=checkbox][name='key_m[]']:checked"))}function vt(e){null!=e&&e.form&&i.default(e.form.elements).filter("input[type=checkbox][name^="+e.name+"_], [type=checkbox][name="+e.name+"]").not(e).not(":disabled").prop("checked",e.checked)}function bt(e){let t=i.default(e).find("input[type=checkbox][name='key_m[]']:checked").closest("[data-rowindex]").map(((e,t)=>t.dataset.rowindex)).get();i.default(null==e?void 0:e.rows).filter(((e,a)=>a.classList.contains("table-active")&&!t.includes(a.dataset.rowindex))).removeClass("table-active ew-table-selected-row").triggerHandler("change")}function yt(e){if(!(null==e?void 0:e.closest(".ew-table")))return;let t=i.default(e).closest(".ew-table > tbody > tr");t.siblings("[data-rowindex='"+t.data("rowindex")+"']").addBack().removeClass("table-active").triggerHandler("change")}function _t(e){let t=null==e?void 0:e.closest(".ew-table");if(!t)return;bt(t);let a=i.default(e).closest(".ew-table > tbody > tr");a.siblings("[data-rowindex='"+a.data("rowindex")+"']").addBack().addClass("table-active").triggerHandler("change")}function At(){let e,t;i.default.isNumber(arguments[0])?e=arguments[1]:arguments[0]instanceof HTMLTableElement&&(e=arguments[0],t=arguments[1]);let a=i.default(e),n=i.default(e.rows);if(!e||!e.rows||!t&&e.dataset.isset||0==e.tBodies.length)return;let l=function(e){let t=i.default(this),a=this.closest(".ew-table"),n=i.default(e.target);!a||n.hasClass("btn")||n.hasClass("ew-preview-btn")||n.is(":input")||(bt(a),t.siblings("[data-rowindex='"+t.data("rowindex")+"']").addBack().toggleClass("table-active").triggerHandler("change"))},r=n.filter("[data-rowindex=1]").length||n.filter("[data-rowindex=0]").length||1,o=n.filter(":not(.ew-template)").each((function(){i.default(this.cells).removeClass("ew-table-last-row").last().addClass("ew-table-last-col")})).get();if(o.length>=r){let t=a.parentsUntil(".ew-grid","."+ew.RESPONSIVE_TABLE_CLASS)[0];o[o.length-1].classList.add("border-bottom-0"),o.splice(-1*r).forEach(((a,n)=>Array.from(a.cells).filter((e=>e.rowSpan==n+1)).forEach((a=>{a.classList.add("ew-table-last-row"),a.classList.toggle("ew-table-border-bottom",(null==t?void 0:t.clientHeight)>e.offsetHeight)}))))}let s=e.closest("form"),d=s&&i.default(s.elements).filter("input#action:not([value^=grid])").length>0;i.default(e.tBodies[e.tBodies.length-1].rows).filter(":not(.ew-template):not(.ew-table-preview-row)").each((function(){let e=i.default(this);d&&!e.data("isset")&&e.on("click",l).data("isset",!0)})),Et(e.closest(".ew-grid"),t),e.dataset.isset="true"}function Et(e,t){let a=i.default(e);!e||!t&&e.dataset.isset||(0!=a.find("table.ew-table > tbody").first().children("tr:not(.ew-table-preview-row, .ew-template)").length||e.querySelector(".ew-grid-upper-panel, .ew-grid-lower-panel")||a.hide(),a.find(".ew-grid-middle-panel:visible").hasClass(ew.RESPONSIVE_TABLE_CLASS)&&a.width()>i.default(".content").width()&&(a.addClass("d-flex"),a.closest(".ew-detail-pages").addClass("d-block"),a.closest(".ew-form").addClass("w-100")),e.dataset.isset="true")}function St(e){return String(e).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}function Tt(e,t){let a=[],n=e=>"[data-field='"+e+"']:not(.ew-custom-option):not([name^=y_]):not([data-old])";if(e instanceof HTMLElement&&e.dataset.table&&e.dataset.field){if(pt(e))return e;a=["[data-table='"+e.dataset.table+"']"+n(e.dataset.field)]}else if(i.default.isString(e)){let[t,l]=e.split(" ");a=l?["[data-table='"+t+"']"+n(kt(l))]:["[name='"+e+"']:not(.ew-custom-option):not([data-old])",n(kt(e))]}t=i.default.isString(t)?/^#/.test(t)?t:"#"+t:t;let l=["input","select","textarea","button","selection-list"].flatMap((e=>a.map((t=>e+t)))).join(),r=t?i.default(t).find(l):i.default(l);return 1==r.length&&(r.is(":not([type=checkbox]):not([type=radio])")||pt(r[0]))||2==r.length&&r.eq(0).is("selection-list")&&r.eq(1).is("input[type=hidden]")?r[0]:r[0]?r.get():null}function It(e,t){t=i.default.isString(t)?/^#/.test(t)?t:"#"+t:t;let a="#"+e.replace(/([\$\[\]])/g,"\\$1")+",[name='"+e+"']";return t?i.default(t).find(a)[0]:i.default(a).first()[0]}function Ot(e,t){for(;e=e.parentNode;){var a;if(1==(null==(a=e)?void 0:a.nodeType)&&(!t||t(e)))return e}return null}function xt(e){var t=i.default(e);return"none"==t.css("display")&&!t.is("selection-list")&&!t.closest(".dropdown-menu")[0]&&!ot(e)&&!dt(e)&&!rt(e)||null!=Ot(e,(e=>"none"==e.style.display&&!e.classList.contains("tab-pane")&&!e.classList.contains("collapse")))}function Ct(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function Pt(e,t){if((e=e instanceof URL?e.pathname:Ie(e).pathname)!=(t=t instanceof URL?t.pathname:Ie(t).pathname)&&e.startsWith(ew.PATH_BASE)&&t.startsWith(ew.PATH_BASE)){e=e.substring(ew.PATH_BASE.length),t=t.substring(ew.PATH_BASE.length);let a=e.split("/"),n=t.split("/");if(a[0]==n[0]&&a[0].match(/(list|view|edit)$/i)||a[0]==n[0]&&a[1]==n[1]&&[ew.LIST_ACTION,ew.VIEW_ACTION,ew.EDIT_ACTION].includes(a[1]))return!0}return e==t}function Nt(e,t){let a=e;if(i.default.isString(e)?a=2==e.split(" ").length?Tt(e):Tt(e,t):["checkbox","radio"].includes(e.type)&&(a=Tt(e)),!a)return[];if(a.options){if(a.list)return a.values;if(ut(a)){let e=i.default(a).val();return Array.isArray(e)?e:i.default.isValue(e)?[e]:[]}return Array.from(a.options).filter((e=>e.selected&&""!==e.value)).map((e=>e.value))}return Array.isArray(a)||pt(a)?i.default(a).filter(":checked").map((function(){return this.value})).get():ew.isHiddenTextArea(a)?(i.default(a).data("editor").save(),[a.value]):[a.value]}function Rt(e,t){return Nt(e,t).join(ew.MULTIPLE_OPTION_SEPARATOR)}function Lt(e,t){let a=e;return i.default.isString(e)?a=2==e.split(" ").length?Tt(e):Tt(e,t):["checkbox","radio"].includes(e.type)&&(a=Tt(e)),a?dt(a)?[a.input.value]:a.options?ut(a)?i.default(a).find(":selected").map(((e,t)=>t.innerHTML)).get():Array.from(a.options).filter((e=>e.selected&&""!==e.value)).map((e=>e.text)):Array.isArray(a)||pt(a)?i.default(a).filter(":checked").map((function(){return i.default(this).parent().text()})).get():ew.isHiddenTextArea(a)?(i.default(a).data("editor").save(),[a.value]):[a.value]:[]}function Ft(e){if(e.options){var t="select-multiple"==e.type||e.hasAttribute("data-dropdown")||e.length>0&&""!=e.options[0].value?0:1;if(e.list)e.removeAll(),e.render();else for(var a=e.length-1;a>=t;a--)e.remove(a);dt(e)&&(e.input.value="",e.value="")}}function kt(e,t){var a=i.default.isString(e)?e:i.default(e).attr("name")||i.default(e).attr("id");return!1!==t?a.replace(/\[\]$/,""):a}function Dt(e,t){var a=i.default(t).data("value-separator");return Array.isArray(a)?a[e-1]:a||", "}function Mt(e,t){return[e.df,e.df2,e.df3,e.df4].reduce(((e,a,n)=>{let l=n>0?Dt(n-1,t):"";return!i.default.isUndefined(l)&&i.default.isValue(a)&&""!=a?e+l+a:e}),"")}function jt(e){return ew.OPTION_HTML_TEMPLATE.replace(/\{value\}/g,e)}function $t(e,t,a){let n=be.get(a.id),l=kt(e),i=n.getList(e),r=t.gf,o=t.lf,s=i.template&&!dt(e)?i.template.render(t,ew.jsRenderHelpers):Mt(t,e)||o;if(e.options){let n;e.list?n=new ew.SelectionListOption(s,o):(n=document.createElement("option"),n.value=o,n.innerHTML=s);let i={name:l,form:a.$element,data:t,group:r,option:n};if(ye.trigger("newoption",[i]),e.list)e.addOption(i.option);else if(i.group){var d;let t=Array.from(null!=(d=e.querySelector(":scope > optgroup"))?d:[]).find((e=>e.label==i.group));t||(t=document.createElement("optgroup"),t.label=i.group,e.add(t)),t.appendChild(i.option)}else e.add(i.option);return i.option.text}return s}function Ut(e,t){var a,n,l;if(!e||!t)return;let r=i.default(e);if(t=Array.isArray(t)?t:[t],e.options){var o;if(e.list)e.value=t;else r.val(t),ut(e)&&r.triggerHandler("change"),"select-one"!=e.type||-1!=e.selectedIndex||null!=(o=e.options[0])&&o.value||(e.selectedIndex=0);if(dt(e)&&1==t.length){let a=e.options||[];for(let n of a)if(n.value==t[0]){e.value=n.value,e.input.value=n.text;break}}}else pt(e)?e.checked=nt(t.join(ew.MULTIPLE_OPTION_SEPARATOR)):e.type&&"file"!=e.type&&(r.val(t.join(ew.MULTIPLE_OPTION_SEPARATOR)),rt(r)&&r.data("editor").set());if("false"===(null==(a=e.dataset)?void 0:a.autoselect))return;let s=Ze(e);if(s&&!(s.id.endsWith("search")||s.id.endsWith("srch")||0===(null==(n=be.get(s.id).getList(e))||null==(l=n.parentFields)?void 0:l.length))&&e.options&&(e.list||"select-one"!=e.type||2!=e.options.length||e.options[1].selected?1!=e.options.length||e.options[0].selected||(e.options[0].selected=!0,r.trigger("change")):(e.options[1].selected=!0,r.trigger("change")),dt(e))){let t=e.options||[];1==t.length&&(e.value=t[0].value,e.input.value=t[0].text)}}function Bt(e,t){var a,n;null!=t||(t={}),t.headers=new Headers(t.headers||{});let l=e.startsWith(Te());l&&ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&t.headers.set(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN),(l||null!=(a=t.headers)&&null!=(n=a.get("Content-Type"))&&n.includes("application/json"))&&(t.headers.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.headers.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN)),!t.method||Ct(t.method,"GET")?(e=Ce(e,t.body),delete t.body):t.body=Pe(t.body,{[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN});let i={url:e,init:t};return ye.trigger("fetch",[i]),fetch(i.url,i.init)}function Vt(){i.default("form.ew-form.ew-wait").removeClass("ew-wait").each((function(){var e=be.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.enableForm())})),ye.data("_ajax",!1)}function Ht(e,t){let a=e.replaceAll(/<(head|template)[^>]*>[\s\S]*?<\/\1\s*>/gi,"").matchAll(/<script[^>]*>[\s\S]*?<\/script\s*>/gi);Array.from(document.createRange().createContextualFragment(Array.from(a).map((e=>e[0])).join("")).querySelectorAll("script:not([type]), script[type='text/javascript']")).sort(((e,t)=>t.classList.contains("ew-apply-template")?1:e.classList.contains("ew-apply-template")?-1:0)).forEach(((e,a)=>Wt(e,"scr_"+t+"_"+a)))}function qt(e){let t=e.replaceAll(/<(head|template)[^>]*>[\s\S]*?<\/\1\s*>/gi,"").matchAll(/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi);return Array.from(t).filter((e=>document.createRange().createContextualFragment(e[0]).querySelector("script:not([type]), script[type='text/javascript']"))).reduce(((e,t)=>e.replace(t[0],"")),e)}function Wt(e,t){let a=e instanceof HTMLScriptElement?e:document.createElement("SCRIPT");return i.default.isString(e)&&(a.text=e),t&&(a.id=t),document.body.appendChild(a)}function Kt(e){e&&i.default("script[id^='scr_"+e+"_']").remove()}function Gt(e,t){var a;e=e.trim().replace(/<head>[\s\S]*<\/head>/,"");let n=t?e:qt(e),l=n.match(/<body[\s\S]*>[\s\S]*<\/body>/i);n=null!=(a=null==l?void 0:l[0])?a:n;let r=i.default(n).find("section.content");return r[0]?r.html():n}function zt(e){return null!=e&&e.options?Array.prototype.map.call(e.options,(e=>[e.value,e.text])):[]}function Yt(e){let t=i.default(this),a=t.data("args"),n=t.removeData("args").find(".modal-body form").data("form");Kt("modal_dialog"),null==n||n.destroyEditor(),t.find(".modal-footer .btn-primary").off(),t.find(".modal-dialog").removeClass(((e,t)=>{let a=t.match(/table\-\w+/);return a?a[0]:""})),t.data({showing:!1,url:null}),null!=a&&a.reload&&window.location.reload()}function Jt(e){let t=be.get(e).$element[0];if(!t)return;let a=Nt(e),n=kt(e),l=n.match(/^([xy])(\d*)_/),r=l?l[2]:"",o=be.get(e).getList(n),s=o.autoFillTargetFields,d=function(a){let l=null==a?void 0:a.records,o=Array.isArray(l)&&l.length>0?l[0]:[];for(let a=0;a<s.length;a++){let d=Tt(s[a].replace(/^x_/,"x"+r+"_"),t);if(d){let r=i.default.isValue(o["af"+a])?String(o["af"+a]):"",u={results:l,result:o,data:r,form:t,name:n,target:s[a],cancel:!1,trigger:!0};if(i.default(e).trigger("autofill",[u]),u.cancel)continue;r=u.data,d.options?(Ut(d,r.split(",")),dt(d)&&(d.input.value=r,Qe.call(be.get(t.id),d))):rt(d)?(d.value=r,i.default(d).data("editor").set()):"checkbox"==d.type?d.checked=nt(r):d.value=r,u.trigger&&i.default(d).trigger("change")}}return o};if(a.length>0&&""!=a[0]){let e=Object.assign({page:o.page,field:o.field,ajax:"autofill",v0:a[0],language:ew.LANGUAGE_ID},tt("#p_"+n,t)),l=o.parentFields.slice();if(""!=r)for(let e=0,t=l.length;e<t;e++){1==l[e].split(" ").length&&(l[e]=l[e].replace(/^x_/,"x"+r+"_"))}return l.map((e=>Rt(e,t))).forEach(((t,a)=>e["v"+(a+1)]=t)),i.default.post(Te(ew.API_LOOKUP_ACTION),e,d,"json")}return d()}function Xt(e,t){var a=i.default(t),n=i.default("#"+a.data("tooltip-id")),l=a.data("trigger")||"hover",r=a.data("placement")||"auto";n[0]&&(""!=n.text().trim()||n.find("img[src!='']")[0])&&(bootstrap.Popover.getInstance(t)||a.popover({...ew.popoverOptions,placement:r,trigger:l,delay:100,container:document.getElementById("ew-tooltip"),content:n.html()}).on("show.bs.popover",(function(){var e=a.data("tooltip-width");e&&i.default(bootstrap.Popover.getInstance(this)._getTipElement()).css("max-width",parseInt(e,10)+"px")})))}function Zt(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n=null==a?void 0:a.querySelector(".ew-filter-option");ew.CLIENT_SEARCH_FILTER||ew.SERVER_SEARCH_FILTER&&ew.IS_LOGGEDIN&&!ew.IS_SYS_ADMIN&&""!=ew.CURRENT_USER_NAME?i.default(n).removeClass("d-none").find(".ew-btn-dropdown").on("show.bs.dropdown",(function(e){var t,a;let n=i.default(this).find(".ew-save-filter[data-form], .ew-delete-filter[data-form]").data("form"),l=ew.forms.get(n),r=ew.CLIENT_SEARCH_FILTER?ew.parseJson(localStorage.getItem(ew.PROJECT_NAME+"_"+l.id+"_filters")||"[]")||[]:null!=(t=null==l||null==(a=l.filterList)?void 0:a.filters)?t:[];l.setupFilters(e,r.filter((e=>Array.isArray(e)&&2==e.length)))})):null==n||n.classList.add("d-none")}function Qt(e,t){let a=window.parent.Swal;return a.fire({...ew.sweetAlertSettings,showConfirmButton:!1,html:"<p>"+ew.language.phrase("Exporting")+"</p>",allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{a.showLoading(),Bt(Te([ew.API_EXPORT_ACTION,"email",e])+"?rnd="+ia(),{method:"POST",body:t}).then((async n=>{a.hideLoading();let l=await n.json();var i;null!=l&&l.success?(a.update({html:"<div class='text-success'>"+l.message+"</div>"}),ye.trigger("export",[{type:"done",tblVar:e,data:t,result:l}])):(a.update({html:null!=(i="<div class='text-danger'>"+je(l))?i:ew.language.phrase("FailedToExport")+"</div>"}),ye.trigger("export",[{type:"fail",tblVar:e,data:t,result:l}]))})).catch((n=>{var l;a.hideLoading(),a.update({html:null!=(l="<div class='text-danger'>"+n)?l:ew.language.phrase("FailedToExport")+"</div>"}),ye.trigger("export",[{type:"fail",tblVar:e,data:t,error:n}])})).finally((()=>{a.update({showConfirmButton:!0}),ye.trigger("export",[{type:"always",tblVar:e,data:t}])}))}})}function ea(){return location.href.split("#")[0].split("?")[0]}function ta(e){var t,a;const n=(null==(t=e=i.default.isString(e)?document.querySelector(e):e)?void 0:t.value)||(null==(a=e)?void 0:a.innerText);if(n){const e=document.createElement("textarea");e.value=n,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}return n}function aa(e){return!(e=String(e))||0==e.length||(e=e.trim(),null!==ew.parseNumber(e))}function na(e){return!e||0==e.length||/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i.test(e.trim())}function la(e){var t;let a,n;try{[a,n]=[window.parent.document,window.parent.Swal]}catch(e){[a,n]=[window.document,window.Swal]}let l=null!=(t=null==e?void 0:e.target)?t:a,r=i.default(l).find("div.ew-message-dialog.d-none").first(),o=r.length?r.text():"";if(i.default.isString(e)&&(o=i.default("<div>"+e.trim()+"</div>").text()),""!=o.trim())return r.length&&["success","info","warning","danger"].forEach((function(e){let t=r.find(".alert-"+e).toggleClass("alert-"+e),a=t.find(".alert-heading").detach(),n=t.children(":not(.icon)");if(t.find(".icon").remove(),t[0]){let l=parseInt(n.css("width"),10);l>0&&n.first().css("width","auto");let i=Xe(t.html(),e,a.html());l>0&&i.css("max-width",l)}else;})),i.default.isString(e)?n.fire({...ew.sweetAlertSettings,html:e}):void 0}function ia(){return Math.floor(100001*Math.random())+1e5}Pace.on("done",(()=>{var e;let t=document.querySelector(".modal.show form.ew-form")||document.querySelector("form.ew-form");null==(e=be.get(null==t?void 0:t.id))||e.tryFocus()})),ye.ajaxSend((function(e,t,a){let n=a.url,l=n.startsWith(Te()),r=l||n.startsWith(ew.PATH_BASE)||n.startsWith(ea());if(!r&&n.match(/^http/i)){r=new URL(n).hostname==ve.hostname}if(r)if(l&&ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&t.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN),l||i.default.isString(a.contentType)&&a.contentType.includes("application/json"))t.setRequestHeader(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.setRequestHeader(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN);else if(Ct(a.type,"POST")){let e=Pe(new URLSearchParams(a.data),{[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN});a.data=e.toString()}})),ye.ajaxStart((function(){ye.data("_ajax",!0),i.default("form.ew-form").addClass("ew-wait").each((function(){var e=be.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.disableForm())}))})),ye.ajaxStop(Vt).ajaxError(Vt);let ra=r.default.DateTime,oa=r.default.Interval;function sa(e,t){let a;return i.default.isString(e)?a=ra.fromSQL(e,{zone:"utc"}):i.default.isNumber(e)?a=ra.fromSeconds(e,{zone:"utc"}):e instanceof Date?a=ra.fromJSDate(e,{zone:"utc"}):e instanceof ra&&(a=e),a.toFormat(t,{locale:ew.LANGUAGE_ID,numberingSystem:ew.getNumberingSystem()})}function da(e,t){return ra.fromFormat(e,t,{locale:ew.LANGUAGE_ID,numberingSystem:ew.getNumberingSystem()})}function ua(e,t,a,n){var l;let i;if((null!=(l=ew.vars)&&l.login?Array.from(Object.entries(ew.vars.login)).filter((e=>e[0].endsWith("Url"))).map((e=>e[1])):[]).includes(e))return window.location=e,!1;if(e.startsWith("http"))i=new URL(e);else{if(!e.startsWith("/"))return ze(ew.language.phrase("IncorrectUrl")),!1;i=new URL(e,location.protocol+"//"+location.host)}let r=i.searchParams;if(n&&(r=Pe(r,n)),Ct(a,"post")){const a=t||document.createElement("form");a.method="post",a.action=e.split("?")[0],document.body.appendChild(a),r.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),r.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),r.forEach(((e,t)=>{const n=document.createElement("input");n.type="hidden",n.name=t,n.value=ew.sanitize(e),a.appendChild(n)})),a.submit()}else window.location=ke(i.toString());return!1}function ca(){return window.matchMedia(ew.screenMediaQuery).matches}function fa(e,t){t=t&&!t.startsWith(".")?"."+t:".ew-card.ew-grid";let a=document.querySelector(t+", .ew-multi-column-grid, .ew-view-form, .ew-edit-form, main.ew-no-record");if(!a)return;let n=i.default(ew.overlayTemplate()),l=i.default(a).addClass("ew-loading").toggleClass("overlay-wrapper",!a.classList.contains("card")).append(n);return e.then((async e=>{if(!(e instanceof Response))return e;let n=e.headers.get("Content-Type");if(null!=n&&n.includes("json")){let t=await e.json(),a=je(t);return a?Xe(a):i.default.isString(t.warningMessage)?Xe(t.warningMessage,"warning"):i.default.isString(t.message)?Xe(t.message,"body"):i.default.isString(t.successMessage)&&Xe(t.successMessage,"success"),!1}let r=await e.text(),o=new URL(e.url),s=[".ew-message-dialog",".ew-chart-top",".ew-chart-bottom",".ew-debug .card-body",".ew-timer"];"false"==o.searchParams.get("layout")&&(r="<div>"+r+"</div>",o.searchParams.delete("layout")),o.searchParams.delete("rnd"),r=Gt(r,!0);let d=i.default("<div>"+r+"</div>");a.closest(".ew-dashboard")||(s.unshift(".ew-toolbar"),Pt(o,ve)&&ve.toString()!=o.toString()&&window.history.pushState(null,"",o.toString())),s=d.find("main.ew-no-record")[0]||l.is("main.ew-no-record")?[".ew-ext-search-form","main",...s]:l.hasClass("ew-view-form")?[".ew-view-form",".ew-pager",...s]:l.hasClass("ew-edit-form")?[".ew-edit-form",".ew-pager",...s]:l.hasClass("ew-multi-column-grid")?[".ew-ext-search-form",".ew-multi-column-grid",...s]:["#ew-filter-list",".ew-ext-search-form",t+" .card-header",t+" .card-body",t+" .card-footer",...s],s.forEach((e=>i.default(e).each(((t,a)=>{let n=i.default(a),l=d.find(e).eq(t);if(n[0]&&l[0]&&(delete a.dataset.isset,n.html(l.html()),n.attr("class",l.attr("class"))),".ew-toolbar"==e){let e={target:a};Ee(e),Zt(e)}else if(".ew-ext-search-form"==e){let e=l.find("#navbar-basic-search");if(e[0]){let t=e.render(null,ew.jsRenderHelpers),a=i.default(t),n=a.find("#"+ew.TABLE_BASIC_SEARCH),l=a.find("#"+ew.TABLE_BASIC_SEARCH_TYPE);n.val()==i.default("#"+ew.TABLE_BASIC_SEARCH).val()&&l.val()==i.default("#"+ew.TABLE_BASIC_SEARCH_TYPE).val()||i.default(".nav-item.navbar-basic-search").replaceWith(a)}n.find(".ew-search-operator .form-select.ew-operator-select").each(((e,t)=>We(t)))}else".ew-message-dialog"==e&&(l.hasClass("d-none")||n.html(l.html()))})))),s.filter((e=>".ew-message-dialog"!=e)).forEach((e=>d.find(e).remove())),Kt("refresh"),Ht(d.html(),"refresh");let u=i.default.Event({type:"load.ew",target:a});ew.initPage(u),i.default(".toast.show").toast("dispose"),la({target:d}),ye.trigger(u),ye.trigger(i.default.Event({type:"refresh.ew",target:a}))})).finally((()=>l.removeClass("ew-loading").find(n).remove()))}var pa;var ha={__proto__:null,currentUrl:ve,forms:be,AjaxLookup:_,AutoSuggest:A,Form:b,Field:v,Select2Utils:Z,Select2Defaults:we,fieldContainerSelector:Ae,createSelect:function(e){if(e.selectId.includes("$rowindex$"))return;if(i.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.toSelect2Data(t.options)}if(i.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.toSelect2Data(a.transform(e)),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,t,a)=>i.default.ajax(e).then((e=>{let a=je(e);!a||ze(a),t(e)})).fail(a)}}let t={name:e.name,options:e};ye.trigger("select2",[t]);let a=i.default("select[data-select2-id='"+e.selectId+"']").select2(t.options);a.on("select2:open",(function(){var e;null==(e=i.default(this).data("select2").$dropdown.find(".select2-search__field")[0])||e.focus()})),i.default.isObject(e.ajax)&&a.on("select2:opening",(function(){i.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()})),e.minimumResultsForSearch===1/0&&a.on("select2:opening select2:closing",(function(){i.default(this).data("select2").$dropdown.find(".select2-search--dropdown").addClass("select2-search--hide")}))},createModalLookup:function(e){if(e.selectId.includes("$rowindex$"))return;if(i.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(i.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,t,a)=>i.default.ajax(e).then((e=>{let a=je(e);!a||ze(a),t(e)})).fail(a)}}let t=i.default("select[data-select2-id='"+e.selectId+"']").select2(e);t.on("select2:open",(function(){var e;null==(e=i.default(this).data("select2").$dropdown.find(".select2-search__field").addClass("form-control")[0])||e.focus()})),i.default.isObject(e.ajax)&&t.on("select2:opening",(function(){i.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()}))},createFilter:function(e){if(e.selectId.includes("$rowindex$"))return;if(i.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(i.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,t,a)=>i.default.ajax(e).then((e=>{let a=je(e);!a||ze(a),t(e)})).fail(a)}}let t=i.default("select[data-select2-id='"+e.selectId+"']").select2(e);t.on("select2:open",(function(){var t;null==(t=i.default(this).data("select2").$dropdown.find(".select2-search__field").addClass("form-control")[0])||t.focus({preventScroll:e.preventScroll})})),i.default.isObject(e.ajax)&&t.on("select2:opening",(function(){i.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()}))},initIcons:Ee,initPasswordOptions:Se,getApiUrl:Te,parseUrl:Ie,createSearchParams:Oe,getSearchParams:xe,getSearchParam:function(e,t){return xe(e).get(t)},setSearchParams:Ce,mergeSearchParams:Pe,setSearchParam:Ne,deleteSearchParam:Re,buildUrl:Le,setLayout:Fe,sanitizeUrl:ke,setSessionTimer:function(){var e,t,a,n,l=ew.SESSION_KEEP_ALIVE_INTERVAL>0||ew.IS_LOGGEDIN&&ew.IS_AUTOLOGIN,r=()=>{i.default.get(Te(ew.API_SESSION_ACTION),{rnd:ia()},(e=>{e&&i.default.isObject(e)&&(ew.TOKEN_NAME=e[ew.TOKEN_NAME_KEY],ew.ANTIFORGERY_TOKEN=e[ew.ANTIFORGERY_TOKEN_KEY],e.JWT&&(ew.API_JWT_TOKEN=e.JWT))}))},o=()=>{n=ew.SESSION_TIMEOUT_COUNTDOWN,(e=ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN)<0&&(e=0,n=ew.SESSION_TIMEOUT),t&&t.cancel()},s=()=>{if(a&&a.cancel(),n>0){let e,t='<p class="text-danger">'+ew.language.phrase("SessionWillExpire")+"</p>";t.includes("%m")&&t.includes("%s")?(t=t.replace("%m",'<span class="ew-session-counter-minute">'+Math.floor(n/60)+"</span>"),t=t.replace("%s",'<span class="ew-session-counter-second">'+n%60+"</span>")):t.includes("%s")&&(t=t.replace("%s",'<span class="ew-session-counter-second">'+n+"</span>")),Swal.fire({...ew.sweetAlertSettings,html:t,showConfirmButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),timer:1e3*n,timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{e=setInterval((()=>{let e=Swal.getHtmlContainer(),t=e.querySelector(".ew-session-counter-minute"),a=e.querySelector(".ew-session-counter-second"),n=Math.round(Swal.getTimerLeft()/1e3);t&&a?(t.textContent=Math.floor(n/60),a.textContent=n%60):a&&(a.textContent=n)}),1e3)},willClose:()=>{clearInterval(e)}}).then((e=>{e.value?(r(),!l&&ew.SESSION_TIMEOUT>0&&d()):e.dismiss===Swal.DismissReason.timer&&(o(),window.location=ke(ew.TIMEOUT_URL+"?expired=1"))}))}},d=()=>{o(),t=i.default.later(1e3*e,null,s)};if(l){var u=ew.SESSION_KEEP_ALIVE_INTERVAL>0?ew.SESSION_KEEP_ALIVE_INTERVAL:ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN;u<=0&&(u=60),a=i.default.later(1e3*u,null,r,null,!0)}else ew.SESSION_TIMEOUT>0&&d()},initExportLinks:De,initMultiSelectCheckboxes:Me,getError:je,fileDownload:$e,lazyLoad:Ue,updateDropdownPosition:function(){var e=i.default(".select2-container--open").prev(".ew-select").data("select2");e&&(e.dropdown._positionDropdown(),e.dropdown._resizeDropdown())},initLightboxes:Be,initPdfObjects:Ve,initTooltips:He,parseJson:qe,searchOperatorChange:We,initForms:Ke,isFunction:Ge,alert:ze,prompt:Ye,toast:Je,showToast:Xe,getForm:Ze,hasFormData:function(e){for(var t="[name^=x_],[name^=y_],[name^=z_],[name^=w_],[name="+ew.TABLE_BASIC_SEARCH+"]",a=i.default(e).find(t).filter(":enabled").get(),n=0,l=a.length;n<l;n++){var r=a[n];if(/^(z|w)_/.test(r.name)){if(/^IS/.test(i.default(r).val()))return!0}else if("checkbox"==r.type||"radio"==r.type){if(r.checked)return!0}else if("select-one"==r.type||"select-multiple"==r.type){if(i.default(r).val())return!0}else if(["text","textarea","password","search","color","date","datetime-local","datetime","email","hidden","month","number","range","tel","time","url","week"].includes(r.type)&&r.value)return!0}return!1},setSearchType:function(e){var t=e.dataset.searchType,a="Auto";"="==t?a="Exact":"AND"==t?a="All":"OR"==t&&(a="Any"),e.closest(".ew-basic-search").querySelector("input.ew-basic-search-type").value=t||"",e.closest(".dropdown-menu").querySelectorAll(".dropdown-item").forEach((e=>e.classList.remove("active"))),e.closest(".dropdown-item").classList.add("active");var n=e.closest(".input-group").querySelector("#searchtype"),l=ew.language.phrase("QuickSearch"+a+"Short");return n.innerHTML=l,n.classList.toggle("me-2",!!l),!1},updateOptions:Qe,getUserParams:tt,getQueryBuilderFilterInput:function(){return function(e,t){var a,n,l;let i=this.status.id.replace(/_query_builder$/,""),r=e.filter.id,o="tpx_"+i+"_"+r,s=null==(a=document.getElementById(o))||null==(n=a.content)?void 0:n.cloneNode(!0).querySelector(".ew-search-field");return'<div class="d-inline-flex position-relative">'+(null!=(l=null==s?void 0:s.innerHTML.replace(/\binvalid-feedback\b/,ew.queryBuilderErrorClass).replace(new RegExp('(data-field=")?(\\b|_)x_'+r+"\\b","g"),((e,a,n)=>a?e:n+t)))?l:"")+"</div>"}},getQueryBuilderValueSetter:function(){return function(e,t){let a=e.$el.find(".rule-value-container").find("select, selection-list")[0];if(a){a.dataset.field.replace("^x_","");let e=be.get(a),n=Array.isArray(t)?t:i.default.isValue(t)?[t]:[];n.forEach((t=>$t(a,{lf:t},e))),ew.selectOption(a,n),e.updateList(a,void 0,void 0,!0)}return null}},getQueryBuilderFilterValidation:function(e){return{callback:function(t,a){let n=a.$el.find(".rule-value-container"),l=0;for(let t=0;t<a.operator.nb_inputs;t++)n.find("[name='"+a.id+"_value_"+t+"']").each((function(){let t=i.default(this),a=t.next("."+ew.queryBuilderErrorClass).empty();null==e||null==e.forEach||e.forEach((e=>{let t=e(this);i.default.isObject(t)&&(l++,a.append("<span>"+Object.values(t)[0]+"</span>"))})),a.html()&&t.addClass("is-invalid").one("click",(()=>t.removeClass("is-invalid")))}));return!l||""}}},applyTemplate:function(e,t,a,n,l,r){let o={data:r||{},id:e,template:t,class:a,export:n,enabled:!0};if(ye.trigger("rendertemplate",[o]),o.enabled){var s;let a=null==(s=document.getElementById(t))?void 0:s.content,n=document.querySelector("#ew-modal-dialog.show");if(!a)return;if(a.querySelectorAll(".ew-slot").forEach((e=>{var t;let a=e.name||e.id,l=null!=(t=null==n?void 0:n.querySelector("#"+a))?t:document.getElementById(a);null!=l&&l.content?(e.dataset.rowspan>1&&Array.prototype.slice.call(l.content.childNodes).forEach((t=>t.rowSpan=e.dataset.rowspan)),e.replaceWith(l.content.cloneNode(!0))):e.remove()})),i.default.views){let t=a.textContent,n=t.includes("{{")&&t.includes("}}");if(!n){let e=ew.jsRenderAttributes.map((e=>"["+e+"*='{{']["+e+"*='}}']")).join(",");n=a.querySelector(e)}if(n){let t=Array.prototype.slice.call(a.querySelectorAll("script"));t.forEach((e=>e.remove()));let n=document.createElement("div");n.appendChild(a);let l=n.innerHTML.replace(/{{([^}]+)}}/g,(e=>St(e))),r=i.default.templates(l);document.getElementById(e).innerHTML=r.render(o.data,ew.jsRenderHelpers),t.forEach((e=>document.body.appendChild(e)))}else document.getElementById(e).appendChild(a)}else document.getElementById(e).appendChild(a)}n&&"print"!=n&&at(e,n,l)},exportCustom:at,toggleGroup:function(e){for(var t,a=i.default(e),n=a.closest("tr"),l="tr",r=1;r<=6;r++){var o=1==r?"":"-"+r,s=n.data("group"+o);i.default.isValue(s)&&(t=r,""!=s&&(l+="[data-group"+o+"='"+String(s).replace(/'/g,"\\'")+"']"))}a.hasClass("ew-rpt-grp-hide")?(i.default(l).slice(1).removeClass("ew-rpt-grp-hide-"+t),a.removeClass("ew-rpt-grp-hide")):(i.default(l).slice(1).addClass("ew-rpt-grp-hide-"+t),a.addClass("ew-rpt-grp-hide"))},convertToBool:nt,valueChanged:function(e,t,a,n){let l=Tt("x"+t+"_"+a,e),i=It("o"+t+"_"+a,e),r=It("fn_x"+t+"_"+a,e);if("hidden"==(null==l?void 0:l.type)&&!i)return!1;if(!i&&(!l||Array.isArray(l)&&0==l.length))return!1;if(i&&l)if(n){if(nt(Rt(i))===nt(Rt(l)))return!1}else{if(Rt(i)==Rt(r||l))return!1}return!0},setLanguage:function(e){let t=e.value||e.dataset.language;if(!t)return!1;let a=new URL(window.location);return a.searchParams.set("language",t),window.location=ke(a.toString()),!1},submitAction:function(e,t){var a;let n=e.currentTarget,l=t.f||n.form||n.closest("form"),r=i.default(l),o=t.key,s=t.action,d=t.url||ea(),u=t.msg,c=t.data,f=t.success,p=!t.method||Ct(t.method[0],"p"),h=!t.select&&!t.key||t.select&&Ct(t.select[0],"m");if((h||p)&&!l)return ze(ew.language.phrase("NoHtmlForm")),!1;if(h&&!wt(l))return ze(ew.language.phrase("NoRecordSelected")),!1;let g=function(e){la(e)},m=function(e,t){let a=r.find("input[type=hidden][name='"+e+"']");a[0]?a.val(t):i.default("<input>").attr({type:"hidden",name:e,value:t}).appendTo(r)},w=function(e){if(p&&l){if(s&&(m("action",s),r.find("#action").remove()),i.default.isUndefined(e)||m("actionvalue",e),i.default.isObject(c))for(const[e,t]of Object.entries(c))m(e,t);if(!h&&i.default.isObject(o))for(const[e,t]of Object.entries(o))m(e,t);Ie(d).pathname!=ve.pathname&&r.off("submit.ew"),r.prop({action:d,method:"post"}).trigger("submit")}else{c=new URLSearchParams(c),s&&(c.set("action",s),c.set("ajax",s),r.find("#action").remove()),i.default.isUndefined(e)||c.set("actionvalue",e),c=Pe(c,r.serialize()),!h&&i.default.isObject(o)&&(c=Pe(c,o)),f&&i.default.isString(f)&&(f=window[f]);let t=i.default.isObject(f)?f:{};t.data=c.toString(),t.method||(t.method="POST"),t.success||(t.success=Ge(f)?f:g),i.default.ajax(d,t)}};return u=i.default.isString(u)&&null!=(a=window[u])?a:u,u?Ye(u,(e=>w(e))):w(),!1},getchartParams:lt,_export:it,export:it,removeSpaces:function(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e},isHiddenTextArea:rt,isModalLookup:ot,isFilter:st,isAutoSuggest:dt,isSelect2:ut,isNativeSelectOne:ct,isTextbox:ft,isBooleanCheckbox:pt,clearError:function(e){if(e.jquery){let t=e.attr("type");e="checkbox"==t||"radio"==t?e.get():e[0]}i.default(e).closest(Ae).find(".invalid-feedback").html("")},onError:function(e,t,a,n){if(t.jquery){let e=t.attr("type");t="checkbox"==e||"radio"==e?t.get():t[0]}else t instanceof v&&(t=t.element);return i.default(t).closest(Ae).find(".invalid-feedback").append("<p>"+a+"</p>"),n&&ht(t),null==e||e.makeVisible(t),!1},setFocus:ht,setInvalid:function(e){if(!e)return;let t=i.default(e);if(xt(t))return;!e.options&&e.length&&(e=t[0]);let a=t.closest(Ae),n=()=>a.find(".is-invalid").removeClass("is-invalid");if(dt(e))a.find(".ew-auto-suggest").removeClass("is-valid").addClass("is-invalid").one("click keydown paste",n);else if(rt(e))t.removeClass("is-valid").addClass("is-invalid"),t.data("editor").instance.once("change",n);else if(ot(e))t.removeClass("is-valid").addClass("is-invalid").one("select2:open",n);else if(["checkbox","radio"].includes(e.type))t.removeClass("is-valid").addClass("is-invalid").one("click keydown",n);else{let e=ew.MOBILE_DETECT.version("Safari")&&!ew.MOBILE_DETECT.version("Chrome")?"change keydown paste":"click keydown paste";t.parent().one(e,n),t.add(t.closest(".input-group")).removeClass("is-valid").addClass("is-invalid")}},setValid:gt,hasValue:function(e){return""!=Rt(e)},isMaskedPassword:function(e){var t=i.default(e).val();return null==t?void 0:t.match(/^\*+$/)},sort:function(e,t){let{sortUrl:a,sortType:n,context:l,ajax:i}=t;return e.shiftKey&&!e.ctrlKey?a=Ce(a,{cmd:"resetsort"}):2==n&&e.ctrlKey&&(a=Ce(a,{ctrl:"1"})),nt(i)?fa(fetch(Fe(a,!1)),l):window.location=ke(a),!1},filter:function(e){let t=e.currentTarget.dataset;i.default("select[data-select2-id='f"+t.table+"srch_"+t.field+"']").select2("open")},scrollIntoView:mt,inlineAction:async function(e){var t;let a=i.default(null==(t=e.evt)?void 0:t.currentTarget),n=a.closest(".ew-grid, .ew-multi-column-grid");a.tooltip("hide"),!n[0]&&a.is(".dropdown-item")&&(a=i.default("#"+a.closest(".dropdown-menu").attr("aria-labelledby")),n=a.closest(".ew-grid, .ew-multi-column-grid"));let l,{url:r,ewAction:o,action:s}=e,d=n.find("form"),u=d[0],c=a.closest("tr[data-rowindex], div[data-rowindex]"),f=c.data("key"),p=c.data("rowindex");if(!a[0]||!n[0]||!u)return;let h=function(e){!e.status||Xe("Server Error "+e.status+": "+e.statusText)},g=function(){document.body.style.cursor="default"},m=async function(e){if(!(e instanceof Response))return;let t=e.headers.get("Content-Type");if(null!=t&&t.includes("json")){let t=await e.json();null!=t&&t.success?(c.remove(),Xe(ew.language.phrase("DeleteSuccess"),"success")):Xe(je(t)||ew.language.phrase("DeleteFailed"))}else ze(await e.text())},w=()=>i.default(".ew-list-options, .ew-list-option-body").find("[data-ew-action='inline'][data-action='add'],[data-ew-action='inline'][data-action='copy'],[data-ew-action='inline'][data-action='edit']").addClass("disabled"),v=()=>i.default(".ew-list-options, .ew-list-option-body").find("[data-ew-action='inline'][data-action='add'],[data-ew-action='inline'][data-action='copy'],[data-ew-action='inline'][data-action='edit']").removeClass("disabled"),b=()=>n.find(".ew-grid-middle-panel .ew-table")[0],y=e=>{let t=0;Array.from(e.rows).forEach((e=>e.dataset.rowindex="0"===e.dataset.rowindex?"0":String(t++)))},_=async function(e){if(!(e instanceof Response))return;let t=await e.text(),a=i.default("<div>"+t+"</div>"),r=a.find("tr[data-rowindex=0], div[data-rowindex=0]"+(f?", tr[data-key='"+f+"'], div[data-key='"+f+"']":"")).filter("[data-rowtype=2], [data-rowtype=3]"),o=r.data("rowindex"),d=r.add(a.find("script[data-rowindex="+o+"]"));if(["add","copy","edit"].includes(s)&&!d[0])return Xe(t);if(["add","copy"].includes(s)){if(r.is("TR")){let e=b();e.matches(".ew-infinite-scroll-table")?i.default(e.tBodies).last().append(d):i.default(e.tBodies).last().prepend(d),y(e),At(e,!0)}else n.find(".ew-multi-column-row").append(d);w(),be.get(u.id).tryFocus(),mt(n.find("[data-rowtype=2]")[0])}else"edit"==s&&(l=c.replaceWith(d),n.data("detached",l),r.is("TR")&&At(b(),!0),w(),be.get(u.id).tryFocus(),mt(n.find("[data-rowtype=3]")[0]))},A=async function(e){if(!(e instanceof Response))return;let t=e.headers.get("Content-Type");if(null!=t&&t.includes("json")){let t=je(await e.json());if(t)return void Xe(t)}let a,l=await e.text(),r=i.default("<div>"+l+"</div>");if(["insert","update"].includes(s)){if(a=r.find("tr[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"], div[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"]"),!a[0])return;"insert"==s?n.find("tr[data-rowtype="+ew.ROWTYPE_ADD+"], div[data-rowtype="+ew.ROWTYPE_ADD+"]").replaceWith(a[0]):"update"==s&&a.get().forEach((e=>n.find("tr[data-key='"+e.dataset.key+"'], div[data-key='"+e.dataset.key+"']").replaceWith(e)))}else["add","edit","multiedit"].includes(s)&&(a=r.find("tr[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"], div[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"]"),["edit","multiedit"].includes(s)?a.get().forEach((e=>n.find("tr[data-key='"+e.dataset.key+"'], div[data-rowtype='"+e.dataset.key+"']").replaceWith(e))):"add"==s&&n.find(".ew-grid-middle-panel .ew-table > tbody:last").append(a));let o=b();y(o),At(o,!0),la({target:r})};if("inline"==o)if("cancel"==s){var E;if("0"==p)c.remove();else null==(E=n.data("detached"))||E.replaceAll(c);v()}else if(u&&["insert","update"].includes(s)){let t=be.get(u.id);if(await t.canSubmit(e.evt)){document.body.style.cursor="wait";let e=Ce(d.serialize(),{action:s}),a=Bt(Ce(r,{rnd:ia()}),{method:"POST",body:e}).catch(h).finally((()=>{t.enableForm(),g()}));if(t.submitWithFetch){let e={form:u,result:a},n=i.default.Event("aftersubmit",{originalEvent:e.evt});t.trigger(n,[e])}else a.then(A).finally(v)}}else if("delete"==s){if(!f&&(c=n.find("input[type=checkbox][name='key_m[]']:checked").closest("tr[data-rowindex], div[data-rowindex]"),!c[0]))return ze(ew.language.phrase("NoRecordSelected")),!1;Ye(ew.language.phrase("DeleteConfirm"),(e=>{if(e){document.body.style.cursor="wait";let e=f?"GET":"POST",t=Re(d.serialize(),"action"),a=be.get(u.id),n=Bt(Ce(r,{action:"delete",rnd:ia()}),{method:e,body:t}).catch(h).finally((()=>{a.enableForm(),g()}));if(a.submitWithFetch){let e={form:u,result:n},t=i.default.Event("aftersubmit",{originalEvent:e.evt});a.trigger(t,[e])}else n.then(m)}}))}else document.body.style.cursor="wait",Bt(Ce(r,{rnd:ia()})).then(_).catch(h).finally(g);else if("grid"==o||"modal"==o){if(("grid"==o&&"edit"==s||"modal"==o&&["multiedit","update"].includes(s))&&!wt(u))return ze(ew.language.phrase("NoRecordSelected")),!1;ew.modalDialogShow({...e,callback:A})}return!1},confirmDelete:function(e){return _t(e),Ye(ew.language.phrase("DeleteConfirm"),(t=>{t&&(e.dataset.json&&e.href?ew.modalDialogShow({url:Ce(e.href,{action:"delete"}),json:!0,callback:!0}):e.href?window.location=ke(Ce(e.href,{action:"delete"})):yt(e))})),!1},keySelected:wt,selectAllKeys:function(e){vt(e);let t=null==e?void 0:e.closest(".ew-table");t&&i.default(t.tBodies).each((function(){i.default(this.rows).each((function(){let t=i.default(this);t.is(":not(.ew-template):not(.ew-table-preview-row)")&&t.toggleClass("table-active ew-table-selected-row",e.checked).triggerHandler("change")}))}))},selectAll:vt,updateSelected:function(e){return!(null==e||!e.querySelector("input[type=checkbox][name^=u_]:checked,input[type=hidden][name^=u_][value='1']"))},clearSelected:bt,clearDelete:yt,clickDelete:_t,selectKey:function(e){let t=e.target,a=null==t?void 0:t.closest(".ew-table");if(!a)return;bt(a);let n=i.default(t).closest(".ew-table > tbody > tr");n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().each((function(){i.default(this).toggleClass("table-active ew-table-selected-row",t.checked).triggerHandler("change")})),e.stopPropagation()},setupTable:At,setupGrid:Et,addGridRow:function(e){var t;let a=null==e?void 0:e.closest(".ew-grid"),n=i.default(a).find("table.ew-table").last(),l=n.parent("div"),r=n.find("tr.ew-template");if(!(e&&a&&n[0]&&r[0]))return!1;let o=i.default(n[0].rows).last();n.find("td.ew-table-last-row").removeClass("ew-table-last-row");let s=r.clone(!0,!0).removeClass("ew-template"),d=a.querySelector("div.ew-form[id^=f][id$=grid]")||a.querySelector("form.ew-form[id^=f][id$=list]")||a.querySelector("form.ew-form[id^=f][id$=grid]"),u=i.default(d),c=u.is("div")?"_"+d.id:"",f=u.find("#"+ew.FORM_KEY_COUNT_NAME+c),p=parseInt(f.val(),10)+1,h=ew.FORM_ROW_ACTION_NAME.replace(/^k_/,"k"+p+"_")+c,g=r.find("script:contains('$rowindex$')");s.attr({id:"r"+p+s.attr("id").substring(2),"data-rowindex":p}),s.children("td").each((function(){i.default(this).find("*").each((function(){i.default.each(this.attributes,(function(e,t){t.value=t.value.replace(/\$rowindex\$/g,p)}))}))}));let m=s.find(".ew-icon").closest("a, button");null==(t=bootstrap.Tooltip.getInstance(m[0]))||t.dispose(),m.tooltip({...ew.tooltipOptions,container:"body",trigger:"hover"}),f.val(p).after(i.default("<input>").attr({type:"hidden",id:h,name:h,value:"insert"})),o.after(s),g.get().forEach((e=>Wt(e.text.replace(/\$rowindex\$/g,p))));let w=u.data("form");return null==w||w.initEditors(),null==w||w.initUpload(),At(n[0],!0),l.scrollTop(l[0].scrollHeight),!1},deleteGridRow:function(e,t){var a;null==(a=bootstrap.Tooltip.getInstance(e))||a.dispose();let n=e.closest(".ew-grid, .ew-multi-column-grid"),l=e.closest("tr, div[data-rowindex]"),r=null==l?void 0:l.closest(".ew-table"),o=parseInt(null==l?void 0:l.dataset.rowindex,10),s=(null==n?void 0:n.querySelector("div.ew-form[id^=f][id$=grid]"))||(null==n?void 0:n.querySelector("form.ew-form[id^=f][id$=list], form.ew-form[id^=f][id$=grid]")),d=i.default(s),u=d.data("form");if(!(e&&n&&l&&r&&s&&u))return!1;let c=d.is("div")?"_"+s.id:"",f="#"+ew.FORM_KEY_COUNT_NAME+c,p=function(){if(l.remove(),n.classList.contains(".ew-grid")&&At(r,!0),o>0){let e=d.find("#k"+o+"_action"+c);e[0]?e.val("insert"==e.val()?"insertdelete":"delete"):d.find(f).after(i.default("<input>").attr({type:"hidden",id:"k"+o+"_action"+c,name:"k"+o+"_action"+c,value:"delete"}))}};return Ge(u.emptyRow)&&u.emptyRow(t)?p():Ye(ew.language.phrase("DeleteConfirm"),(e=>{e&&p()})),!1},htmlEncode:function(e){return String(e).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlDecode:St,getElements:Tt,getElement:It,getAncestorBy:Ot,isHidden:xt,sameText:Ct,sameString:function(e,t){return String(e)==String(t)},samePath:Pt,getValue:function(e,t){let a=e;if(i.default.isString(e)?a=2==e.split(" ").length?Tt(e):Tt(e,t):["checkbox","radio"].includes(e.type)&&(a=Tt(e)),a)return a.options?a.list?"select-multiple"==a.type?a.values:a.value:i.default(a).val():Array.isArray(a)?a.length?i.default(a).filter(":checked").map(((e,t)=>t.value)).get():void 0:pt(a)?a.checked?a.value:void 0:ew.isHiddenTextArea(a)?(i.default(a).data("editor").save(),a.value):a.value},getOptionValues:Nt,getOptionValue:Rt,getOptionTexts:Lt,clearOptions:Ft,getId:kt,valueSeparator:Dt,displayValue:Mt,optionHtml:jt,optionsHtml:function(e,t){return e.length>(t||ew.MAX_OPTION_COUNT)?ew.language.phrase("CountSelected").replace("%s",e.length):e.length?e.reduce(((e,t)=>e+jt(t)),""):ew.language.phrase("PleaseSelect")},newOption:$t,selectOption:Ut,fetch:Bt,executeScript:Ht,stripScript:qt,addScript:Wt,removeScript:Kt,getContent:Gt,getOptions:zt,enable2FA:function(){if(document.body.style.cursor="wait",Ct(ew.TWO_FACTOR_AUTHENTICATION_TYPE,"google")){let e=Te([ew.API_2FA_ACTION,ew.API_2FA_SHOW]);i.default.get(e,(e=>{var t;null!=e&&e.url?Ye({imageUrl:e.url,html:ew.language.phrase("Scan2FAQrCode"),input:"text",confirmButtonText:ew.language.phrase("Verify"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),willOpen:()=>{Swal.showLoading(Swal.getConfirmButton()),Swal.disableInput(),Swal.getImage().onload=()=>{Swal.enableInput(),Swal.hideLoading(),Swal.getInput().focus()}},preConfirm:e=>i.default.get(Te([ew.API_2FA_ACTION,ew.API_2FA_VERIFY,e])).then((e=>(!0!==(null==e?void 0:e.success)&&Swal.showValidationMessage(ew.language.phrase("2FAVerificationFailed")),e))).catch((e=>Swal.showValidationMessage(e)))},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Xe(e.error.description):null!=e&&e.success&&(Xe(ew.language.phrase("2FAEnabled"),"success"),i.default("#enable-2fa").addClass("d-none"),i.default("#disable-2fa, #backup-codes").removeClass("d-none"))})).catch((e=>Xe(null==e?void 0:e.message))):null!=e&&null!=(t=e.error)&&t.description&&ze(e.error.description)})).fail(((e,t,a)=>Xe(a))).always((()=>document.body.style.cursor="default"))}else{let e=Te([ew.API_2FA_ACTION,ew.API_2FA_SHOW]),t=Ct(ew.TWO_FACTOR_AUTHENTICATION_TYPE,"email")?ew.language.phrase("EnterOTPEmailAddress"):ew.language.phrase("EnterOTPMobileNumber");i.default.get(e,(e=>{var a;e.success?Ye({html:t,input:"text",inputValue:e.account,confirmButtonText:ew.language.phrase("SendOTP"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),preConfirm:e=>i.default.get(Te([ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP,e])).then((e=>(!0!==(null==e?void 0:e.success)&&Swal.showValidationMessage(ew.language.phrase("SendOTPFailed")),e))).catch((e=>Swal.showValidationMessage(e)))},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Xe(e.error.description):null!=e&&e.success&&Ye({html:ew.language.phrase("EnterSecurityCode"),input:"text",confirmButtonText:ew.language.phrase("Verify"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),preConfirm:e=>i.default.get(Te([ew.API_2FA_ACTION,ew.API_2FA_VERIFY,e])).then((e=>(!0!==(null==e?void 0:e.success)&&Swal.showValidationMessage(ew.language.phrase("2FAVerificationFailed")),e))).catch((e=>Swal.showValidationMessage(e)))},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Xe(e.error.description):null!=e&&e.success&&(Xe(ew.language.phrase("2FAEnabled"),"success"),i.default("#enable-2fa").addClass("d-none"),i.default("#disable-2fa, #backup-codes").removeClass("d-none"))})).catch((e=>Xe(null==e?void 0:e.message)))})).catch((e=>Xe(null==e?void 0:e.message))):null!=e&&null!=(a=e.error)&&a.description&&ze(e.error.description)})).fail(((e,t,a)=>Xe(a))).always((()=>document.body.style.cursor="default"))}return!1},disable2FA:function(){Ye({html:ew.language.phrase("Disable2FAConfirm"),preConfirm:e=>{if(e)return i.default.get(Te([ew.API_2FA_ACTION,ew.API_2FA_RESET])).then((e=>{var t;return null!=e&&null!=(t=e.error)&&t.description?Xe(e.error.description):!0!==(null==e?void 0:e.success)&&Xe(ew.language.phrase("2FAResetFailed")),e})).fail(((e,t,a)=>Xe(a)))}},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Xe(e.error.description):null!=e&&e.success&&(Xe(ew.language.phrase("2FADisabled"),"success"),i.default("#enable-2fa").removeClass("d-none"),i.default("#disable-2fa, #backup-codes").addClass("d-none"))})).catch((e=>Xe(null==e?void 0:e.message)))},sendOTP:function(e){Ye({html:ew.language.phrase("SendOTPConfirm"),preConfirm:t=>{let a=Te(e?[ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP,e]:[ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP]);if(t)return i.default.get(a).then((e=>{var t;return null!=e&&null!=(t=e.error)&&t.description?Xe(e.error.description):!0!==(null==e?void 0:e.success)&&Xe(ew.language.phrase("SendOTPFailed")),e})).fail(((e,t,a)=>Xe(a)))}},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Xe(e.error.description):null!=e&&e.success&&Xe(ew.language.phrase("SendOTPSuccess"),"success")})).catch((e=>Xe(null==e?void 0:e.message)))},showBackupCodes:function(){let e="<p>"+ew.language.phrase("BackupCodesMsg")+"</p>";return ze({title:ew.language.phrase("BackupCodes"),html:e,showDenyButton:!0,showLoaderOnDeny:!0,showCancelButton:!0,confirmButtonText:ew.language.phrase("CopyToClipboard"),denyButtonText:ew.language.phrase("GetNewCodes"),customClass:{denyButton:"btn btn-primary ew-swal2-deny-button"},willOpen:()=>{Swal.showLoading(),Swal.disableButtons(),i.default.get(Te([ew.API_2FA_ACTION,ew.API_2FA_BACKUP_CODES])).then((t=>{t.success&&Array.isArray(t.codes)&&(Swal.update({html:e+'<textarea class="form-control ew-backup-codes" readonly>'+t.codes.join("\n")+"</textarea>"}),Swal.enableButtons(),Swal.getConfirmButton().focus())})).fail(((e,t,a)=>Xe(a))).always((()=>Swal.hideLoading()))},preConfirm:()=>(ta(Swal.getHtmlContainer().querySelector("textarea"))&&Xe(ew.language.phrase("CopiedToClipboard"),"success"),!1),preDeny:async()=>(Swal.showLoading(Swal.getDenyButton()),await i.default.get(Te([ew.API_2FA_ACTION,ew.API_2FA_NEW_BACKUP_CODES])).then((t=>{t.success&&Array.isArray(t.codes)&&(Swal.update({html:e+'<textarea class="form-control ew-backup-codes" readonly>'+t.codes.join("\n")+"</textarea>"}),Swal.getConfirmButton().focus())})).fail(((e,t,a)=>Xe(a))).always((()=>Swal.hideLoading())),!1)})},addOptionDialogShow:function(e){var t;e.lnk=e.lnk||(null==(t=e.evt)?void 0:t.currentTarget);var a=ew.addOptionDialog||i.default("#ew-add-opt-dialog").on("hidden.bs.modal",(function(){Kt(a.data("args").el);var e=a.removeData("args").find(".modal-body form").data("form");e&&e.destroyEditor(),a.find(".modal-body").html(""),a.find(".modal-footer .btn-primary").off(),a.data("showing",!1)}));if(a[0]){if(!a.data("showing")){a.data("showing",!0);var n=function(e){var t,n=e,l=a.data("args"),r=be.get(l.lnk),o=a.find(".modal-body form input[name='"+ew.API_OBJECT_NAME+"']").val(),s=l.el,d=/^x(\d+)_/,u=s.match(d),c=u?u[0]:"x_",f=u?u[1]:-1,p=s.replace(d,"x_"),h=r.getList(s);if(i.default.isString(e)&&(n=qe(e)),null!=(t=n)&&t.success&&n[o]){a.modal("hide");var g=n[o],m=r.$element[0],w=Tt(s,m);if(w){var v=h.linkField,b=h.displayFields.slice(),y=h.filterFields.slice(),_=h.parentFields.slice();_.forEach(((e,t)=>{1==e.split(" ").length&&(_[t]=_[t].replace(/^x_/,c))}));var A=""!=v?g[v]:"",E={lf:A};if(b.forEach(((e,t)=>{e in g&&(E["df"+(t||"")]=g[e])})),y.forEach(((e,t)=>{e in g&&(E["ff"+(t||"")]=g[e])})),A&&b.length>0&&E.df){null===h.ajax&&h.lookupOptions.push(E);var S=_.map((e=>Nt(e,m)));l={data:E,parents:S,valid:!0,name:kt(w),form:m};if(ye.trigger("addoption",[l]),l.valid){var T=zt(w),I=$t(w,E,m);w.options&&(w.options[w.options.length-1].selected=!0,w.list&&i.default(w.target).find("input").last().trigger("focus"),dt(w)?(i.default(w).val(A).trigger("change"),i.default(w.input).val(I).trigger("focus")):i.default(w).trigger("change").trigger("focus"));var O=i.default(m),x=O.is("div")?"_"+m.id:"",C=O.find("#"+ew.FORM_KEY_COUNT_NAME+x).val();if(C>0)for(var P=1;P<=C;P++)if(P!=f){var N=Tt(p.replace(/^x/,"x"+P),m),R=zt(N);JSON.stringify(T)==JSON.stringify(R)&&($t(N,E,m),null==N.render||N.render())}}}}}else{var L;if(null!=(L=n)&&L.error){let e=je(n);e&&ze(e)}else{var F,k,D=i.default("<div></div>").html(e).find("div.ew-message-dialog");if(D[0])F=D.html();else(F=(null==(k=n)?void 0:k.failureMessage)||e)&&""!=String(F).trim()||(F=ew.language.phrase("InsertFailed"));ze(F)}}},l=function(e){a.modal("hide"),ze("Server Error "+e.status+": "+e.statusText)},r=async function(e){let t=ew.addOptionDialog.find(".modal-body form")[0],a=be.get(t.id),r=null==e?void 0:e.target,o=i.default(r);return await a.canSubmit(e)&&(o.prop("disabled",!1).removeClass("disabled"),document.body.style.cursor="wait",i.default.post(Te([ew.API_ADD_ACTION,t.elements[ew.API_OBJECT_NAME].value]),i.default(t).serialize(),n).fail(l).always((function(){a.enableForm(),o.prop("disabled",!1).removeClass("disabled"),document.body.style.cursor="default"}))),!1};a.modal("hide"),a.data("args",e);return i.default.get(e.url,(function(t){var n=be.get(e.lnk),l="x_",o=e.el.match(/^(x\d+_)/);o&&(l=o[1]);var s=n.getList(e.el),d=s.parentFields.slice().map((e=>1==e.split(" ").length?e.replace(/^x_/,l):e)),u=n.htmlForm,c=d.map((e=>Nt(e,u))),f=d.map((e=>Lt(e,u))),p=s.filterFieldVars.slice();a.find(".modal-title").html(i.default(e.lnk).closest(".ew-add-opt-btn").data("title")),a.find(".modal-body").html(qt(t)),(u=a.find(".modal-body form")[0])&&(i.default(u).on("keydown",(function(e){if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return r()})),c.forEach(((e,t)=>{var a;(a=Tt(p[t],u))&&(a.options||a.length?i.default(a).first().one("updated",(()=>Ut(a,e))):Ut(a,e))}))),ew.addOptionDialog=a.modal("show"),a.find(".modal-footer .btn-primary").click(r).focus(),Ht(t,e.el),u&&c.forEach(((e,t)=>{var a=Tt(p[t],u);a&&(dt(a)?(a.value=e[0],a.input.value=f[t][0],a.add(e[0],f[t][0],!0)):a.options||a.length||(a.value=e[0]))})),a.trigger("load.ew")})).fail(l),!1}}else ze("DIV #ew-add-opt-dialog not found.")},modalDialogHide:Yt,modalDialogShow:function(e){var t,a,n,l,r,o,s,d;e.lnk||(e.lnk=null==(t=e.evt)?void 0:t.currentTarget),null==(a=bootstrap.Tooltip.getInstance(e.lnk))||a.hide();let{ewAction:u,action:c}=e,f=e.f||(null==(n=e.evt)||null==(l=n.currentTarget)?void 0:l.form);if(("grid"==u&&"edit"==c||"modal"==u&&["multiedit","update"].includes(c))&&!wt(f))return ze(ew.language.phrase("NoRecordSelected")),!1;let p=e.url||(null==(r=e.evt)||null==(o=r.currentTarget)?void 0:o.dataset.url),h=ew.modalDialog||i.default("#ew-modal-dialog").on("hidden.bs.modal",Yt);if(h.data("showing")&&p&&h.data("url")==p)return!1;h.data({showing:!0,url:p}),e.reload=!1,h.find(".modal-dialog").removeClass("modal-sm modal-md modal-lg modal-xl").addClass(e.size||"modal-xl");let g=function(){let e=h.data("args"),t=i.default(e.lnk);return e.caption||t.data("caption")||t.data("original-title")||""},m=function(e){h.modal("hide"),e.status&&ze("Server Error "+e.status+": "+e.statusText)},w=function(){document.body.style.cursor="default"},v=function(t){let a=je(t);if(a)ze(a);else if(i.default.isString(t.warningMessage))ze(t.warningMessage,cb,"warning");else if(i.default.isString(t.message))ze(t.message,cb,"body");else if(i.default.isString(t.successMessage))ze(t.successMessage,cb,"success");else if(t.reload)h.modal("hide"),window.location.reload();else if(i.default.isBoolean(t.success)&&Ge(null==e?void 0:e.callback))h.modal("hide"),e.callback(t);else if(t.url){let e=t.url;if(t.modal)if(function(e){let t=document.createElement("a");return t.href=e,window.location.pathname.endsWith(t.pathname)}(e))t.error||(h.modal("hide"),fa(fetch(e)));else{let a=h.data("args");a.reload=!0,a.url=e,t.caption&&(a.caption=t.caption),a.btn=t.view?null:"",h.data({args:a,url:e}),e=Ce(e,{modal:"1",rnd:ia()}),document.body.style.cursor="wait",i.default.get(e).done(A).fail(m).always(w)}else h.modal("hide"),window.location=ke(e)}},b=function(){let e=h.find(".modal-footer").empty();if(!h.find(".card-body button[type=submit]").first().addClass("ew-submit").on("click",_)[0]){if(h.find(".modal-body .ew-modal-buttons").contents().clone().find("button").each((function(){if("submit"==this.type){this.type="button",this.classList.add("ew-submit"),"btn-cancel"==this.id&&this.classList.add("ew-cancel");let e=i.default(this);e.on("click",(function(t){"set-action"==this.dataset.ewAction&&(this.form.elements.action.value=this.dataset.value),!1===e.data("ajax")?i.default(this.form).trigger("submit"):_(t)}))}else"btn-cancel"==this.id&&(this.dataset.href?Pt(this.dataset.href,ve.pathname)?this.setAttribute("data-bs-dismiss","modal"):i.default(this).on("click",(()=>ua(this.dataset.href))):this.setAttribute("data-bs-dismiss","modal"));e[0].appendChild(this)})),!h.find(".card-body button[type=submit], .modal-footer .btn")[0]){let t=function(){let e=h.data("args");return null===e.btn?"":e.btn&&""!=e.btn?ew.language.phrase(e.btn):g()}();t?(i.default('<button type="button" class="btn btn-primary ew-btn">'+t+"</button>").on("click",_).appendTo(e),e.append('<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>")):e.append('<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CloseBtn")+"</button>")}e.find("button").on("mousedown",(e=>e.preventDefault())),e.find(".btn-primary").focus()}},y=async function(e){let t=h.data("args");if(!(e instanceof Response))return;let a=e.headers.get("Content-Type");if(null!=a&&a.includes("json")){let a=await e.json();if(Ge(null==t?void 0:t.callback)){let e=je(a);return e?Xe(e):h.modal("hide"),void t.callback(a)}v(a)}else{let a=await e.clone().text(),n=Gt(a).trim();if(n.startsWith("<")&&n.endsWith(">")){if(h.find(".modal-body").html(n),h.find(".modal-body .ew-infinite-scroll-grid .ew-grid-middle-panel").css("height","auto"),!h.find(".modal-body .ew-modal-buttons").length&&Ge(null==t?void 0:t.callback))return h.modal("hide"),void t.callback(e);b(),Ht(a,"modal_dialog"),h.trigger("load.ew")}else a&&(h.modal("hide"),ze(a))}},_=async function(e){let t=h.find(".modal-body form")[0],a=i.default(t),n=be.get(t.id),l=null==e?void 0:e.target;if(l.classList.contains("disabled"))return!1;if(l.classList.contains("ew-cancel"))i.default.post(a.attr("action"),a.serialize(),A).fail(m).always(w);else if(await n.canSubmit(e)){document.body.style.cursor="wait";let l=Bt(a.attr("action"),{method:"POST",body:a.serialize()}).catch(m).finally((()=>{n.enableForm(),w()}));if(n.submitWithFetch){l.then((async e=>{let t=e.clone(),a=t.headers.get("Content-Type");return null!=a&&a.includes("json")&&je(await t.json())||h.modal("hide"),e}));let a={form:t,result:l},r=i.default.Event("aftersubmit",{originalEvent:e});n.trigger(r,[a])}else l.then(y)}return!1},A=function(e){let t=qe(e);if(i.default.isObject(t))v(t);else{let t=h.data("args"),a=i.default(t.lnk),n=Gt(e);h.find(".modal-title").html(g()),h.find(".modal-body").html(n),h.find(".modal-body .ew-infinite-scroll-grid .ew-grid-middle-panel").css("height","auto"),b(),h.find(".modal-footer").toggle(!1!==t.footer);let l=a.data("table");l&&h.find(".modal-dialog").addClass("table-"+l),h.find(".modal-body form").on("keydown",(function(e){if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return $btn.click(),!1})),ew.modalDialog=h.modal("show"),Ht(e,"modal_dialog");let r=bootstrap.Modal.getInstance(h[0]);r._focustrap.__handleFocusin||(r._focustrap.__handleFocusin=r._focustrap._handleFocusin,r._focustrap._handleFocusin=function(e){var t;null!=(t=e.target)&&t.matches("[class^=cke_dialog_]")||this.__handleFocusin(e)}),h.trigger("load.ew")}};if(!0===e.callback&&null!=(s=h.data("args"))&&s.callback&&(e.callback=h.data("args").callback),p&&null!=(d=h.data("args"))&&d.reload&&(e.reload=!0,h.data("args").reload=!1),h.modal("hide"),h.data("args",e),p){document.body.style.cursor="wait";let t=ew.getSearchParams(p);t.set("rnd",ia()),"delete"!=t.get("action")&&t.set("modal","1"),i.default.ajax({url:Ce(p,t),method:f?"POST":"GET",data:f?i.default(f).serialize():"",headers:e.json?{Accept:"application/json, */*; q=0.01"}:{}}).done(A).fail(m).always(w)}else e.html&&function(e){let t=h.data("args");h.find(".modal-title").html(g()),h.find(".modal-body").html(e),b(),h.find(".modal-footer").toggle(!1!==t.footer),ew.modalDialog=h.modal("show")}(e.html);return!1},importDialogShow:function(e){var t,a;e.lnk=e.lnk||(null==(t=e.evt)?void 0:t.currentTarget),null==(a=bootstrap.Tooltip.getInstance(e.lnk))||a.hide();let n=ew.importDialog||i.default("#ew-import-dialog");if(!n[0])return ze("DIV #ew-import-dialog not found."),!1;let l,r,o=n.find("#importfiles"),s=o.closest(".ew-file-drop-zone"),d=n.find(".modal-body"),u=d.find(":input[id!=importfiles]"),c=d.find(".message"),f=d.find(".progress"),p=function(e,t){let a=i.default("<div>"+e+"</div>");var l;t&&a.addClass(t),c.removeClass("d-none").html(a),"text-danger"==t&&(l=!0,n.find(".modal-footer .btn").prop("disabled",!l))},h=()=>c.addClass("d-none").html(""),g=(e,t)=>f.removeClass("d-none").find(".progress-bar").removeClass("bg-success bg-info").addClass(t||"bg-success").attr("aria-valuenow",e).css("width",e+"%").html(e+"%"),m=function(e){const t=qe(e.data)||{};try{let e=t.totalCount||0,a=t.count||0,r=t.successCount||0,o=t.failCount||0,s=t.file;if(e>0&&n.find(".modal-footer .ew-close-btn").data("import-progress")){t.row&&function(e){let{row:t,success:a,error:n,count:r}=e,o=()=>{l.addRow(t).then((e=>e.getElement().classList.toggle("text-danger",n))),n&&console.log(ew.language.phrase("ImportRowError").replace("%i",r+" "+JSON.stringify(t)).replace("%e",n))};t={_index:r,_success:a,_error:n,...t},l?l.initialized?o():l.on("tableBuilt",o):(l=new Tabulator("#ew-import-dialog .result",i.default.extend({data:[t],index:"_index",autoColumns:!0,autoColumnsDefinitions:e=>(e.forEach((e=>{e.headerSort=!1,e.resizable=!1,["_index","_error"].includes(e.field)?e.visible=!1:"_success"==e.field&&(e.title="#",e.headerSort=!0,e.headerSortTristate=!0,e.formatter=e=>{e.getElement().style.textOverflow="clip";let t=e.getRow(),a=t.getData();return a._error&&new bootstrap.Tooltip(t.getElement(),{placement:"bottom",title:a._error,container:"#ew-import-dialog .result"}),(a._success?'<i class="fa-solid fa-check text-success"></i>':'<i class="fa-solid fa-xmark text-danger"></i>')+" #"+a._index})})),e)},ew.importTabulatorOptions)),l.on("tableBuilt",(()=>l.element.querySelector(".tabulator-row").classList.toggle("text-danger",n))))}(t);let n=parseInt(100*a/e,10);g(n),p(ew.language.phrase("ImportResult").replace("%t",e).replace("%c",a).replace("%f",s).replace("%s",r).replace("%e",o),o>0?"text-danger":"text-primary")}}catch(e){}},w=function(e){var t;let a=[],l=qe(e.data)||{},i=l.files;g(100),n.find(".modal-footer .ew-close-btn").data("import-progress",!1),Array.isArray(i)&&i.forEach((e=>{let t=e.totalCount||0,n=e.count||0,l=e.successCount||0,i=e.failCount||0;a.push(ew.language.phrase("ImportResult").replace("%t",t).replace("%c",n).replace("%f",e.file).replace("%s",l).replace("%e",i))})),l.success?(l.rollbacked&&a.push(ew.language.phrase("ImportSave")),p(a.join("<br>"),"text-success"),n.find(".modal-footer .ew-close-btn").data("imported",!0)):(ew.IMPORT_MAX_FAILURES>0&&l.failCount>=ew.IMPORT_MAX_FAILURES&&a.push(ew.language.phrase("ImportMaxFailuresExceeded")),p(a.join("<br>"),"text-danger")),document.body.style.cursor="default",n.find(".modal-footer .ew-close-btn").prop("disabled",!1);let o=n.find(".modal-footer .ew-import-btn").toggleClass("d-none",!l.rollbacked||!l.success);l.rollbacked&&o.off("click").one("click",b),console.log("Closing EventSource..."),null==(t=r)||t.close()},v=function(e){var t;document.body.style.cursor="default",n.find(".modal-footer .ew-close-btn").data("import-progress",!1);let a=qe(e.data)||{};a.error&&p(a.error,"text-danger"),console.log("Closing EventSource..."),null==(t=r)||t.close()},b=function(e){var t;document.body.style.cursor="wait",g(0),null==(t=l)||t.clearData(),n.find(".modal-footer .ew-close-btn").data("import-progress",!0);let a=new URLSearchParams(u.serialize());a.set(ew.API_ACTION_NAME,ew.API_IMPORT_ACTION),a.set(ew.API_FILE_TOKEN_NAME,o.data(ew.API_FILE_TOKEN_NAME)),a.set("rollback","0"),r=new EventSource(ea()+"?"+a.toString()),r.addEventListener("message",m),r.addEventListener("error",v),r.addEventListener("complete",w)},y=ew.importUploadOptions;return y.acceptFileTypes||(y.acceptFileTypes=new RegExp("\\.("+ew.IMPORT_FILE_ALLOWED_EXTENSIONS.replace(/,/g,"|")+")$","i")),o.data("blueimpFileupload")||o.fileupload(Object.assign({url:Te(ew.API_UPLOAD_ACTION),dataType:"json",autoUpload:!0,singleFileUploads:!1,dropZone:s,messages:{acceptFileTypes:ew.language.phrase("UploadErrorAcceptFileTypes"),maxFileSize:ew.language.phrase("UploadErrorMaxFileSize"),maxNumberOfFiles:ew.language.phrase("UploadErrorMaxNumberOfFiles"),minFileSize:ew.language.phrase("UploadErrorMinFileSize")},beforeSend:function(e,t){t.data.set("session",ew.SESSION_ID),t.data.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.data.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&e.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN)},done:function(e,t){var a,i;if(Array.isArray(null==t||null==(a=t.result)||null==(i=a.files)?void 0:i.importfiles)){let e=!0;t.result.files.importfiles.forEach((function(t,a){t.error&&(p(ew.language.phrase("ImportUploadError").replace("%f",t.name).replace("%s",t.error),"text-danger"),e=!1)})),e&&function(e){var t;document.body.style.cursor="wait",g(0),null==(t=l)||t.clearData(),o.data(ew.API_FILE_TOKEN_NAME,e),n.find(".modal-footer .ew-close-btn").data("import-progress",!0);let a=new URLSearchParams(u.serialize());a.set(ew.API_ACTION_NAME,ew.API_IMPORT_ACTION),a.set(ew.API_FILE_TOKEN_NAME,e),a.set("rollback","1"),r=new EventSource(ea()+"?"+a.toString()),r.addEventListener("message",m),r.addEventListener("error",v),r.addEventListener("complete",w)}(t.result[ew.API_FILE_TOKEN_NAME])}},change:function(e,t){h()},processfail:function(e,t){t.files.forEach((function(e,t){e.error&&p(ew.language.phrase("ImportUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger")}))},fail:function(e,t){p(ew.language.phrase("ImportServerError").replace("%s",t.textStatus).replace("%t",t.errorThrown),"text-danger")},progressall:function(e,t){!function(e){const t=parseInt(100*e.loaded/e.total,10);g(t,"bg-primary"),p(100===t?ew.language.phrase("ImportUploadComplete"):ew.language.phrase("ImportUploadProgress").replace("%p",t),"text-primary")}(t)}},y)),n.modal("hide").find(".modal-title").html(e.hdr),n.find(".modal-footer .ew-close-btn").off("click.ew").on("click.ew",(function(){let e=i.default(this);e.data("imported")&&(e.data("imported",!1),window.location.reload())})),h(),ew.importDialog=n.on("show.bs.modal",(function(){var e,t,a;f.addClass("d-none").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").html("0%"),null==(e=this.querySelector(".modal-footer .ew-import-btn"))||e.classList.add("d-none"),null==(t=l)||t.element.removeAttribute("style"),null==(a=l)||a.destroy(),l=null})).modal("show"),!1},autoFill:Jt,tooltip:Xt,initSearchFilters:Zt,emailDialogShow:function(e){let t=ew.emailDialog||i.default("#ew-email-dialog").on("shown.bs.modal",(e=>setTimeout((()=>{var t;return null==(t=e.target.querySelector(".modal-body .form-control"))?void 0:t.focus()}),200))).on("click",".modal-footer .btn-primary",(function(e){var a;e.preventDefault(),null!=(a=i.default(this).closest(".modal").find(".modal-body form").data("form"))&&a.submit()&&t.modal("hide")}));if(!t[0])return ze("DIV #ew-email-dialog not found."),!1;let a=e.evt.currentTarget.form;if(e.exportSelected&&!wt(a))return ze(ew.language.phrase("NoRecordSelected")),!1;let n=t.find(".modal-body form"),l=n.data("form");return l||(l=(new y).setId(n.attr("id")).addFields([["sender",[ew.Validators.required(ew.language.phrase("Sender")),ew.Validators.email]],["recipient",[ew.Validators.required(ew.language.phrase("Recipient")),ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperRecipientEmail"))]],["cc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperCcEmail"))],["bcc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperBccEmail"))],["subject",ew.Validators.required(ew.language.phrase("Subject"))]]).setValidate((function(){return this.validateFields()})).setSubmit((function(){if(!this.validate())return!1;let l=Pe(n.serialize(),e.key,lt(),a&&e.exportSelected?i.default(a).find("input[type=checkbox][name='key_m[]']:checked").serialize():null);return t.modal("hide"),e.custom?it({...e,export:"email",custom:!0,emailForm:n[0]}):Qt(n.find("#tblvar").val(),l),!1})).build(),n.data("form",l)),ew.emailDialog=t.modal("hide").find(".modal-title").html(e.hdr).end().modal("show"),!1},exportEmail:Qt,showDrillDown:function(e,t,a,n,l){if(null!=e&&e.ctrlKey){return ua(Ce(a,{d:"2"}))}var r=i.default(t),o=r.data("drilldown-placement")||"auto",s={obj:r[0],placement:o,id:n,url:a,hdr:l};ye.trigger("drilldown",[s]);var d=s.url.split("?");s.file=d[0]||"",s.data=d[1]||"",bootstrap.Popover.getInstance(t)||r.popover({...ew.popoverOptions,placement:s.placement,trigger:"manual",title:s.hdr,template:'<div class="popover" role="tooltip"><h3 class="popover-header d-none" style="cursor: move;"></h3><div class="popover-body"></div></div>',content:ew.spinnerTemplate(),container:i.default("#ew-drilldown-panel").draggable(ew.draggableOptions),boundary:"viewport"}).on("show.bs.popover",(function(e){r.attr("data-original-title","")})).on("shown.bs.popover",(function(e){if(r.data("args")){var a=r.data("args").data;i.default.ajax({cache:!1,dataType:"html",type:"POST",data:a,url:r.data("args").file,success:function(e){var a=i.default(bootstrap.Popover.getInstance(t)._getTipElement());s.hdr&&a.find(".popover-header").empty().removeClass("d-none").append('<button type="button" class="btn-close" aria-label="'+ew.language.phrase("CloseBtn")+'"></button>'+s.hdr).find(".btn-close").on("click",(function(){r.popover("hide")}));var l=e.match(/<body[^>]*>([\s\S]*?)<\/body\s*>/i);e=l?l[0]:e;var o=ew.stripScript(e);a.find(".popover-body").html(i.default("<div></div>").html(o).find("#ew-report")).find(".ew-table").each(ew.setupTable),ew.executeScript(e,n),r.popover("update")},error:function(e){if(e.responseText){let r=bootstrap.Popover.getInstance(t);if(i.default.isString(e.responseText)&&e.responseText.startsWith("{")&&e.responseText.endsWith("}")){var a,n,l=qe(e.responseText);if(null!=l&&null!=(a=l.error)&&a.type&&null!=l&&null!=(n=l.error)&&n.description)return null==r||r.hide(),ze({title:l.error.type,html:l.error.description,customClass:{title:"ew-swal2-title text-danger",htmlContainer:"ew-swal2-html-container text-danger"}})}null==r||r.setContent({".popover-body":'<p class="text-danger">'+e.responseText+"</p>"})}}})}})).on("hidden.bs.popover",(function(e){ew.removeScript(n)})),r.data("args",s).popover("show")},ajax:function(e,t){if(i.default.isObject(e)&&(e.url||e.action)){var a;e.url?e.url.startsWith(Te())?a=e.url.replace(Te(),"").split("/")[0]:e.url.startsWith(ew.API_URL)&&(a=e.url.replace(ew.API_URL,"").split("/")[0]):(a=e.action,delete e.action);var n=Object.assign({},e),l=e=>{if(i.default.isObject(e)&&"OK"==e.result){var t=e.records;return Array.isArray(t)&&1==t.length?(t=t[0],Array.isArray(t)&&1==t.length?t[0]:t):t}return e},r=n.url||Te(a),o=n.type||([ew.API_LIST_ACTION,ew.API_VIEW_ACTION,ew.API_DELETE_ACTION].includes(a)?"GET":"POST");if(delete n.url,delete n.type,n.dataType="json",!Ge(t)){var s=i.default.ajax({url:r,async:!1,type:o,data:n});return l(s.responseJSON)}i.default.ajax({url:r,type:o,data:n,success:function(e){t(l(e))}})}},currentPage:ea,toggleSearchOperator:function(e,t,a){var n=e.currentTarget.form.elements[t];n&&(n.value=n.value!=a?a:"=")},toggleLayout:function(e){var t;null==(t=bootstrap.Tooltip.getInstance(e))||t.hide(),document.body.style.cursor="wait",fetch(ke(Fe(e.dataset.url,e.dataset.layout))).then((e=>e.text())).then((e=>{let t=i.default(".ew-multi-column-grid").html(i.default("<div>"+e+"</div>").find(".ew-multi-column-grid").html());ew.initPage({target:t[0]}),t.trigger("load.ew")})).catch((e=>ze(e))).finally((()=>document.body.style.cursor="default"))},copyToClipboard:ta,checkInteger:function(e){return!e||0==e.length||!e.includes(ew.DECIMAL_SEPARATOR)&&aa(e)},checkNumber:aa,escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},checkRange:function(e,t,a){return!e||0==e.length||((i.default.isNumber(t)||i.default.isNumber(a))&&aa(e)&&(e=ew.parseNumber(e)),!(null!==t&&e<t)&&!(null!==a&&e>a))},checkPhone:function(e){return!e||0==e.length||/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/.test(e.trim())},checkZip:function(e){return!e||0==e.length||/^\d{5}$|^\d{5}-\d{4}$/.test(e.trim())},checkCreditCard:function(e){if(!e||0==e.length)return!0;var t=e.replace(/\D/g,"");if(0==t.length)return!1;for(var a,n=t.length%2!=1,l=0,i=0,r=t.length;i<r;i++)a=parseInt(t.charAt(i),10),n?(l+=(a*=2)%10,a/10>=1&&l++,n=!1):(l+=a,n=!0);return l%10==0},checkSsn:function(e){return!e||0==e.length||/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/.test(e.trim())},checkEmails:function(e,t){if(!e||0==e.length)return!0;for(var a=e.replace(/,/g,";").split(";"),n=0,l=a.length;n<l;n++){if(t>0&&l>t)return!1;if(!na(a[n]))return!1}return!0},checkEmail:na,checkGuid:function(e){return!e||0==e.length||/^(\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}|\w{8}-\w{4}-\w{4}-\w{4}-\w{12})$/.test(e.trim())},checkUrl:function(e){if(!e||0==e.length)return!0;try{new URL(e)}catch(e){return!1}return!0},checkByRegEx:function(e,t){return!e||0==e.length||!!e.match(t)},showMessage:la,random:ia,upload:function(e){let t=i.default(e);if(t.data("blueimpFileupload"))return;let a=t.attr("name"),n=a.replace(/\$/g,"\\$"),l=t.data("table"),r=t.is("[multiple]"),o=t.closest(".ew-file-drop-zone"),s=t.closest(Ae),d=s.find("#ft_"+n),u=s.find("#fn_"+n),c=s.find("#fa_"+n),f=s.find(".ew-file-label"),p=f.html(),h=function(e){!r&&u.val()&&(confirm(ew.language.phrase("UploadOverwrite"))||(e.preventDefault(),e.stopPropagation()))},g=Te(ew.API_JQUERY_UPLOAD_ACTION),m=i.default.templates("#template-download"),w=i.default.templates("#template-upload"),v=Ze(e),b="confirm"==i.default(v).find("#confirm").val()||t.attr("readonly")||t.prop("disabled");b&&!t.prop("disabled")&&t.prop("disabled",!0);const{acceptFileTypes:y,maxFileSize:_,maxNumberOfFiles:A}=t.data(),E={id:a,table:l,session:ew.SESSION_ID,replace:r?"0":"1",acceptFileTypes:y,maxFileSize:_,maxNumberOfFiles:A};t.fileupload(ew.deepAssign({url:g,type:"POST",multipart:!0,autoUpload:!0,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/mp4$/i,loadAudioFileTypes:/^audio\/(mpeg|mp3)$/i,filesContainer:d,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:w.render.bind(w),downloadTemplate:m.render.bind(m),previewMaxWidth:ew.UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:ew.UPLOAD_THUMBNAIL_HEIGHT,dropZone:o,messages:{acceptFileTypes:ew.language.phrase("UploadErrorAcceptFileTypes"),maxNumberOfFiles:ew.language.phrase("UploadErrorMaxNumberOfFiles"),maxFileSize:ew.language.phrase("UploadErrorMaxFileSize"),minFileSize:ew.language.phrase("UploadErrorMinFileSize")},formData:E,readonly:b},ew.uploadOptions)).on("fileuploaddone",(function(e,t){if(t.result.files[0].error)return;let a=t.result.files[0].name,n=r&&u.val()?u.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];n.push(a),u.val(n.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),c.val("0"),r||d.find("tbody > tr:not(:last-child)").remove()})).on("fileuploaddestroy",(function(e,t){let a=xe(e.originalEvent.target.dataset.url),n=a.get("id"),l=a.get(n);if(l){let e=u.val()?u.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[],t=e.indexOf(l);t>-1&&e.splice(t,1),u.val(e.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),c.val("0")}})).on("fileuploadchange",(function(e,a){var n;d.toggleClass("ew-has-rows",(null==(n=a.files)?void 0:n.length)>0);let l=u.val()?u.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];a.files.forEach((e=>l.push(e.name)));let r=t.data("maxCount");if(i.default.isNumber(r)&&r>0&&l.length>r)return ze(ew.language.phrase("UploadErrorMaxNumberOfFiles")),!1;let o=t.data("size");return i.default.isNumber(o)&&o>0&&l.join(ew.MULTIPLE_UPLOAD_SEPARATOR).length>o?(ze(ew.language.phrase("UploadErrorMaxFileLength")),!1):void 0})).on("fileuploadadded fileuploadfinished fileuploaddestroyed",(function(e,t){var a,n,l;d.toggleClass("ew-has-rows",(null==(a=t.files)?void 0:a.length)>0||(null==(n=t.result)||null==(l=n.files)?void 0:l.length)>0);let i=u.val()?u.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];f.html(i.join(", ")||p)})).on("fileuploadadded",(function(e,t){var a;d.toggleClass("ew-has-rows",(null==(a=t.files)?void 0:a.length)>0),t.context.find(".start").click(h)})).on("fileuploadcompleted",(function(e,t){let a={target:t.context};Be(a),Ve(a),ew.updateDropdownPosition(),t.context.find("img").on("load",ew.updateDropdownPosition)})),u.val()&&i.default.ajax({url:g,data:{id:a,table:l,session:ew.SESSION_ID},dataType:"json",context:this,success:function(n){if(null!=n&&n[a]){let l=t.fileupload("option","done");l&&l.call(e,i.default.Event(),{result:{files:n[a]}})}b&&d.find("td.delete").hide()}})},parseNumber:function(e){let t=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(t.numeralSystem=void 0),t.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(t.delimiters.thousands=ew.GROUPING_SEPARATOR),t.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(t.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.parse(e,{locale:t})},getNumberingSystem:function(){return ew.NUMBERING_SYSTEM||new Intl.NumberFormat(ew.LANGUAGE_ID).resolvedOptions().numberingSystem},formatDateTime:sa,formatTimeSpan:function(e,t,a){let n=ra.fromJSDate(e,{zone:"utc"}),l=ra.fromJSDate(t,{zone:"utc"});l.isValid&&l.equals(l.startOf("day"))&&(l=l.minus(1));let i=new oa({start:n,end:l});if(i.isValid){let e=i.count()/864e5;a||(a=Number.isInteger(e)&&e>=1)}return a?i.isValid&&i.count("days")>1||n.isValid&&l.isValid&&n.startOf("day")<l.startOf("day")?sa(n,ew.DATE_FORMAT)+" - "+sa(l,ew.DATE_FORMAT):n.isValid&&!t?sa(n,ew.DATE_FORMAT):"":n.isValid&&l.isValid?n.startOf("day")<l.startOf("day")?sa(n,ew.DATE_FORMAT+" "+ew.TIME_FORMAT)+" - "+sa(l,ew.DATE_FORMAT+" "+ew.TIME_FORMAT):sa(n,ew.TIME_FORMAT)+" - "+sa(l,ew.TIME_FORMAT):n.isValid?sa(n,ew.TIME_FORMAT):""},parseDateTime:da,parseDate:da,parseTime:da,checkDate:function(e,t){return!e||0==e.length||da(e,t).isValid},checkTime:function(e,t){return!e||0==e.length||da(e,t).isValid},formatCurrency:function(e,t){if(t||(t=ew.CURRENCY_FORMAT),t.includes(";")){let a=t.split(";");t=e>=0?a[0]:a[1]}t=t.replace("¤","$");let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t,{locale:a,currency:(ew.IS_RTL?"‎":"")+ew.CURRENCY_SYMBOL})},formatNumber:function(e,t){let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t||ew.NUMBER_FORMAT,{locale:a})},formatPercent:function(e,t){let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t||ew.PERCENT_FORMAT,{locale:a})},initPage:function(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document,n=i.default(a),l=n.find("table.ew-table:not(.ew-export-table)");ew.initPanels(a),ew.renderJsTemplates(e),Ue(e),Ke(e),He(e),Se(e),Ee(e),Zt(e),Be(e),Ve(e),l.each(At),n.find(".ew-column-dropdown").each((function(){var e;let t=this.dataset.table;null==(e=localStorage.getItem(ew.PROJECT_NAME+"_"+t+"_invisible_fields"))||e.split(",").forEach((e=>i.default("#tbl_"+t+"list").find("th[data-name='"+e+"'],td[data-name='"+e+"']").toggleClass("d-none",!0))),i.default(this).find(".ew-dropdown-checkbox").on("click",(function(e){let a=this.querySelector(".ew-dropdown-check-input[data-field]"),n=null==a?void 0:a.dataset.field;t&&n&&(a.classList.toggle("ew-checked"),i.default("#tbl_"+t+"list").find("th[data-name='"+n+"'],td[data-name='"+n+"']").toggleClass("d-none",!a.classList.contains("ew-checked"))),localStorage.setItem(ew.PROJECT_NAME+"_"+t+"_invisible_fields",Array.from(e.currentTarget.closest(".dropdown-menu").querySelectorAll(".ew-dropdown-check-input[data-field]:not(.ew-checked)"),(e=>e.dataset.field)))}))})).on("show.bs.dropdown",(function(e){let t=e.currentTarget.dataset.table,a=e.currentTarget.querySelectorAll(".ew-dropdown-check-input[data-field]");for(let e of a){let a=e.dataset.field;e.classList.toggle("ew-checked",!!i.default("#tbl_"+t+"list").find("th[data-name='"+a+"']:not(.d-none)")[0])}})),De(e),Me(e);var r=n.find(".ew-report");r[0]&&(r.find(".card").on("collapsed.lte.widget",(function(){var e=i.default(this).closest("[class^='col-']"),t=e.css("min-height");t&&e.data("min-height",t),e.css("min-height",0)})).on("expanded.lte.widget",(function(){var e=i.default(this).closest("[class^='col-']"),t=e.css("min-height");t&&e.css("min-height",t)})),r.find(".ew-group-toggle").on("click",(function(){ew.toggleGroup(this)}))),"undefined"!=typeof ew.USE_JAVASCRIPT_MESSAGE&&ew.USE_JAVASCRIPT_MESSAGE&&la(e)},redirect:ua,togglePassword:function(e){let t=i.default(e.currentTarget),a=t.closest(".input-group").find("input"),n=t.find("i");"text"==a.attr("type")?(a.attr("type","password"),n.toggleClass("fa-eye-slash fa-eye")):"password"==a.attr("type")&&(a.attr("type","text"),n.toggleClass("fa-eye-slash fa-eye"))},updateChart:function(e){let t=new URL(e.form.action),a=i.default(e).closest(".ew-chart-top, .ew-chart-bottom"),n=i.default(ew.overlayTemplate());t.search=i.default(e.form).serialize(),a.addClass("ew-loading").append(n),fetch(t.toString()).then((async e=>{let t=i.default("<div>"+await e.text()+"</div>"),n=t.find(".ew-chart-top, .ew-chart-bottom").filter("[data-chart='"+a.data("chart")+"']"),l=t.find(".ew-debug");n[0]&&a.replaceWith(n),l[0]&&n.next(".ew-debug").replaceWith(l)})).finally((()=>a.removeClass("ew-loading").find(n).remove()))},isMediumScreen:ca,isMobile:function(){return ew.IS_MOBILE||!ca()},refresh:fa,isDark:function(){return document.body.classList.contains("dark-mode")},fixLayoutHeight:function(){pa&&pa.cancel(),pa=i.default.later(50,null,(function(){var e=_e.data("lte.layout");e&&e.fixLayoutHeight()}))},addEventHandlers:function(e){let t=ew.events[e];if(t)for(const[a,n]of Object.entries(t))i.default("[data-table="+e+"][data-field="+a+"]").on(n)}};var ga={__proto__:null,fullCalendar:function(e,t,a){let n,{updateTable:l,eventFields:r,addUrl:o,viewUrl:s,editUrl:d,deleteUrl:u,fullCalendarOptions:c,eventPopoverOptions:f}=t,p=e=>{let t=(e,t)=>{let a;return"string"==typeof t&&(a=t.match(/^(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}:\d{2})/))?a[1]+"T"+a[2]:"allDay"==e?ew.convertToBool(t):"url"!=e||t?"display"!=e||t?"classNames"==e&&t&&i.default.isString(t)?t.replace(/\s+/g," ").split(" "):"description"!=e||t?t:"":"auto":""};if(e.success){let a=e.action,i=e[l];Array.isArray(i)||(i=[i]);for(let e of i){let l=n.getEventById(e.id);if(a==ew.API_DELETE_ACTION)l.remove();else if(a==ew.API_ADD_ACTION){for(let a in e){let n=Object.keys(r),l=n.find((e=>r[e]===a))||(n.includes(a)?a:null),i=e[a];l&&void 0!==i&&(e[l]=t(l,i))}n.addEvent(e)}else for(let a in e){let n=Object.keys(r).find((e=>r[e]===a)),i=e[a];n&&void 0!==i&&(i=t(n,i),"start"==n?l.setStart(i):"end"==n?l.setEnd(i):"allDay"==n?l.setAllDay(i):l.setProp(n,i)),i&&l.setExtendedProp(a,i),"description"==n&&l.setExtendedProp(n,i)}}}},h=e=>{let t=e.event,a=[t,...e.relatedEvents];apiAction=t.id?ew.API_EDIT_ACTION:ew.API_ADD_ACTION,a.forEach((t=>g(t,apiAction).then((t=>{t.success?p(t):e.revert()})).catch((t=>{console.log(t),e.revert()}))))},g=(e,t)=>new Promise(((a,n)=>{let o=e.toPlainObject({collapseExtendedProps:!0}),s={};for(let[e,t]of Object.entries(r))if(e in o){let a=o[e];t||(t=e),a instanceof Date?a=a.toISOString().slice(0,-5).replace(/T/," "):"string"==typeof a&&a.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?a=a.substring(0,19).replace(/T/," "):"boolean"==typeof a?a=a?"1":"0":"classNames"==e&&(a=Array.isArray(a)?a.join(" "):a),s[t]=a,delete o[e]}s={...s,...o};let d=t==ew.API_ADD_ACTION?ew.getApiUrl([t,l]):ew.getApiUrl([t,l,e.id]);i.default.post(d,s,(e=>a(e))).fail((e=>n(e)))})),m=e=>Object.keys(currentTable.fields).find((t=>currentTable.fields[t].name==e)),w=(e,t)=>{let a=e.split("?");return a[0]+=t?(a[0].endsWith("/")?"":"/")+t:"",a.join("?")},v=e=>{let t=o,a=new URLSearchParams;if(i.default.isObject(e)&&(e.startStr||e.endStr||e.allDay)){let t=m(r.start),n=m(r.end),l=m(r.allDay);t&&e.startStr&&a.set(t,e.startStr),n&&e.endStr&&a.set(n,e.endStr),l&&e.allDay&&a.set(l,"1")}i.default.isString(e)&&e.match(/^\d+$/)&&(t=w(t,e));let n=a.toString();t+=n?"?"+n:"",ew.modalDialogShow({url:t,callback:p,json:!0,btn:ew.language.phrase("AddBtn"),caption:ew.language.phrase("AddLink")})},b=e=>ew.modalDialogShow({url:w(s,e),callback:p,json:!0,btn:null,caption:ew.language.phrase("ViewLink")});o&&(c.customButtons={add:{text:ew.language.phrase("AddEvent"),click:v}},c.headerToolbar.left+=" add");let y,_=e=>{let t={...bootstrap.Popover.Default,...f,trigger:"manual"},a=bootstrap.Popover.getOrCreateInstance(e.el,t),n=i.default.templates(document.querySelector("script[data-name='event-popover']").text);e.event.setExtendedProp("timeSpan",ew.formatTimeSpan(e.event.start,e.event.end,e.event.allDay));let l=n.render(e.event,ew.jsRenderHelpers).trim();if(l){var r,o;let t=null!=(r=null==(o=Array.from(e.el.classList.values()).find((e=>e.match(/^event-([\w+]+)\b/))))?void 0:o.replace(/^event-/,"popover-"))?r:"popover-default";return a._templateFactory=null,a._config.title=e.event.title,a._config.content=l,a._config.customClass+=(a._config.customClass?" ":"")+"ew-event-popover "+t,a}return null},A=e=>{let t=0,a=0;if(e){let n=e.el.getBoundingClientRect(),l=e.jsEvent;t=n.left+l.offsetX,a=n.top+l.offsetY}return()=>({width:0,height:0,top:a,right:t,bottom:a,left:t})},E={getBoundingClientRect:A()};a&&t.useContextMenu&&(s||d||o||u)&&(a.dataset.bsToggle="dropdown",document.addEventListener("keydown",(e=>"Escape"!==e.key||bootstrap.Dropdown.clearMenus())),y=bootstrap.Dropdown.getOrCreateInstance(a,{reference:E}),y._menu.querySelectorAll(".dropdown-item").forEach((e=>e.addEventListener("click",(e=>{let t=e.currentTarget.dataset,a=t.action,n=t.eventId;a&&n&&("view"==a&&s?b(n):"edit"==a&&d?(e=>{ew.modalDialogShow({url:w(d,e),callback:p,json:!0,btn:null,caption:ew.language.phrase("EditLink")})})(n):"add"==a&&o?v(n):"delete"==a&&u&&(e=>{ew.prompt(ew.language.phrase("DeleteEventConfirm"),(t=>{t&&ew.modalDialogShow({url:ew.setSearchParams(w(u,e),{action:"delete"}),callback:p,json:!0})}))})(n))})))));let S={element:e,options:ew.deepAssign(c,{drop:function(e){document.getElementById("remove-event").checked&&e.draggedEl.parentNode.removeChild(e.draggedEl)},select:e=>v(e),eventReceive:h,eventDrop:h,eventResize:h,eventClick:e=>{if(e.jsEvent.preventDefault(),e.event.url)window.open(e.event.url);else if(2==e.jsEvent.button){var a;if(y)null==(a=bootstrap.Popover.getInstance(e.el))||a.hide(),y.hide(),y._menu.querySelectorAll(".dropdown-item").forEach((a=>{a.dataset.eventId=e.event.id,a.classList.toggle("d-none",!t[a.dataset.action+"Url"])})),y._menu.querySelectorAll(".dropdown-item:not(.d-done)").length&&(E.getBoundingClientRect=A(e),y.show())}else if(t.usePopover&&f.trigger.match(/\bclick\b/)){var n;null==(n=_(e))||n.toggle()}else t.showViewPageOnEventClick&&b(e)},eventMouseEnter:e=>{var a,n;null!=(a=y)&&a._isShown(y._menu)||"dayGridMonth"==e.view.type&&t.usePopover&&f.trigger.match(/\bhover\b/)&&(null==(n=_(e))||n.show())},eventMouseLeave:e=>{var a,n;null!=(a=y)&&a._isShown(y._menu)||"dayGridMonth"==e.view.type&&t.usePopover&&f.trigger.match(/\bhover\b/)&&(null==(n=bootstrap.Popover.getInstance(e.el))||n.hide())}})};return i.default(document).trigger("calendar",[S]),n=new window.FullCalendar.Calendar(e,S.options),n}};function ma(){return"serviceWorker"in navigator&&"PushManager"in window}function wa(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(t),n=new Uint8Array(a.length);for(let e=0;e<a.length;++e)n[e]=a.charCodeAt(e);return n}async function va(e,t){const a=e.getKey("p256dh"),n=e.getKey("auth"),i=(PushManager.supportedContentEncodings||["aesgcm"])[0];let r=new FormData;return r.set("endpoint",e.endpoint),r.set("publicKey",a?btoa(String.fromCharCode.apply(null,new Uint8Array(a))):null),r.set("authToken",n?btoa(String.fromCharCode.apply(null,new Uint8Array(n))):null),r.set("contentEncoding",i),(await l.default.fetch(t,{method:"POST",body:r})).json()}async function ba(){var e;let t=l.default.getApiUrl([l.default.API_PUSH_NOTIFICATION_ACTION,l.default.API_PUSH_NOTIFICATION_SUBSCRIBE]),a=await navigator.serviceWorker.ready,n=await a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:wa(l.default.PUSH_SERVER_PUBLIC_KEY)}),i=await va(n,t);return null!=i&&null!=(e=i.error)&&e.description&&l.default.alert(i.error.description),i.success?n:null}async function ya(){return(await navigator.serviceWorker.ready).pushManager.getSubscription()}function _a(e){let t=i.default("#subscribe-notification").toggleClass("ew-enable-notification",!e).removeClass("disabled");t.find("i").toggleClass("fa-bell",!e).toggleClass("fa-bell-slash",!!e);let a=bootstrap.Tooltip.getInstance(t[0]);a&&(a._config.title=l.default.language.phrase(e?"DisableNotifications":"EnableNotifications"))}async function Aa(){if("denied"!==Notification.permission&&!l.default.IS_SYS_ADMIN){document.body.style.cursor="wait";try{var e,t;if("granted"===Notification.permission)_a(null!=(e=await ya())?e:await ba()),null!=(t=document.getElementById("subscribe-notification"))&&t.classList.contains("ew-enable-notification")||l.default.showToast(l.default.language.phrase("NotificationsEnabled"),"success");else if("default"===Notification.permission&&"granted"==await Notification.requestPermission()){var a;_a(await ba()),null!=(a=document.getElementById("subscribe-notification"))&&a.classList.contains("ew-enable-notification")||l.default.showToast(l.default.language.phrase("NotificationsEnabled"),"success")}}catch(e){l.default.alert(e)}finally{document.body.style.cursor="default"}}return!1}async function Ea(){return i.default("#subscribe-notification").tooltip(),"granted"==Notification.permission?_a(await ya()):_a(null),!0}async function Sa(){return l.default.prompt({html:l.default.language.phrase("DisableNotificationsConfirm")},(async e=>{if(e){document.body.style.cursor="wait";try{var t;let e=await ya();await e.unsubscribe();let a=l.default.getApiUrl([l.default.API_PUSH_NOTIFICATION_ACTION,l.default.API_PUSH_NOTIFICATION_DELETE]),n=await va(e,a);if(null!=n&&null!=(t=n.error)&&t.description)return l.default.alert(n.error.description),!1;n.success&&(_a(null),l.default.showToast(l.default.language.phrase("NotificationsDisabled"),"success"))}catch(e){l.default.alert(e)}finally{document.body.style.cursor="default"}}})),!1}l.default.SERVICE_WORKER="sw.js",loadjs.ready("foot",(()=>{l.default.PUSH_SERVER_PUBLIC_KEY&&ma()?navigator.serviceWorker.register(l.default.PATH_BASE+l.default.SERVICE_WORKER,{scope:l.default.PATH_BASE}).then((()=>{Ea(),i.default("#subscribe-notification").on("click",(function(){this.classList.contains("ew-enable-notification")?Aa():Sa()}))})).catch((e=>console.log(e))):i.default("#subscribe-notification").addClass("d-none")}));var Ta={__proto__:null,pushNotificationDialogShow:async function(e){let t=l.default.pushDialog||i.default("#ew-push-notification-dialog").on("shown.bs.modal",(e=>setTimeout((()=>{var t;return null==(t=e.target.querySelector(".modal-body .form-control"))?void 0:t.focus()}),200))).on("click",".modal-footer .btn-primary",(function(e){var a;e.preventDefault(),null!=(a=i.default(this).closest(".modal").find(".modal-body form").data("form"))&&a.submit()&&t.modal("hide")}));if(!t[0])return console.log("DIV #ew-push-notificatoin-dialog not found"),!1;if(!e.url)return console.log("Missing URL of Web Push API"),!1;let a=e.evt.currentTarget,n=i.default(a.form),r=t.find(".modal-body form"),o=r.data("form");if(r.data("all",!1),!n.find("input[name='key_m[]']:checked")[0]){let e=await l.default.prompt(l.default.language.phrase("SendPushNotificationsToAll"),(e=>e));if(r.data("all",e),!e)return}return o||(o=(new l.default.FormBuilder).setId(r.attr("id")).addFields([["title",l.default.Validators.required(l.default.language.phrase("PushNotificationFormTitle"))],["body",l.default.Validators.required(l.default.language.phrase("PushNotificationFormBody"))]]).setValidate((function(){return this.validateFields()})).setSubmit((function(){if(!this.validate())return!1;let t=[r.serialize(),r.data("all")?"":n.find("input[name='key_m[]']:checked").serialize()].join("&");return i.default.post(e.url,t,(e=>{var t;if(Array.isArray(e)){let t=e.reduce(((e,t)=>e+(t.success?1:0)),0),a=e.length-t;t>0&&0==a?l.default.alert(l.default.language.phrase("PushNotificationSuccess").replace("%s",t),"success"):0==t&&a>0?l.default.alert(l.default.language.phrase("PushNotificationFailure").replace("%f",a)):0==t&&0==a?l.default.alert(l.default.language.phrase("NoSubscriptions").replace("%f",a),"primary"):l.default.alert(l.default.language.phrase("PushNotificationSent").replace("%s",t).replace("%f",a),"primary")}else null!=e&&null!=(t=e.error)&&t.description&&l.default.alert(e.error.description)})),!0})).build(),r.data("form",o)),l.default.pushDialog=t.modal("hide").find(".modal-title").html(e.hdr||a.dataset.caption).end().modal("show"),!1},isPushNotificationSupported:ma,subscribeNotification:Aa,checkSubscription:Ea,unsubscribeNotification:Sa};function Ia(e){if(e.inited)return!0;let t=e.latlng,a=i.default("#"+e.id),n=e.useSingleMap,l=e.showAllMarkers,r=e.useMarkerClusterer,o=ew.maps[e.ext];if(n){let t=e.id.replace(/^mp\d*_/,"mp_");a=i.default("#"+t),a[0]||(a=i.default("<div></div>").attr("id",t).addClass("ew-single-map").height(e.singleMapHeight),e.singleMapWidth&&a.width(e.singleMapWidth),i.default(".ew-grid, .ew-multi-column-grid").first()[e.showMapOnTop?"before":"after"](a),e.map=o.createMap(a[0],e),a.data("map",e.map),a.data("ext",e.ext),a.data("bounds",l?o.createBounds():null),a.data("markerClusterer",r?o.createMarkerClusterer(e):null)),e=Object.assign(e,a.data())}else{if(!t)return a.addClass("d-none").html(e.status),!0;a.next(".ew-map-value").addClass("d-none"),e.map||(e.map=o.createMap(a[0],e))}return e.marker=o.createMarker(e),e.inited=!0,i.default(document).trigger("map",[e]),!0}function Oa(){i.default(".ew-single-map").each((function(){let e=i.default(this).data();ew.maps[e.ext].fitBounds(e)})),i.default(document).trigger("maps")}function xa(e){let t=i.default(".ew-map").filter((function(){return!e||i.default(this).data("ext")==e})).map((function(e){let t=i.default(this).data();if(t.inited)return Ia(t);if(t.id=this.id,t.address=(t.address||"").trim(),t.address){let a=t.geocodingDelay;return new Promise((n=>{i.default.later(e*a,null,(()=>{n(ew.maps[t.ext].geocode(t).then((e=>{t.latlng=e})).catch((e=>{t.status=e})).finally((()=>Ia(t))))}))}))}{let e=t.latitude,a=t.longitude;return e&&!isNaN(e)&&a&&!isNaN(a)&&(t.latlng=ew.maps[t.ext].createLatLng(e,a)),Ia(t)}})).get();return Promise.all(t).then(Oa)}i.default((function(){i.default("#ew-modal-dialog").on("load.ew",xa),i.default(document).on("preview.ew",xa)}));var Ca={__proto__:null,show:Ia,done:Oa,init:xa};ew.MOBILE_DETECT=new MobileDetect(window.navigator.userAgent),ew.IS_MOBILE=!!ew.MOBILE_DETECT.mobile(),window.exportCharts={},Object.assign(ew,{MultiPage:function(e){var t=this;this.$form=null,this.formID=e,this.pageIndex=1,this.maxPageIndex=0,this.minPageIndex=0,this.pageIndexes=[],this.$pages=null,this.$collapses=null,this.isTab=!1,this.isCollapse=!1,this.lastPageSubmit=!1,this.hideDisabledButton=!1,this.hideInactivePages=!1,this.lockTabs=!1,this.hideTabs=!1,this.showPagerTop=!1,this.showPagerBottom=!1,this.pagerTemplate='<nav><ul class="pagination"><li class="page-item previous ew-prev"><a href="#" class="page-link"><i class="fa-solid fa-angle-left"></i> {Prev}</a></li><li class="page-item next ew-next"><a href="#" class="page-link">{Next} <i class="fa-solid fa-angle-right"></i></a></li></ul></nav>';var a=function(e){e.preventDefault()},n=["lastPageSubmit","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate"];this.set=function(){if(1==arguments.length&&i.default.isObject(arguments[0])){var e=arguments[0];for(var t in e){var a=t[0].toLowerCase()+t.substring(1);n.includes(a)&&(this[a]=e[t])}}},this.init=function(){var e=this.pagerTemplate.replace(/\{prev\}/i,ew.language.phrase("Prev")).replace(/\{next\}/i,ew.language.phrase("Next"));this.isTab?(this.showPagerTop&&this.$pages.closest(".ew-nav").before(e),this.showPagerBottom&&this.$pages.closest(".ew-nav").after(e),this.$form.find(".ew-prev").click((function(e){return t.$pages.off("show.bs.tab",a).filter(".active").parent().prev(":has([data-bs-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-bs-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.$form.find(".ew-next").click((function(e){return t.$pages.off("show.bs.tab",a).filter(".active").parent().next(":has([data-bs-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-bs-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.hideTabs&&this.$form.find(".ew-multi-page > .ew-nav > .nav-tabs").hide()):this.isCollapse&&(this.showPagerTop&&this.$collapses.closest(".ew-accordion").before(e),this.showPagerBottom&&this.$collapses.closest(".ew-accordion").after(e),this.$form.find(".ew-prev").click((function(e){return t.$pages.closest(".accordion-item").filter(":has(.collapse.show)").prev(":has([data-bs-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-bs-toggle=collapse]").click(),!1})),this.$form.find(".ew-next").click((function(e){return t.$pages.closest(".accordion-item").filter(":has(.collapse.show)").next(":has([data-bs-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-bs-toggle=collapse]").click(),!1}))),this.pageShow()},this.pageShow=function(){this.isTab?(this.lockTabs&&this.$pages.on("show.bs.tab",a),this.$pages.each((function(){var e=i.default(this);t.hideInactivePages&&e.toggleClass("d-none",!e.hasClass("active")),t.lockTabs&&e.toggleClass("disabled",!e.hasClass("active"))}))):this.isCollapse&&this.$pages.closest(".accordion-item").each((function(){var e=i.default(this);t.hideInactivePages&&e.toggleClass("d-none",!e.find(".collapse.show")[0])}));var e=this.lastPageSubmit&&this.pageIndex!=this.maxPageIndex,n=this.$form.closest(".content, .modal-content").find("#btn-action, button.ew-submit").prop("disabled",e).toggle(!this.hideDisabledButton||!e);i.default(".ew-captcha").toggle(n.is(":visible:not(:disabled)")),e=this.pageIndex<=this.minPageIndex,this.$form.find(".ew-prev").toggleClass("disabled",e),e=this.pageIndex>=this.maxPageIndex,this.$form.find(".ew-next").toggleClass("disabled",e)},this.gotoPage=function(e){if(!(e<=0||e<this.minPageIndex||e>this.maxPageIndex)&&this.pageIndex!=e){var t=this.$pages.eq(e-1);if(this.isTab)t.is(":not(.d-none):not(.disabled)")?t.click():t.parent().next(":has([data-bs-toggle=tab]):not(.d-none):not(.disabled)").find("[data-bs-toggle=tab]").toggleClass("disabled",!1).click();else if(this.isCollapse){var a=t.closest(".accordion-item");a.is(":not(.d-none)")?t.click():a.next(":has([data-bs-toggle=collapse]):not(.d-none)").find("[data-bs-toggle=collapse]").click()}this.pageIndex=e}},this.gotoPageByIndex=this.gotoPage,this.gotoPageByElement=function(e){this.gotoPage(parseInt(i.default(e).data("page"),10)||-1)},this.gotoPageByElementId=function(e){var t=this.$form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.gotoPageByElement(t)},this.togglePage=function(e,t){this.isTab?this.$pages.eq(e-1).toggleClass("d-none",!t):this.isCollapse&&this.$pages.eq(e-1).closest(".accordion-item").toggle("d-none",!t)},this.render=function(){this.$form=i.default("#"+e),this.pageIndexes=this.$form.find("[data-page]").map((function(){var e=parseInt(this.dataset.page,10);return e>0?e:null})).get(),this.pageIndexes.sort((function(e,t){return e-t})),this.minPageIndex=this.pageIndexes[0],this.maxPageIndex=this.pageIndexes[this.pageIndexes.length-1];var a=this.$form.find("[data-bs-toggle=tab]");if(a[0])this.$pages=a,this.isTab=!0,a.on("shown.bs.tab",(function(e){t.pageIndex=a.index(e.target)+1,t.pageShow(),i.default(i.default(this).attr("href")).find(".ew-map").each((function(){var e=ew.maps[this.id];null!=e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=a.index(a.parent(".active"))+1;else if(this.$collapses=this.$form.find("[data-bs-toggle=collapse]"),this.$collapses[0]){this.$pages=this.$collapses,this.isCollapse=!0;var n=this.$collapses;n.on("shown.bs.collapse",(function(e){t.pageIndex=n.index(e.target)+1,t.pageShow(),i.default(this).find(".ew-map").each((function(){var e=ew.maps[this.id];null!=e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=n.index(n.hasClass("show"))+1}i.default((function(){t.init()}))}},Form:b,FormBuilder:y,Validators:s,maps:Ca},ha,Ta,ga);var Pa=i.default(document);loadjs.ready("load",(function(){i.default.views.settings.debugMode(ew.DEBUG),ew.setSessionTimer(),ew.initPage(),i.default("#ew-modal-dialog").on("load.ew",ew.initPage),i.default("#ew-add-opt-dialog").on("load.ew",ew.initPage);var e=ew.currentUrl.searchParams.get("hash");e&&i.default("html, body").animate({scrollTop:i.default("#"+e).offset().top},800),Pa.trigger("load.ew")})),Pa.on("addoption",(function(e,t){let a=t.data,n=t.parents;for(let e=0,l=n.length;e<l;e++){let l=n[e];if(!l.length)return t.valid=!1;let r=a["ff"+(e>0?e+1:"")];if(!i.default.isUndefined(r)&&!l.includes(String(r)))return t.valid=!1}})),Pa.on("click","[data-ew-action]:not([data-ew-action=''])",(function(e){let t=Object.assign({},i.default(this).data()),a=t.ewAction;if(!a)return!0;if("none"==a)return!1;if("redirect"==a)return ew.redirect(t.url);if("reload"==a)return location.reload(),!1;if("submit"==a)return delete t.ewAction,ew.submitAction(e,t);if("modal"==a)return e.preventDefault(),t.ajax?ew.inlineAction({evt:e,...t}):ew.modalDialogShow({evt:e,...t});if("inline"==a||"grid"==a)return e.preventDefault(),ew.inlineAction({evt:e,...t});if("export"==a)return ew.export({evt:e,...t});if("layout"==a)return ew.toggleLayout(this);if("language"==a)return ew.setLanguage(this);if("filter"==a)return ew.filter(e);if("sort"==a)return ew.sort(e,this.dataset);if("refresh"==a){let e=ew.setLayout(this.dataset.url,!1);return e&&"#"!=e&&ew.refresh(fetch(e),this.dataset.context),!1}if("email"==a)return delete t.ewAction,ew.emailDialogShow({evt:e,...t});if("set-action"==a)this.form.elements.action.value=t.value;else{if("drilldown"==a)return ew.showDrillDown(e,this,t.url,t.id,t.hdr);if("add-option"==a)return delete t.ewAction,ew.addOptionDialogShow({evt:e,...t});if("search-type"==a)return ew.setSearchType(this);if("search-operator"==a)ew.toggleSearchOperator(e,t.target,t.value);else if("search-toggle"==a){let e=document.getElementById(this.dataset.form+"_search_panel");e&&(bootstrap.Collapse.getOrCreateInstance(e).toggle(),this.classList.toggle("active"))}else if("highlight"==a)i.default("mark."+this.dataset.name).toggleClass("mark"),this.classList.toggle("active");else{if("inline-delete"==a)return ew.confirmDelete(this);if("add-grid-row"==a)return ew.addGridRow(this);if("delete-grid-row"==a)return ew.deleteGridRow(this,this.dataset.rowindex);if("select-all"==a)ew.selectAll(this);else if("select-key"==a)ew.selectKey(e);else if("select-all-keys"==a)ew.selectAllKeys(this);else{if("import"==a)return ew.importDialogShow({evt:e,hdr:t.hdr});if("password"==a)return ew.togglePassword(e);if("push"==a)return ew.pushNotificationDialogShow({evt:e,url:t.apiUrl});if("enable-2fa"==a)return ew.enable2FA();if("disable-2fa"==a)return ew.disable2FA();var n;if("send-otp"==a)return ew.sendOTP(null==(n=document.getElementById(t.account))?void 0:n.value);if("backup-codes"==a)return ew.showBackupCodes();if("scroll-top"==a)return i.default(document).scrollTop(i.default("#top").offset().top),!1}}}})).on("change","[data-ew-action]:not([data-ew-action=''])",(function(e){let t=Object.assign({},i.default(this).data());if(!t.ewAction)return!0;let a=t.ewAction.split(" ").filter((e=>!!e));for(let e of a)if("submit-form"==e){var n;null==(n=this.form)||n.submit()}else{if("change-page-size"==e){if(ew.convertToBool(t.ajax)){let e=ew.setLayout(this.dataset.url,!1)+"&"+this.name+"="+ew.parseNumber(this.value);ew.refresh(fetch(e),this.dataset.context)}else{let e=ew.setSearchParam(this.dataset.url,this.name,ew.parseNumber(this.value));ew.redirect(e)}return!1}if("update-options"==e)ew.updateOptions.call(this);else if("autofill"==e)ew.autoFill(this);else{if("search-operator"==e)return ew.searchOperatorChange(this);"language"==e?ew.setLanguage(this):"chart-order"==e&&ew.updateChart(this)}}})).on("keydown","[data-ew-action]:not([data-ew-action=''])",(function(e){let t=Object.assign({},i.default(this).data());if("change-page"==t.ewAction&&"Enter"==e.key){if(ew.convertToBool(t.ajax)){let e=ew.setLayout(this.dataset.url,!1)+"&"+this.name+"="+ew.parseNumber(this.value);ew.refresh(fetch(e),this.dataset.context)}else ew.currentUrl.searchParams.set(this.name,ew.parseNumber(this.value)),window.location=ew.sanitizeUrl(ew.currentUrl.toString());return!1}})),Pa.on("click",".ew-row-link",(e=>e.stopPropagation())),Pa.on("show.bs.modal",".modal",(function(){var e=1050+i.default(".modal:visible").length;i.default(this).css("z-index",e),setTimeout((function(){i.default(".modal-backdrop").not(".modal-stack").css("z-index",e-1).addClass("modal-stack")}),0)})),Pa.on("hidden.bs.modal",".modal",(function(){i.default(".modal:visible").length&&i.default("body").addClass("modal-open")})),i.default.blueimp.fileupload.prototype.options.processQueue.unshift({action:"cropImage",fileTypes:"@loadImageFileTypes",maxFileSize:"@loadImageMaxFileSize",cropperOptions:"@",cropperCanvasOptions:"@",disabled:"@disableImageCrop"}),i.default.widget("blueimp.fileupload",i.default.blueimp.fileupload,{processActions:{cropImage:function(e,t){let a=e.files[e.index];if(t.disabled||i.default.isNumber(t.maxFileSize)&&a.size>t.maxFileSize||t.fileTypes&&!t.fileTypes.test(a.type))return e;let n=URL.createObjectURL(a),l=i.default.Deferred(),r=this,o=ew.cropperDialog||i.default("#ew-cropper-dialog").on("shown.bs.modal",(function(){o.data("cropper",new Cropper(this.querySelector("#ew-crop-image"),t.cropperOptions))})).on("hidden.bs.modal",(function(){var e;null==(e=o.data("cropper"))||e.destroy(),o.removeData("cropper"),o.find("#ew-crop-image").attr("src","data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=")}));return ew.cropperDialog=o,o.find("#ew-crop-image").attr("src",n),o.find(".ew-crop-btn").off("click").on("click",(function(){if(o.data("cropper"))try{o.data("cropper").getCroppedCanvas(t.cropperCanvasOptions).toBlob((t=>{e.files[e.index]=new File([t],a.name,{type:a.type}),l.resolveWith(r,[e])}),a.type)}catch(t){ew.alert(t),l.rejectWith(r,[e])}finally{o.modal("hide")}})),o.find(".ew-skip-btn").off("click").on("click",(function(){l.resolveWith(r,[e]),o.modal("hide")})),o.modal("show"),l.promise()}}}),i.default.extend({isBoolean:function(e){return"boolean"==typeof e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isObject:function(e){return e&&("object"==typeof e||this.isFunction(e))||!1},isString:function(e){return"string"==typeof e},isUndefined:function(e){return"undefined"==typeof e},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return"date"===this.type(e)&&"Invalid Date"!==e.toString()&&!isNaN(e)},later:function(e,t,a,n,l){e=e||0,t=t||{};var i,r,o=a,s=n;if(this.isString(a)&&(o=t[a]),o)return this.isUndefined(n)||this.isArray(s)||(s=[n]),i=function(){o.apply(t,s||[])},r=l?setInterval(i,e):setTimeout(i,e),{interval:l,cancel:function(){this.interval?clearInterval(r):clearTimeout(r)}}}}),i.default.fn.fields=function(e){let t,a,n,l={},r=this.attr("id"),o=this[0],s=r.match(/^[xy](\d*)_/);s?(t=ew.getForm(o),a=this.data("table"),n=s[1]):null!=o&&o.htmlForm&&(t=o.$element,a=o.id.replace(new RegExp("^f|"+o.pageId+"$","g"),""),n=o.htmlForm.dataset.rowindex);let d="[data-table"+(a?"="+a:"")+"][data-field"+(e?"=x_"+e:"")+"]"+(i.default.isValue(n)?"[name^=x"+n+"]":"")+":not(.ew-custom-option)";return t&&d&&i.default(t).find(d).each((function(){let e=this.dataset.field.substring(2),t=this.getAttribute("name");e=/^y_/.test(t)?"y_"+e:e,l[e]=l[e]?l[e].add(this):i.default(this)})),e?l[e]:l},i.default.fn.extend({row:function(){var e;let t=this.closest("#r_"+(null==(e=this.data("field"))?void 0:e.substring(2)));return t[0]||(t=this.closest(".ew-table > tbody > tr")),t},visible:function(e){var t;let a=this.closest("#r_"+(null==(t=this.data("field"))?void 0:t.substring(2)));return a[0]||(a=this.closest("[id^=el]")),"undefined"!=typeof e?(a.toggle(e),this):$el.is(":visible")},readonly:function(e){return"undefined"!=typeof e?(this.prop("readOnly",e),this):this.prop("readOnly")},disabled:function(e){return"undefined"!=typeof e?(this.prop("disabled",e),this):this.prop("disabled")},value:function(e){return"undefined"!=typeof e?(ew.selectOption(this[0],e),this):ew.getValue(this[0])},toNumber:function(){return ew.parseNumber(this.value())},toDate:function(){var e,t,a,n;let l=this.data(),i=l.table,r=l.field.replace(/^[xy]_/,""),o=null==(e=ew.vars.tables)||null==(t=e[i])||null==(a=t.fields)||null==(n=a[r])?void 0:n.clientFormatPattern;return ew.parseDateTime(this.value(),o)},toJsDate:function(){return this.toDate().toJSDate()}}),bootstrap.Dropdown.prototype.toggle=function(){if(!this._element.classList.contains("ew-dropdown-toggle")){if(this._element.closest("[data-widget]")&&i.default(this._element).on("click.ew.dropdown",(e=>{bootstrap.Dropdown.clearMenus(e.originalEvent),e.stopPropagation()})),this._menu.closest(".table-responsive")){this._menu.closest(".popover-body, .modal-body, .offcanvas-body, body").appendChild(this._menu);let e=this._menu;function t(t){t.forEach((t=>{if("attributes"===t.type)t.target.classList.contains("show")?e.classList.add("d-block"):e.classList.remove("d-block")}))}this._element.id||(this._element.id="dropdownbtn"+ew.random()),e.setAttribute("aria-labelledby",this._element.id),new MutationObserver(t).observe(this._parent,{attributeFilter:["class"],attributeOldValue:!1,subtree:!1})}this._element.classList.add("ew-dropdown-toggle")}return this._isShown()?this.hide():this.show()};var Na=e=>null==e,Ra=e=>"function"==typeof e,La=e=>"number"==typeof e&&isNaN(e),Fa=e=>"number"==typeof e&&isFinite(e);const ka=(e,t)=>{if(!Fa(e))return NaN;const a=""+e,n=a.indexOf("e");return-1===n?+(a+"e"+t):+(a.slice(0,n)+"e"+(+a.slice(n+1)+t))},Da=e=>Math.round(Math.log(e)*Math.LOG10E),Ma=(e,t)=>{const a={};for(let n=0;n<e.length;++n)if(n in e){const[l,i]=t(e[n],n);a[l]=i}return a},ja=e=>e.replace(/[.*+?^${}()|[\]\\]/g,(e=>`\\${e}`)),$a=e=>{const t={};return function(...a){const n=a.length>1?a.join("-(:-:)-"):a[0];if(n in t)return t[n];const l=e.apply(this,a);return t[n]=l,l}},Ua=(()=>{const e={};let t,a="";for(;t!==1/0;)t=+("1"+a),e[t]=!0,a+="0";for(a="",t=void 0;0!==t;)t=+("0."+a+"1"),e[t]=!0,a+="0";return e})(),Ba=e=>!!Ua[e],Va=(e,t,a)=>{if(!Fa(e)||t===a.base)return e;if(!(t in a.scale))return NaN;const n=a.scale[t]||1;return Ba(n)?ka(e,Da(n)):e*n},Ha=(e,t,a,n)=>{if(!Fa(e)||t===a)return e;const l=Va(e,t,n),i=Object.assign(Object.assign({},n.scale),{[n.base]:1});if(isNaN(l)||!(t in i)||!(a in i))return NaN;const r=n.scale[a]||1;return Ba(r)?ka(l,-Da(r)):l/r},qa=e=>({toBase:(t,a)=>Va(t,a,e),convert:(t,a,n)=>Ha(t,a,n,e),toBest:(t,a,n)=>((e,t,a,n)=>{const l=Object.assign({exclude:[],cutOffNumber:1},n);let i=null;const r=a.scale;return Object.keys(r).sort(((e,t)=>r[e]-r[t])).forEach((n=>{if(-1!==l.exclude.indexOf(n))return;const r=Ha(e,t,n,a),o=Math.abs(r);(!i||o>=l.cutOffNumber&&o<Math.abs(i[0]))&&(i=[r,n])})),i||[e,t]})(t,a,e,n),scaleDefinition:e}),Wa=(e,t)=>{if(t<1)return"";let a="",n=e;for(;t>1;)1&t&&(a+=n),t>>>=1,n+=n;return a+n},Ka=$a((e=>{if(!e)return qa({base:"",scale:{}});const t=e.split("|"),a={"":1};return t.forEach(((e,t)=>{e&&(a[e]=+(1+Wa("0",t)))})),qa({base:"",scale:a})})),Ga=(e,t)=>{var a;const n=t.locale,l=e;let i;const r=((e,t)=>{if(!t||10!==t.length)return e;const a=e.length,n=Ma(t,((e,t)=>[e.replace(/\u200e/g,""),""+t]));let l="";for(let t=0;t<a;t++){const a=e[t];l+=n[a]||a}return l})(e,null===(a=t.locale)||void 0===a?void 0:a.numeralSystem);if(t.zeroFormat&&r===t.zeroFormat)i=0;else if(t.nullFormat&&r===t.nullFormat||!r.replace(/[^0-9]+/g,"").length)i=null;else{const e=n.delimiters.decimal,a="."===e?r:r.replace(/\./g,"").replace(e,"."),o=((e,t)=>{var a;const n=Ka(null===(a=t.locale)||void 0===a?void 0:a.abbreviations),l=Object.keys(n.scaleDefinition.scale).sort(((e,t)=>t.length-e.length));let i=1;for(const t of l){const a=ja(t),l=new RegExp(`[^a-zA-Z](${a})|(${a.replace(/\u200e/g,"")})(?:\\)(?:\\))?)?$`);if(e.match(l)){i=n.toBase(i,t);break}}return i})(l,t),s=(a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1,d=a.replace(/[^0-9.]+/g,"");i=s*ka(+d,Da(o))}return i},za={code:"en",delimiters:{thousands:",",decimal:"."},abbreviations:"|||K|||M|||B|||T",ordinal:e=>{const t=e%10;return 1===Math.floor(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"}};function Ya(...e){const t={},a=e.length;for(let n=0;n<a;n++)for(const a in e[n])t[a]=e[n][a];return t}var Ja=e=>"object"==typeof e&&null!==e,Xa=e=>"string"==typeof e;const Za=e=>e<0?Math.ceil(e):Math.floor(e),Qa=e=>{let t=!1,a="";const n=[];for(let l=0;l<e.length;l++){const i=e.charAt(l);"'"!==i||t?"'"===i&&t&&"\\"!==e.charAt(l-1)?(t=!1,n.push({escaped:!0,value:a})):t?a+=i:n.length&&!n[n.length-1].escaped?n[n.length-1].value+=i:n.push({escaped:!1,value:i}):(t=!0,a="")}return n},en=(e,t)=>-1!==an(e).indexOf(t),tn=(e,t,a)=>Qa(e).map((e=>e.escaped?`'${e.value}'`:e.value.replace(t,(e=>a)))).join(""),an=e=>Qa(e).filter((e=>!e.escaped)).map((e=>e.value)).join(""),nn=(e,t)=>-1!==e.indexOf(t),ln=(e,t)=>{if(!e)return["",""];const a=e.indexOf(t);return-1===a?[e,""]:[e.slice(0,a),e.slice(a+1)]},rn=(e,t)=>e?e.split("").filter((e=>e===t)).length:0,on=$a((e=>{const t=Xa(e)&&e||"0,0.##########",[a,n]=(e=>{const t=an(e),a=nn(t,"(")&&nn(t,")"),n=!a&&nn(t,"+");let l=e;return l=tn(l,"(","'ɵnps'"),l=tn(l,")","'ɵnpe'"),l=tn(l,/(-|\+)/,"'ɵs'"),[l,{negativeParentheses:a,forceSign:n}]})(t),[l,i]=(e=>{let t=null,a=!1;if(en(e,"a")){a=!0;const n=an(e).match(/a(k|m|b|t)?/);t=n?n[1]:null}let n=e;return n=tn(n,/a(k|m|b|t)?/,"'ɵa'"),[n,{compact:a,compactUnit:t,compactAuto:a&&!t}]})(a),[r,o]=(e=>{let t=!1,a=e;return en(e,"[.]")&&(t=!0,a=tn(a,"[.]",".")),[a,{optionalFractionDigits:t}]})(l),s=r,d=an(s),u=(e=>{const t=an(e),a=ln(t,".")[1];let n=0,l=0;if(a){const e=a.trim();if(nn(e,"[")){const t=e.replace("]",""),a=ln(t,"[");n=rn(a[0],"0"),l=n+rn(a[1],"0")}else if(nn(e,"#"))n=rn(e.split("#")[0],"0"),l=e.length;else if(nn(e,"X"))n=rn(e.split("X")[0],"0"),l=500;else{const t=rn(e.split(" ")[0],"0");n=t,l=t}}return{minimumFractionDigits:n,maximumFractionDigits:l}})(s),c=(e=>{const t=an(e).split(".")[0].split(",")[0];return/#/g.test(t)?0:(t.match(/0/g)||[]).length})(s),f=d.indexOf(",")>-1,p=(e=>tn(e,/((((0|#)+,)?(0|#)+(\.([0#X]|\[0+\])+)?){1})/,"'ɵn'"))(s),h=(e=>nn(e,"'ɵs'")||nn(e,"'ɵnps'")?e:e.replace("'ɵn'",(e=>"'ɵs''ɵn'")))(p),g=h;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),i),o),u),{grouping:f,minimumIntegerDigits:c,patternMask:g})})),sn=(e,t,a)=>{const{compact:n,compactUnit:l}=t,{abbreviations:i}=a.locale;if(!n)return[e,null];if(l)return((e,t,a)=>{const n={k:3,m:6,b:9,t:12}[e],l=(null==t?void 0:t.split("|"))||[];let i=null;for(let e=0;e<l.length;e++)if(l[n-e]){i=n-e;break}return null===i?[a,null]:[ka(a,-i),l[i]]})(l,i,e);const r=Ka(i),[o,s]=r.toBest(e,"");return[o,s||null]},dn=(e,t,a)=>{const n=t||0,l=(a||Math.round)(ka(e,n));return ka(l,-n)},un=e=>{const t=(e||0).toString();if(!(t.indexOf("e")>=0))return t;const[a,n]=ln(t,"e"),l=+n;return l>=0?(e=>{const[t,a]=ln(e,"e"),n=+a;if(n<0)return e;const[l,i]=ln(t,"."),r=n-i.length;return`${l}${i}${Wa("0",r)}`})(t):((e,t,a)=>{const n=Math.abs(t),[l,i]=ln(a,".");let r="-"===l[0]?l.slice(1):l,o=i;for(let e=0;e<n;e+=1){const e=r[0]||"";r=r.slice(0,r.length-1),o=(e||"0")+o}return`${e<0?"-":""}${r||0}.${o}`})(e,l,a)},cn=(e,t,a,n)=>{const l=un(e),i=t-(n||0),r=ln(l,".")[1],o=r?Math.min(Math.max(r.length,i),t):i,s=dn(e,o,a);let d=un(s);return i&&(d=((e,t)=>{const[a,n]=ln(e,".");return`${a}.${n+Wa("0",t-n.length)}`})(d,i)),d},fn=(e,t,a)=>{const{rounding:n}=a,{minimumFractionDigits:l,maximumFractionDigits:i}=t,r=n||Math.round;if(l>0||i>0){return cn(e,i,r,i-l)}return cn(e,0,r)},pn=(e,t)=>{if(!t||10!==t.length)return e;const a=e.length;let n="";for(let l=0;l<a;l++){const a=e[l];n+=t[a]||a}return n},hn=(e,t,a)=>{if(!t.compact){return[fn(e,t,a),null]}const[n,l]=sn(e,t,a),i=+fn(n,t,a),[r,o]=((e,t,a,n)=>{const{compact:l,compactAuto:i}=a,{abbreviations:r}=n.locale;if(!l||!i)return[e,t];const o=Ka(r),[s,d]=o.toBest(e,t||"");return[s,d]})(+i,l,t,a);return[fn(r,t,a),o]},gn=(e,t,a)=>{var n;const l=on(t),i=Fa(e)?e:0,[r,o]=hn(i,l,a);if("NaN"===r)return"";const s=a.signedZero?e<0:+r<0,d=a.signedZero?0===e:0==+r,u=(e=>"-"===e[0]?e.slice(1):e)(r),[c,f]=((e,t)=>{const{optionalFractionDigits:a}=t,[n,l]=ln(e,".");return a&&0===Number(l)?[n,""]:[n,l]})(u,l),p=((e,t)=>{const{minimumIntegerDigits:a}=t;return 0===a&&+e<1&&+e>-1?"":e.length>=a?e:`${Wa("0",a-e.length)}${e}`})(c,l),h=((e,t,a)=>{const{delimiters:n,digitGroupingStyle:l}=a.locale,{grouping:i}=t;if(!i||!n.thousands)return e;const r=e,o=n.thousands,s=[...(null==l?void 0:l.length)?l:[3]];let d="",u=1;for(let e=r.length-1;e>=0;e--)u===s[0]&&0!==e?(d=o+r[e]+d,s.length>1&&s.shift(),u=1):(d=r[e]+d,u+=1);return d})(p,l,a),g=a.locale.numeralSystem,m=pn(h,g),w=pn(f,g),v=m+(w?((null===(n=a.locale.delimiters)||void 0===n?void 0:n.decimal)||".")+w:"");var b,y;const _=((e,t,a,n)=>{const{negativeParentheses:l,forceSign:i}=n;let r=e;return l&&t?r=r.replace(/'ɵ(nps|npe)'/g,(e=>"'ɵnps'"===e?"(":")")):i?r=r.replace("'ɵs'",t?"-":a?"":"+"):t&&(r=r.replace("'ɵs'","-")),r})((b=l.patternMask,y=o,l.compact?y?b.replace("'ɵa'",(e=>`'${y.replace(/'/g,(e=>"\\'"))}'`)):b.match(/'ɵn'\s*'ɵa'/)?b.replace(/\s*'ɵa'/,""):b.replace(/'ɵa'\s*/,""):b).replace("'ɵn'",(e=>`'${v.replace(/'/g,"\\'")}'`)),s,d,l),A=(e=>Qa(e).map((e=>e.escaped?e.value.replace(/\\'/g,"'"):e.value)).join(""))(_.replace(/'ɵ(nps|npe|s|a|n)'/g,""));return A},mn={name:"bps",regexps:{format:/BPS/,unformat:/BPS/},format:(e,t,a)=>{const n=ka(e,4),l=tn(t,/BPS/,"'ɵBPSɵ'");return gn(n,l,a).replace("ɵBPSɵ","BPS")},unformat:(e,t)=>{const a=Ga(e.replace(/\s?BPS/,""),t);return Fa(a)?ka(a,-4):a}},wn={name:"time",regexps:{format:/([0-9]{1,2}:[0-9]{2}) *$/,unformat:/([0-9]{1,2}:[0-9]{2}) *$/},format:e=>{const t=Math.abs(e),a=e<0?"-":"",n=Za(t/3600),l=Za((t-3600*n)/60),i=Za(t-3600*n-60*l);return`${a}${n}:${(l<10?"0":"")+l}:${(i<10?"0":"")+i}`},unformat:e=>{const t=/^ *-/.test(e),a=e.replace(/^ *-/,"").split(":").reverse();let n=0;return n+=+a[0],n+=60*+a[1],n+=3600*(+a[2]||0),t&&0!==n?-n:n}},vn=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],bn=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],yn=`(${vn.concat(bn.slice(1)).join("|").replace(/B/g,"B(?!PS)")})`,_n=qa({base:"B",scale:Ma(vn,((e,t)=>[e,Math.pow(1e3,t)]))}),An=qa({base:"B",scale:Ma(bn,((e,t)=>[e,Math.pow(1024,t)]))}),En={EUR:"€",USD:"$",XCD:"EC$",AUD:"A$",INR:"₹",BRL:"R$",CAD:"CA$",XAF:"FCFA",CNY:"CN¥",NZD:"NZ$",XPF:"CFPF",GBP:"£",HKD:"HK$",ILS:"₪",JPY:"¥",KRW:"₩",XOF:"CFA",MXN:"MX$",TWD:"NT$",VND:"₫"},Sn=[{name:"percentage",regexps:{format:/%!?/,unformat:/%/},format:(e,t,a)=>{const n=en(t,"%!"),l=a.scalePercentage&&!n?ka(e,2):e,i=tn(t,/%!?/,"'ɵ%ɵ'");return gn(l,i,a).replace("ɵ%ɵ","%")},unformat:(e,t)=>{const a=Ga(e.replace(/\s?%/,""),t);return a&&t.scalePercentage?ka(a,-2):a}},{name:"currency",regexps:{format:/(\$)/},format:(e,t,a)=>{var n;const l=null===(n=a.currency)||void 0===n?void 0:n.toUpperCase(),i=En[l]||l||"",r=tn(t,/\$/,"'ɵcurrencyɵ'");return gn(e,r,a).replace("ɵcurrencyɵ",(e=>i))}},{name:"ordinal",regexps:{format:/o/},format:(e,t,a)=>{var n,l;const i=(null===(l=(n=a.locale).ordinal)||void 0===l?void 0:l.call(n,e))||"",r=tn(t,/o/,"'ɵordɵ'");return gn(e,r,a).replace("ɵordɵ",(e=>i))}},wn,{name:"bytes",regexps:{format:/([0\s]b[bd])|(b[bd][0\s])/,unformat:(e,t)=>"bytes"===t.type&&new RegExp(yn).test(e)},format:(e,t,a)=>{const n=en(t,"bb")?An:_n,[l,i]=n.toBest(e,"B"),r=tn(t,/b[bd]/,"'ɵbytesɵ'");return gn(l,r,a).replace("ɵbytesɵ",i||"")},unformat:(e,t)=>{var a;const n=Ga(e.replace(new RegExp(yn),""),t),l=(null===(a=e.match(yn))||void 0===a?void 0:a[0])||"",i=An.scaleDefinition.scale[l]?An:_n;return n?i.toBase(n,l):n}},{name:"exponential",regexps:{format:/[eE][+-][0-9]+/,unformat:/[eE][+-][0-9]+/},format:(e,t,a)=>{const n="number"!=typeof e||La(e)?"0e+0":e.toExponential(),l=ln(n,"e"),i=tn(t,/e[+|-]{1}0/i,"");return gn(+l[0],i,a)+"e"+l[1]},unformat:(e,t)=>{var a;const n=Ga(e.replace(/e[+-]{1}[0-9]{1,3}/i,""),t),l=+((null===(a=e.match(/e([+-]{1}[0-9]{1,3})/i))||void 0===a?void 0:a[1])||"0");return Fa(n)?ka(n,l):n}},mn],Tn=e=>e>=0?Math.round(e):e%.5==0?Math.floor(e):Math.round(e),In=e=>{var t,a,n;const l=e||{},i=(e=>{switch(e){case"ceil":return Math.ceil;case"floor":return Math.floor;case"truncate":return Za;case"half-up":return Math.round;case"half-away-from-zero":return Tn;default:return Ra(e)?e:Tn}})(l.rounding),r=(e=>{const t=za;return Ja(e)?Ya(e,{delimiters:(a=e.delimiters,(null==a?void 0:a.decimal)&&Xa(null==a?void 0:a.thousands)&&a.decimal!==a.thousands?e.delimiters:t.delimiters),abbreviations:e.abbreviations||t.abbreviations,ordinal:e.ordinal||t.ordinal}):t;var a})(l.locale),o=(s=l.formatters)?Ra(s)?s(Sn):[...s,...Sn]:Sn;var s;return{defaultPattern:l.defaultPattern||"0,0.##########",nullFormat:l.nullFormat||"",nanFormat:l.nanFormat,zeroFormat:l.zeroFormat,locale:r,rounding:i,type:l.type,scalePercentage:null===(t=l.scalePercentage)||void 0===t||t,trim:null===(a=l.trim)||void 0===a||a,formatters:o,currency:l.currency,signedZero:!!l.signedZero,nonBreakingSpace:null!==(n=l.nonBreakingSpace)&&void 0!==n&&n}},On=(e,t)=>{const a=In(t);let n;if(Na(e)||La(e))n=null;else if("number"==typeof e)n=0===e?0:e;else if("string"==typeof e)if(a.zeroFormat&&e===a.zeroFormat)n=0;else if(a.nullFormat&&e===a.nullFormat)n=null;else{const t=e.replace(/\u00A0/," "),l=((e,t)=>{for(const a of t.formatters){const n=a.regexps.unformat;if(n&&(Ra(n)?n(e,t):e.match(n)))return a.unformat}})(t,a);n=(l||Ga)(t,a)}else{const t=+e;n=0===t?t:t||null}return n},xn=(e,t,a)=>{var n;try{const n=Xa(e)?parseFloat(e):e,l=In(a),i=t||l.defaultPattern;let r;if(n===1/0||n===-1/0)r=n>0?"∞":"-∞";else{if(La(n))return Xa(l.nanFormat)?l.nanFormat:Xa(l.nullFormat)?l.nullFormat:"";if(Na(n))r=Xa(l.nullFormat)?l.nullFormat:"";else if(0===n&&Xa(l.zeroFormat))r=l.zeroFormat;else{const e=n||0,t=((e,t)=>{const a=an(e);for(const n of t.formatters){const l=n.regexps.format;if(l&&(Ra(l)?l(e,t):a.match(l)))return n.format}})(i,l);r=(t||gn)(e,i,l)}}return r=Xa(r)?r:"",r=l.nonBreakingSpace?r.replace(/ /g,(e=>" ")):r,r=l.trim?r.trim():r,r}catch(e){return(null===(n=a)||void 0===n?void 0:n._errorFormat)||""}};function Cn(e,t,a){const n=Xa(t)?t:null,l=Ja(t)?t:Ja(a)?a:{};return xn(e,n,l)}Cn.withOptions=e=>{const t=Ya(e,{locale:Ra(e.locale)?e.locale():e.locale});return(e,a,n)=>{const l=Xa(a)?a:null,i=Ja(a)?a:Ja(n)?n:{};return xn(e,l,Ya(t,i))}};const Pn=new RegExp("^[^֑-߿‏‫‮יִ-﷽ﹰ-ﻼ]*?[֑-߿‏‫‮יִ-﷽ﹰ-ﻼ]"),Nn=e=>(e=>Pn.test(e))(e)?e+"‎":e,Rn=["zh","yue","ko","ja"],Ln=(e,t,a)=>{try{if("object"!=typeof Intl||!Intl||"function"!=typeof Intl.NumberFormat)return null;const n={notation:"compact",useGrouping:!1,compactDisplay:a},[l,i,r]=t.split("");let o="";for(let t=1;t<50;t++){const s=(+(1+Wa("0",t))).toLocaleString(e,n);if(new RegExp(`^${i}[^${l}]+$`).test(s))if("long"===a){const a=(+(2+Wa("0",t))).toLocaleString(e,n),l=s.replace(new RegExp(`${i}`,"g"),"").trim(),d=a.replace(new RegExp(`${r}`,"g"),"").trim();o+="|"+Nn(l)+":::"+Nn(d)}else{const e=s.replace(new RegExp(`${i}`,"g"),"").trim();o+="|"+Nn(e)}else o+="|"}let s=o,d=s.length;for(;d--&&"|"===s[d];)s=s.slice(0,-1);return s}catch(e){return null}},Fn=$a((e=>{const t=e||"en",a=(e=>{try{const t=1234567890..toLocaleString(e,{useGrouping:!1}),a={},n=t.split("").find((e=>{if(a[e])return!0;a[e]=!0})),l=(n?t.replace(new RegExp(ja(n||""),"g"),""):t).split("");return[l[l.length-1],...l.slice(0,-1)].join("")}catch(e){return null}})(t),n=a||"0123456789",l=((e,t)=>{try{const n=12345678.123.toLocaleString(e).replace(new RegExp(`[${ja(t)}]`,"g"),""),[l=",",i="."]=(a=n.split(""))?a.filter(((e,t,a)=>a.indexOf(e)===t)):[];return[l,i]}catch(e){return null}var a})(t,n),[i,r]=l&&l.length>=2?l:[",","."],o=((e,t)=>{if(Rn.some((t=>0===e.indexOf(t))))return[4];try{const a=[];let n=0;1e11.toLocaleString(e).split("").reverse().forEach((e=>{e===t?(a.push(n),n=0):n+=1}));let l=a.length;for(;l--&&a[l]===a[l-1];)a.pop();return a}catch(e){return null}})(t,i),s=Ln(t,n,"short");return{_abbreviationsLong:Ln(t,n,"long")||za.abbreviations,code:t,delimiters:{thousands:i,decimal:r},abbreviations:s||za.abbreviations,digitGroupingStyle:(null==o?void 0:o.length)?o:void 0,numeralSystem:"0123456789"!==a?null==a?void 0:a.split("").map(Nn):void 0,ordinal:za.ordinal}}));var kn={__proto__:null,parse:(e,t)=>On(e,t),round:(e,t,a)=>dn(e,t,a),format:Cn,getLocaleFromPlatform:e=>Fn(e)};Object.assign(l.default,kn)}(ew,jQuery,luxon);
//# sourceMappingURL=ew.min.js.map